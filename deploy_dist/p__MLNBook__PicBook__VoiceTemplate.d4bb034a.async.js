(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[730],{72866:function(de,Y,e){"use strict";e.r(Y),e.d(Y,{default:function(){return $e}});var A=e(18106),y=e(63885),R=e(57663),$=e(71577),P=e(62350),L=e(24565),E=e(34792),b=e(48086),M=e(71153),j=e(60331),d=e(39428),c=e(3182),N=e(2824),Q=e(45195),ie=e(51042),q=e(43471),I=e(67294),ee=e(17294),ve=e(9056),V=e(11849),oe=e(93224),G=e(78370),ue=["id"],re=null;function _e(s,i){return U.apply(this,arguments)}function U(){return U=(0,c.Z)((0,d.Z)().mark(function s(i,p){var v,r,T;return(0,d.Z)().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return v=i.id,r=v===void 0?0:v,T=(0,oe.Z)(i,ue),f.abrupt("return",(0,G.Z)("/api/pic_book/book/".concat(r,"/voice_list/"),(0,V.Z)({method:"GET",params:(0,V.Z)({},T)},p||{})));case 2:case"end":return f.stop()}},s)})),U.apply(this,arguments)}function me(s,i){return W.apply(this,arguments)}function W(){return W=(0,c.Z)((0,d.Z)().mark(function s(i,p){return(0,d.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,G.Z)("/api/pic_book/book_voice/",(0,V.Z)({method:"POST",data:i},p||{})));case 1:case"end":return r.stop()}},s)})),W.apply(this,arguments)}function he(s,i){return K.apply(this,arguments)}function K(){return K=(0,c.Z)((0,d.Z)().mark(function s(i,p){return(0,d.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,G.Z)("/api/pic_book/book_voice/bulk_gen_voice_files/",(0,V.Z)({method:"POST",data:i},p||{})));case 1:case"end":return r.stop()}},s)})),K.apply(this,arguments)}function o(s,i){return n.apply(this,arguments)}function n(){return n=(0,c.Z)((0,d.Z)().mark(function s(i,p){return(0,d.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,G.Z)("/api/pic_book/book_voice/paragraph_voice_file/",(0,V.Z)({method:"POST",data:i},p||{})));case 1:case"end":return r.stop()}},s)})),n.apply(this,arguments)}function _(s,i){return t.apply(this,arguments)}function t(){return t=_asyncToGenerator(_regeneratorRuntime().mark(function s(i,p){return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",request("/api/pic_book/paragraph_voice/",_objectSpread({method:"GET",params:_objectSpread({},i)},p||{})));case 1:case"end":return r.stop()}},s)})),t.apply(this,arguments)}function u(s,i){return k.apply(this,arguments)}function k(){return k=_asyncToGenerator(_regeneratorRuntime().mark(function s(i,p){var v,r,T;return _regeneratorRuntime().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return v=i.id,r=v===void 0?0:v,T=_objectWithoutProperties(i,re),f.abrupt("return",request("/api/pic_book/paragraph_voice/".concat(r,"/"),_objectSpread({method:"GET",params:_objectSpread({},T)},p||{})));case 2:case"end":return f.stop()}},s)})),k.apply(this,arguments)}function C(s,i){return g.apply(this,arguments)}function g(){return g=_asyncToGenerator(_regeneratorRuntime().mark(function s(i,p){return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",request("/api/pic_book/paragraph_voice/",_objectSpread({method:"POST",data:i},p||{})));case 1:case"end":return r.stop()}},s)})),g.apply(this,arguments)}function Se(s,i,p){return se.apply(this,arguments)}function se(){return se=_asyncToGenerator(_regeneratorRuntime().mark(function s(i,p,v){return _regeneratorRuntime().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.abrupt("return",request("/api/pic_book/paragraph_voice/".concat(i,"/"),_objectSpread({method:"PATCH",data:p},v||{})));case 1:case"end":return T.stop()}},s)})),se.apply(this,arguments)}function Re(s,i){return le.apply(this,arguments)}function le(){return le=_asyncToGenerator(_regeneratorRuntime().mark(function s(i,p){var v,r;return _regeneratorRuntime().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return v=i.id,r=v===void 0?0:v,w.abrupt("return",request("/api/pic_book/paragraph_voice/".concat(r,"/"),_objectSpread({method:"DELETE"},p||{})).catch(function(f){return{}}));case 2:case"end":return w.stop()}},s)})),le.apply(this,arguments)}var ke=e(37476),we=e(64317),Pe=e(61870),m=e(85893),Ee=function(i){var p=i.setShowModal,v=i.showModal,r=i.updateVoiceListFunc,T=i.picBookId;return(0,m.jsx)(ke.Y,{title:"\u6DFB\u52A0\u7ED8\u672C\u8BED\u97F3\u6A21\u677F",width:"750px",layout:"horizontal",visible:v,onVisibleChange:p,onFinish:function(){var w=(0,c.Z)((0,d.Z)().mark(function f(z){var ae,B;return(0,d.Z)().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return ae={pic_book:T,voice_template:z.voice_template},F.next=3,me(ae);case 3:if(B=F.sent,!(B!=null&&B.id)){F.next=10;break}return p(!1),F.next=8,r();case 8:F.next=11;break;case 10:b.ZP.error("\u6DFB\u52A0\u5931\u8D25");case 11:case"end":return F.stop()}},f)}));return function(f){return w.apply(this,arguments)}}(),children:(0,m.jsx)(we.Z,{label:"\u58F0\u97F3\u6A21\u677F",rules:[{required:!0}],name:"voice_template",mode:"single",placeholder:"\u9009\u62E9\u58F0\u97F3\u6A21\u677F",request:(0,c.Z)((0,d.Z)().mark(function w(){var f,z;return(0,d.Z)().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.next=2,(0,Pe.Y6)();case 2:return f=B.sent,z=f==null?void 0:f.map(function(H){return{label:"".concat(H.title,"(").concat(H.language,"\xB7").concat(H.tts_model,")"),value:H.id}}),B.abrupt("return",z);case 5:case"end":return B.stop()}},w)}))})})},je=Ee,Te=function(i){var p,v,r,T=i==null||(p=i.location)===null||p===void 0?void 0:p.query,w=T.id,f=(0,I.useState)(!1),z=(0,N.Z)(f,2),ae=z[0],B=z[1],H=(0,I.useState)({}),F=(0,N.Z)(H,2),h=F[0],Be=F[1],Ce=(0,I.useState)(!1),fe=(0,N.Z)(Ce,2),Ze=fe[0],be=fe[1],De=(0,I.useState)(""),ge=(0,N.Z)(De,2),J=ge[0],ye=ge[1];(0,I.useEffect)((0,c.Z)((0,d.Z)().mark(function S(){return(0,d.Z)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!w){l.next=3;break}return l.next=3,ce();case 3:case"end":return l.stop()}},S)})),[w]);var ce=function(){var S=(0,c.Z)((0,d.Z)().mark(function D(){var l,a,Z,te;return(0,d.Z)().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return B(!0),O.next=3,_e({id:w});case 3:a=O.sent,a.voice_map=a==null||(l=a.voice_files)===null||l===void 0?void 0:l.reduce(function(ne,x){var pe="".concat(x==null?void 0:x.voice_template,"_").concat(x==null?void 0:x.para_content_uniq);return ne[pe]=x,ne},{}),Be(a),(a==null?void 0:a.book_voice_relation.length)>0&&ye(a==null||(Z=a.book_voice_relation[0])===null||Z===void 0||(te=Z.voice_template)===null||te===void 0?void 0:te.id),B(a);case 8:case"end":return O.stop()}},D)}));return function(){return S.apply(this,arguments)}}(),Me=[{title:"ID",dataIndex:"id"},{title:"\u77E5\u8BC6\u70B9",dataIndex:"knowledge"},{title:"\u6BB5\u843D\u5185\u5BB9",dataIndex:"para_content",valueType:"textarea"},{title:"\u8BED\u97F3\u72B6\u6001",dataIndex:"_",render:function(D,l){var a,Z="".concat(J,"_").concat(l==null?void 0:l.para_content_uniq);return h!=null&&(a=h.voice_map)!==null&&a!==void 0&&a[Z]?(h==null?void 0:h.voice_map[Z].job_state)==0?(0,m.jsx)(j.Z,{color:"processing",children:"\u751F\u6210\u4E2D"}):(0,m.jsx)(j.Z,{color:"success",children:"\u5DF2\u751F\u6210"}):(0,m.jsx)(j.Z,{color:"default",children:"\u5F85\u751F\u6210"})}},{title:"\u64CD\u4F5C",dataIndex:"option",valueType:"option",render:function(D,l){var a,Z;return[(0,m.jsx)(L.Z,{title:"\u786E\u8BA4\u91CD\u65B0\u751F\u6210\u8BED\u97F3\u5417\uFF1F",onConfirm:function(){try{var X={pic_book:w,voice_template:J,para_content_uniq:l==null?void 0:l.para_content_uniq};o(X),b.ZP.success("\u64CD\u4F5C\u6210\u529F\uFF0C\u8BF7\u7A0D\u540E\u5237\u65B0\u9875\u9762\u67E5\u770B\u72B6\u6001")}catch(O){b.ZP.error("\u64CD\u4F5C\u5931\u8D25")}},children:(0,m.jsx)("a",{children:"\u91CD\u65B0\u751F\u6210"})},"1"),(0,m.jsxs)("a",{hidden:!(h!=null&&(a=h.voice_map)!==null&&a!==void 0&&(Z=a["".concat(J,"_").concat(l==null?void 0:l.para_content_uniq)])!==null&&Z!==void 0&&Z.voice_file),onClick:function(){var X,O,ne=h==null||(X=h.voice_map)===null||X===void 0||(O=X["".concat(J,"_").concat(l==null?void 0:l.para_content_uniq)])===null||O===void 0?void 0:O.voice_file,x=new Audio(ne);x.play().catch(function(pe){console.error("\u97F3\u9891\u64AD\u653E\u5931\u8D25:",pe)})},children:[(0,m.jsx)(Q.Z,{style:{marginRight:"2px",fontSize:"16px",color:"blue"}})," \u8BD5\u542C"]})]}}];return(0,m.jsxs)(ee.ZP,{title:!1,pageHeaderRender:!1,loading:ae,children:[(0,m.jsx)(y.Z,{tabBarExtraContent:(0,m.jsxs)($.Z,{type:"primary",onClick:function(){be(!0)},children:[(0,m.jsx)(ie.Z,{}),"\u5173\u8054\u65B0\u8BED\u97F3\u6A21\u677F"]}),defaultActiveKey:J,items:h==null||(v=h.book_voice_relation)===null||v===void 0?void 0:v.map(function(S,D){var l=String(D+1),a=S==null?void 0:S.voice_template;return{label:"".concat(a==null?void 0:a.title,"(").concat(a==null?void 0:a.language,"\xB7").concat(a==null?void 0:a.tts_model,")"),key:a==null?void 0:a.id}}),onChange:function(D){ye(D)}}),(h==null||(r=h.book_voice_relation)===null||r===void 0?void 0:r.length)>0?(0,m.jsx)(ve.ZP,{headerTitle:"\u6BB5\u843D\u5217\u8868",rowKey:"key",size:"small",search:!1,options:{density:!1,reload:!1,setting:!1},toolBarRender:function(){return[(0,m.jsx)($.Z,{type:"dashed",style:{color:"red"},children:(0,m.jsxs)(L.Z,{title:"\u6279\u91CF\u751F\u6210\u6A21\u677F\u6240\u6709\u8BED\u97F3\u5417",onConfirm:(0,c.Z)((0,d.Z)().mark(function D(){var l;return(0,d.Z)().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.prev=0,l={pic_book:w,voice_template:J},Z.next=4,he(l);case 4:b.ZP.success("\u64CD\u4F5C\u6210\u529F\uFF0C\u7A0D\u540E\u5237\u65B0\u5217\u8868\u67E5\u770B\u72B6\u6001."),Z.next=10;break;case 7:Z.prev=7,Z.t0=Z.catch(0),b.ZP.error("\u64CD\u4F5C\u5931\u8D25");case 10:case"end":return Z.stop()}},D,null,[[0,7]])})),children:[(0,m.jsx)(Q.Z,{})," \u6279\u91CF\u751F\u6210"]},"delete")},"primary"),(0,m.jsxs)($.Z,{onClick:(0,c.Z)((0,d.Z)().mark(function D(){return(0,d.Z)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,ce();case 2:case"end":return a.stop()}},D)})),children:[(0,m.jsx)(q.Z,{})," \u5237\u65B0"]})]},dataSource:(h==null?void 0:h.paragraph)||[],columns:Me||[]}):(0,m.jsx)("span",{children:"\u6682\u65E0\u5173\u8054\u8BED\u97F3\u6A21\u677F\uFF0C\u8BF7\u5148\u521B\u5EFA"}),Ze&&(0,m.jsx)(je,{setShowModal:be,showModal:Ze,updateVoiceListFunc:ce,picBookId:w})]})},$e=Te},61870:function(de,Y,e){"use strict";e.d(Y,{lQ:function(){return M},Cy:function(){return d},e:function(){return N},zk:function(){return ie},Zz:function(){return I},Y6:function(){return oe},Dh:function(){return ue}});var A=e(93224),y=e(39428),R=e(11849),$=e(3182),P=e(78370),L=["id"],E=["id"],b=null;function M(o,n){return j.apply(this,arguments)}function j(){return j=(0,$.Z)((0,y.Z)().mark(function o(n,_){return(0,y.Z)().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,P.Z)("/api/pic_book/book/",(0,R.Z)({method:"GET",data:(0,R.Z)({},n)},_||{})));case 1:case"end":return u.stop()}},o)})),j.apply(this,arguments)}function d(o,n){return c.apply(this,arguments)}function c(){return c=(0,$.Z)((0,y.Z)().mark(function o(n,_){var t,u,k;return(0,y.Z)().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return t=n.id,u=t===void 0?0:t,k=(0,A.Z)(n,L),g.abrupt("return",(0,P.Z)("/api/pic_book/book/".concat(u,"/"),(0,R.Z)({method:"GET"},_||{})));case 2:case"end":return g.stop()}},o)})),c.apply(this,arguments)}function N(o,n){return Q.apply(this,arguments)}function Q(){return Q=(0,$.Z)((0,y.Z)().mark(function o(n,_){var t,u,k;return(0,y.Z)().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return t=n.id,u=t===void 0?0:t,k=(0,A.Z)(n,E),g.abrupt("return",(0,P.Z)("/api/pic_book/book/".concat(u,"/preview/"),(0,R.Z)({method:"GET"},_||{})));case 2:case"end":return g.stop()}},o)})),Q.apply(this,arguments)}function ie(o,n,_){return q.apply(this,arguments)}function q(){return q=(0,$.Z)((0,y.Z)().mark(function o(n,_,t){return(0,y.Z)().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.abrupt("return",(0,P.Z)("/api/pic_book/book/".concat(n,"/"),(0,R.Z)({method:"PATCH",data:_},t||{})));case 1:case"end":return k.stop()}},o)})),q.apply(this,arguments)}function I(o,n){return ee.apply(this,arguments)}function ee(){return ee=(0,$.Z)((0,y.Z)().mark(function o(n,_){return(0,y.Z)().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,P.Z)("/api/pic_book/book/",(0,R.Z)({method:"POST",data:n},_||{})));case 1:case"end":return u.stop()}},o)})),ee.apply(this,arguments)}function ve(o,n){return V.apply(this,arguments)}function V(){return V=_asyncToGenerator(_regeneratorRuntime().mark(function o(n,_){var t,u;return _regeneratorRuntime().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return t=n.id,u=t===void 0?0:t,C.abrupt("return",request("/api/pic_book/book/".concat(u),_objectSpread({method:"DELETE"},_||{})));case 2:case"end":return C.stop()}},o)})),V.apply(this,arguments)}function oe(o){return G.apply(this,arguments)}function G(){return G=(0,$.Z)((0,y.Z)().mark(function o(n){return(0,y.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,P.Z)("/api/pic_book/voice_template/",(0,R.Z)({method:"GET"},n||{})));case 1:case"end":return t.stop()}},o)})),G.apply(this,arguments)}function ue(o){return re.apply(this,arguments)}function re(){return re=(0,$.Z)((0,y.Z)().mark(function o(n){return(0,y.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,P.Z)("/api/pic_book/author/",(0,R.Z)({method:"GET"},n||{})));case 1:case"end":return t.stop()}},o)})),re.apply(this,arguments)}function _e(o,n){return U.apply(this,arguments)}function U(){return U=_asyncToGenerator(_regeneratorRuntime().mark(function o(n,_){var t,u,k;return _regeneratorRuntime().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return t=n.id,u=t===void 0?0:t,k=_objectWithoutProperties(n,b),g.abrupt("return",request("/api/pic_book/chapter/".concat(u,"/"),_objectSpread({method:"PATCH",data:k},_||{})));case 2:case"end":return g.stop()}},o)})),U.apply(this,arguments)}function me(o,n){return W.apply(this,arguments)}function W(){return W=_asyncToGenerator(_regeneratorRuntime().mark(function o(n,_){return _regeneratorRuntime().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",request("/api/pic_book/chapter/",_objectSpread({method:"POST",data:_objectSpread({},n)},_||{})));case 1:case"end":return u.stop()}},o)})),W.apply(this,arguments)}function he(o,n){return K.apply(this,arguments)}function K(){return K=_asyncToGenerator(_regeneratorRuntime().mark(function o(n,_){var t,u;return _regeneratorRuntime().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return t=n.id,u=t===void 0?0:t,C.abrupt("return",request("/api/pic_book/chapter/".concat(u,"/"),_objectSpread({method:"DELETE"},_||{})).catch(function(g){return{}}));case 2:case"end":return C.stop()}},o)})),K.apply(this,arguments)}},78370:function(de,Y,e){"use strict";var A=e(39428),y=e(34792),R=e(48086),$=e(3182),P=e(11849),L=e(11238);L.ZP.interceptors.request.use(function(E,b){if(E!="/v2api/auth/users/current/"){var M={Authorization:"Token "+localStorage.getItem("token")};return{url:E,options:(0,P.Z)((0,P.Z)({},b),{},{headers:M,interceptors:!0})}}return{url:E,options:(0,P.Z)((0,P.Z)({},b),{},{interceptors:!0})}}),L.ZP.interceptors.request.use(function(E,b){return{url:"".concat(E),options:(0,P.Z)((0,P.Z)({},b),{},{interceptors:!0})}},{global:!0}),L.ZP.interceptors.response.use(function(E,b){var M=E.headers.get("Content-Type");return E}),L.ZP.interceptors.response.use(function(){var E=(0,$.Z)((0,A.Z)().mark(function b(M){var j;return(0,A.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return j={500:"\u670D\u52A1\u5668\u53D1\u751F\u9519\u8BEF\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5",502:"\u7F51\u5173\u9519\u8BEF\u3002",503:"\u670D\u52A1\u4E0D\u53EF\u7528\uFF0C\u670D\u52A1\u5668\u6682\u65F6\u8FC7\u8F7D\u6216\u7EF4\u62A4\u3002",504:"\u7F51\u5173\u8D85\u65F6\u3002"},j[M.status]&&R.ZP.error(j[M.status]),c.abrupt("return",M);case 3:case"end":return c.stop()}},b)}));return function(b){return E.apply(this,arguments)}}()),L.ZP.interceptors.response.use(function(){var E=(0,$.Z)((0,A.Z)().mark(function b(M){var j;return(0,A.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,M.clone().json();case 2:return j=c.sent,j&&j.NOT_LOGIN&&(location.href="\u767B\u5F55url"),c.abrupt("return",M);case 5:case"end":return c.stop()}},b)}));return function(b){return E.apply(this,arguments)}}()),Y.Z=L.ZP}}]);
