(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[622],{88263:function(va,Oe,l){"use strict";l.r(Oe),l.d(Oe,{default:function(){return vt}});var Ze=l(22385),H=l(45777),se=l(18106),ue=l(63885),we=l(20228),De=l(11382),We=l(32157),Ee=l(3974),Ve=l(34792),F=l(48086),u=l(39428),w=l(3182),_=l(2824),m=l(67294),fe=l(87720),de=l(61870),ae=l(1351),me=l(76629),$e=l(42698),K=l(11849),Ce=l(93224),q=l(78370),He=null,Ie=["id"],fa=["id"],Ae=["id"],ma=null,Ge=["id"],ga=["id"],Ue=null,j=["id"],D=["id"];function N(d,e){return x.apply(this,arguments)}function x(){return x=_asyncToGenerator(_regeneratorRuntime().mark(function d(e,s){var r,t,o;return _regeneratorRuntime().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r=e.id,t=r===void 0?0:r,o=_objectWithoutProperties(e,He),i.abrupt("return",request("/api/pic_book/book/".concat(t,"/chapter_page_menu/"),_objectSpread({method:"GET"},s||{})));case 2:case"end":return i.stop()}},d)})),x.apply(this,arguments)}function T(d,e){return te.apply(this,arguments)}function te(){return te=(0,w.Z)((0,u.Z)().mark(function d(e,s){var r,t,o;return(0,u.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r=e.id,t=r===void 0?0:r,o=(0,Ce.Z)(e,Ie),i.abrupt("return",(0,q.Z)("/api/pic_book/book/".concat(t,"/chapter_menu/"),(0,K.Z)({method:"GET"},s||{})));case 2:case"end":return i.stop()}},d)})),te.apply(this,arguments)}function oe(d,e){return Q.apply(this,arguments)}function Q(){return Q=(0,w.Z)((0,u.Z)().mark(function d(e,s){return(0,u.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,q.Z)("/api/pic_book/chapter/",(0,K.Z)({method:"POST",data:(0,K.Z)({},e)},s||{})));case 1:case"end":return t.stop()}},d)})),Q.apply(this,arguments)}function Da(d,e){return Ne.apply(this,arguments)}function Ne(){return Ne=(0,w.Z)((0,u.Z)().mark(function d(e,s){var r,t,o;return(0,u.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r=e.id,t=r===void 0?0:r,o=(0,Ce.Z)(e,fa),i.abrupt("return",(0,q.Z)("/api/pic_book/chapter/".concat(t,"/"),(0,K.Z)({method:"GET",params:o},s||{})));case 2:case"end":return i.stop()}},d)})),Ne.apply(this,arguments)}function ya(d,e){return Je.apply(this,arguments)}function Je(){return Je=(0,w.Z)((0,u.Z)().mark(function d(e,s){var r,t,o;return(0,u.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r=e.id,t=r===void 0?0:r,o=(0,Ce.Z)(e,Ae),i.abrupt("return",(0,q.Z)("/api/pic_book/chapter/".concat(t,"/"),(0,K.Z)({method:"PATCH",data:o},s||{})));case 2:case"end":return i.stop()}},d)})),Je.apply(this,arguments)}function ft(d,e){return Ye.apply(this,arguments)}function Ye(){return Ye=_asyncToGenerator(_regeneratorRuntime().mark(function d(e,s){var r,t;return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.id,t=r===void 0?0:r,n.abrupt("return",request("/api/pic_book/chapter/".concat(t,"/"),_objectSpread({method:"DELETE"},s||{})).catch(function(i){return{}}));case 2:case"end":return n.stop()}},d)})),Ye.apply(this,arguments)}function mt(d,e){return Qe.apply(this,arguments)}function Qe(){return Qe=_asyncToGenerator(_regeneratorRuntime().mark(function d(e,s){var r,t,o;return _regeneratorRuntime().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r=e.id,t=r===void 0?0:r,o=_objectWithoutProperties(e,ma),i.abrupt("return",request("/api/pic_book/book_page/".concat(t,"/"),_objectSpread({method:"GET",params:o},s||{})));case 2:case"end":return i.stop()}},d)})),Qe.apply(this,arguments)}function Ca(d,e){return Xe.apply(this,arguments)}function Xe(){return Xe=(0,w.Z)((0,u.Z)().mark(function d(e,s){var r,t,o;return(0,u.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r=e.id,t=r===void 0?0:r,o=(0,Ce.Z)(e,Ge),i.abrupt("return",(0,q.Z)("/api/pic_book/chapter/".concat(t,"/paragraph/"),(0,K.Z)({method:"GET",params:o},s||{})));case 2:case"end":return i.stop()}},d)})),Xe.apply(this,arguments)}function gt(d,e){return qe.apply(this,arguments)}function qe(){return qe=_asyncToGenerator(_regeneratorRuntime().mark(function d(e,s){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/api/pic_book/paragraph/",_objectSpread({method:"GET",params:_objectSpread({},e)},s||{})));case 1:case"end":return t.stop()}},d)})),qe.apply(this,arguments)}function Sa(d,e){return ea.apply(this,arguments)}function ea(){return ea=(0,w.Z)((0,u.Z)().mark(function d(e,s){return(0,u.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,q.Z)("/api/pic_book/paragraph/",(0,K.Z)({method:"POST",data:e},s||{})));case 1:case"end":return t.stop()}},d)})),ea.apply(this,arguments)}function ja(d,e,s){return aa.apply(this,arguments)}function aa(){return aa=(0,w.Z)((0,u.Z)().mark(function d(e,s,r){return(0,u.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,q.Z)("/api/pic_book/paragraph/".concat(e,"/"),(0,K.Z)({method:"PATCH",data:s},r||{})));case 1:case"end":return o.stop()}},d)})),aa.apply(this,arguments)}function Za(d,e){return ta.apply(this,arguments)}function ta(){return ta=(0,w.Z)((0,u.Z)().mark(function d(e,s){var r,t;return(0,u.Z)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.id,t=r===void 0?0:r,n.abrupt("return",(0,q.Z)("/api/pic_book/paragraph/".concat(t,"/"),(0,K.Z)({method:"DELETE"},s||{})).catch(function(i){return{}}));case 2:case"end":return n.stop()}},d)})),ta.apply(this,arguments)}function Ta(d,e){return ra.apply(this,arguments)}function ra(){return ra=(0,w.Z)((0,u.Z)().mark(function d(e,s){var r,t,o;return(0,u.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r=e.id,t=r===void 0?0:r,o=(0,Ce.Z)(e,ga),i.abrupt("return",(0,q.Z)("/api/pic_book/paragraph/set_seq/",(0,K.Z)({method:"POST",data:o},s||{})));case 2:case"end":return i.stop()}},d)})),ra.apply(this,arguments)}function Ma(d,e){return na.apply(this,arguments)}function na(){return na=(0,w.Z)((0,u.Z)().mark(function d(e,s){return(0,u.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,q.Z)("/api/pic_book/book/sort_menu/",(0,K.Z)({method:"POST",data:(0,K.Z)({},e)},s||{})));case 1:case"end":return t.stop()}},d)})),na.apply(this,arguments)}function yt(d,e){return ia.apply(this,arguments)}function ia(){return ia=_asyncToGenerator(_regeneratorRuntime().mark(function d(e,s){var r,t,o;return _regeneratorRuntime().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r=e.id,t=r===void 0?0:r,o=_objectWithoutProperties(e,Ue),i.abrupt("return",request("/api/pic_book/book/".concat(t,"/chapter_typeset/"),_objectSpread({method:"GET",params:_objectSpread({},o)},s||{})));case 2:case"end":return i.stop()}},d)})),ia.apply(this,arguments)}function Ea(d,e){return la.apply(this,arguments)}function la(){return la=(0,w.Z)((0,u.Z)().mark(function d(e,s){return(0,u.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,q.Z)("/api/pic_book/typeset/",(0,K.Z)({method:"POST",data:(0,K.Z)({},e)},s||{})));case 1:case"end":return t.stop()}},d)})),la.apply(this,arguments)}function $a(d,e){return ua.apply(this,arguments)}function ua(){return ua=(0,w.Z)((0,u.Z)().mark(function d(e,s){var r,t,o;return(0,u.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r=e.id,t=r===void 0?0:r,o=(0,Ce.Z)(e,j),i.abrupt("return",(0,q.Z)("/api/pic_book/typeset/".concat(t,"/"),(0,K.Z)({method:"PATCH",data:(0,K.Z)({},o)},s||{})));case 2:case"end":return i.stop()}},d)})),ua.apply(this,arguments)}function wa(d,e){return oa.apply(this,arguments)}function oa(){return oa=(0,w.Z)((0,u.Z)().mark(function d(e,s){var r,t;return(0,u.Z)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.id,t=r===void 0?0:r,n.abrupt("return",(0,q.Z)("/api/pic_book/typeset/".concat(t,"/"),(0,K.Z)({method:"DELETE"},s||{})).catch(function(i){return{}}));case 2:case"end":return n.stop()}},d)})),oa.apply(this,arguments)}function Fa(d,e){return sa.apply(this,arguments)}function sa(){return sa=(0,w.Z)((0,u.Z)().mark(function d(e,s){var r,t,o;return(0,u.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r=e.id,t=r===void 0?0:r,o=(0,Ce.Z)(e,D),i.abrupt("return",(0,q.Z)("/api/pic_book/chapter_typeset/".concat(t,"/"),(0,K.Z)({method:"PATCH",data:(0,K.Z)({},o)},s||{})));case 2:case"end":return i.stop()}},d)})),sa.apply(this,arguments)}var Zt=l(57106),Ba=l(99683),wt=l(49111),da=l(19650),bt=l(62350),ba=l(24565),Oa=l(32059),_t=l(12968),Ra=l(20352),Re=l(952),La=l(60451),Ke=l(27510),_a=l(5314),ca=l(86028),ze=l(27408),Ia=l(92305),Aa=l(42762),a=l(85893),Ga=function(e){var s=(0,m.useRef)(),r=e.showModal,t=e.setShowModal,o=e.chapterParaData,n=e.updateChapterParaDataFunc,i=[{title:"\u6392\u5E8F",dataIndex:"seq",render:function(v,b,f){return(0,a.jsxs)("span",{className:"customRender",children:[" ",b==null?void 0:b.seq]})}},{title:"ID",dataIndex:"id"},{title:"\u5185\u5BB9",dataIndex:"para_content"},{title:"\u77E5\u8BC6\u70B9",dataIndex:"knowledge"}],M=function(){var h=(0,w.Z)((0,u.Z)().mark(function v(b,f,C){var y;return(0,u.Z)().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return y=C==null?void 0:C.map(function(z,S){return z==null?void 0:z.id}),E.next=3,Ta({seq_list:y});case 3:return E.next=5,n();case 5:case"end":return E.stop()}},v)}));return function(b,f,C){return h.apply(this,arguments)}}(),c=function(v,b){return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(Aa.Z,{style:{cursor:"grab",color:"gold"}})})};return(0,a.jsx)(ze.Y,{title:"\u8C03\u6574\u6BB5\u843D\u5185\u5BB9\u987A\u5E8F",width:"600px",layout:"horizontal",visible:r,onVisibleChange:t,onFinish:function(){var h=(0,w.Z)((0,u.Z)().mark(function v(b){return(0,u.Z)().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:t(!1);case 1:case"end":return C.stop()}},v)}));return function(v){return h.apply(this,arguments)}}(),modalProps:{closable:!1},submitter:{render:function(v,b){return(0,a.jsxs)("div",{children:[b[1]," "]})}},children:(0,a.jsx)(Ia.Z,{actionRef:s,columns:i,rowKey:"id",size:"small",search:!1,options:{density:!1},toolBarRender:!1,pagination:!1,dataSource:o==null?void 0:o.paragraph,dragSortKey:"seq",onDragSortEnd:M,dragSortHandlerRender:c})})},Ua=Ga,pa=l(47745),Ka=function(e){var s=e.showModal,r=e.setShowModal,t=e.chapterData,o=e.updateChapterParaDataFunc,n=e.refreshMenu;return console.log("chapterData",t),(0,a.jsxs)(ze.Y,{title:"\u7F16\u8F91\u7AE0\u8282",width:"500px",layout:"horizontal",visible:s,onVisibleChange:r,initialValues:t,onFinish:function(){var i=(0,w.Z)((0,u.Z)().mark(function M(c){var h,v;return(0,u.Z)().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return h={id:t==null?void 0:t.id,title:c==null?void 0:c.title,text_template:c==null?void 0:c.text_template},f.next=3,ya(h);case 3:if(v=f.sent,!v){f.next=8;break}return F.ZP.success("\u66F4\u65B0\u7AE0\u8282\u6A21\u677F\u6210\u529F"),f.next=8,o();case 8:if((t==null?void 0:t.title)==(c==null?void 0:c.title)){f.next=11;break}return f.next=11,n();case 11:r(!1);case 12:case"end":return f.stop()}},M)}));return function(M){return i.apply(this,arguments)}}(),children:[(0,a.jsx)(pa.Z,{name:"title",label:"\u6807\u9898",rules:[{required:!0}]}),(0,a.jsx)(pa.Z,{name:"text_template",label:"\u6A21\u677F",rules:[{required:!0}]})]})},za=Ka,xt=l(13062),xa=l(71230),Pt=l(57663),Wa=l(71577),kt=l(89032),ha=l(15746),Dt=l(71153),Va=l(60331),Se=l(21832),Ha=l(25641),Na=function(e){var s,r=e.typesetData,t=e.showTypesetModal,o=e.setShowTypesetModal,n=e.layoutOptionsData,i=e.refreshSelectTagFunc,M=e.updateChapterParaDataFunc,c=e.index,h=c===void 0?void 0:c;return(0,a.jsx)(ze.Y,{title:h!=null?"\u7F16\u8F91\u5E03\u5C40\u9875\u9762":"\u65B0\u589E\u5E03\u5C40\u9875\u9762",width:"500px",layout:"horizontal",visible:t,onVisibleChange:o,initialValues:h!=null?{layout:r==null||(s=r.setting)===null||s===void 0?void 0:s[h]}:{},onFinish:function(){var v=(0,w.Z)((0,u.Z)().mark(function b(f){var C,y;return(0,u.Z)().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return C={id:r==null?void 0:r.id,setting:r==null?void 0:r.setting},h==null?C.setting.push(f==null?void 0:f.layout):C.setting[h]=f==null?void 0:f.layout,E.next=4,Fa(C);case 4:if(y=E.sent,o(!1),!(y!=null&&y.id)){E.next=12;break}return E.next=9,M();case 9:i(),E.next=13;break;case 12:F.ZP.error("\u6DFB\u52A0\u5931\u8D25");case 13:case"end":return E.stop()}},b)}));return function(b){return v.apply(this,arguments)}}(),children:(0,a.jsx)(Ha.Z,{rules:[{required:!0}],labelCol:{span:4},width:"md",label:"\u9875\u9762\u6A21\u677F",name:"layout",options:n})})},Pa=Na,Ja=function(e,s,r,t){var o,n,i=0,M=0;return s>0&&(e==null||e.forEach(function(c,h){if(h<s){var v,b;i+=(v=JSON.parse(t==null||(b=t[c])===null||b===void 0?void 0:b.grid_row_col))===null||v===void 0?void 0:v.length}})),M=i+((o=JSON.parse(t==null||(n=t[r])===null||n===void 0?void 0:n.grid_row_col))===null||o===void 0?void 0:o.length),{start:i,end:M}},Ya=function(e){var s,r,t,o=e.chapterParaData,n=e.layoutOriginData,i=e.layoutTemplateId,M=e.index,c=e.layoutOptionsData,h=e.paraLayoutRelation,v=e.setParaLayoutRelation,b=e.setLoading,f=e.pageLayoutList,C=e.currentTypeset,y=e.updateChapterParaDataFunc,B=e.refreshSelectTagFunc,E=(0,m.useState)(!1),z=(0,_.Z)(E,2),S=z[0],P=z[1],R=(0,Se.vT)(n),W=Ja(f,M,i,R),p=R==null?void 0:R[i],re=o==null||(s=o.paragraphs)===null||s===void 0?void 0:s.slice(W==null?void 0:W.start,W==null?void 0:W.end);return(0,a.jsxs)("div",{children:[(0,a.jsx)(Ke.Z,{title:"\u9875\u9762".concat(M+1),bordered:!0,extra:(0,a.jsx)(da.Z,{children:(0,a.jsx)("a",{hidden:(C==null?void 0:C.c_type)=="norm",onClick:function(){P(!0)},children:"\u5207\u6362"})}),children:(0,a.jsx)("div",{style:{height:"350px",border:"1px dashed gray",backgroundImage:"url(".concat(p==null?void 0:p.background_img,")"),backgroundColor:p==null?void 0:p.background_color},children:(0,a.jsx)(xa.Z,{gutter:p==null?void 0:p.grid_gutter,align:"stretch",style:{height:"100%"},children:(r=JSON.parse(p==null?void 0:p.grid_row_col))===null||r===void 0?void 0:r.map(function(I,ee){var ge,ce=(re==null?void 0:re[ee])||{},pe="",be="",_e=(p==null?void 0:p.font_size)||14;return((ge=JSON.parse(p==null?void 0:p.grid_row_col))===null||ge===void 0?void 0:ge.length)==1?(pe="50%",be="50%",_e=_e*2):(pe="92%",be="8%"),(0,a.jsxs)(ha.Z,{span:I,children:[(0,a.jsx)("div",{style:{fontFamily:(p==null?void 0:p.font_family)||"Arial",fontSize:(p==null?void 0:p.font_size)||14,color:(p==null?void 0:p.font_color)||"black",backgroundImage:"url(".concat(ce==null?void 0:ce.illustration,")"),backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center",opacity:(p==null?void 0:p.text_opacity)||1,height:pe,display:"flex",flexDirection:"column",alignItems:(p==null?void 0:p.text_flex_align)||"center",justifyContent:(p==null?void 0:p.text_flex_justify)||"center"}}),(0,a.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",fontFamily:(p==null?void 0:p.font_family)||"Arial",fontSize:_e,color:(p==null?void 0:p.font_color)||"black",height:be},children:ce==null?void 0:ce.para_content})]})})})})}),S&&(0,a.jsx)(Pa,{showTypesetModal:S,setShowTypesetModal:P,updateChapterParaDataFunc:y,refreshSelectTagFunc:B,typesetData:C==null||(t=C.chapter_typesets)===null||t===void 0?void 0:t.find(function(I){var ee;return I.chapter==(o==null||(ee=o.chapter)===null||ee===void 0?void 0:ee.id)}),layoutOptionsData:c,index:M})]})},Qa=Ya,Xa=l(51042),qa=Va.Z.CheckableTag,et=function(e){var s,r,t,o=e.selectTypeset,n=e.chapterParaData,i=e.layoutOptionsData,M=e.layoutOriginData,c=e.updateChapterParaDataFunc,h=n==null||(s=n.typeset_data)===null||s===void 0?void 0:s.find(function(V){return V.id===o}),v=(0,m.useState)([]),b=(0,_.Z)(v,2),f=b[0],C=b[1],y=(n==null||(r=n.paragraphs)===null||r===void 0?void 0:r.map(function(V){return V==null?void 0:V.knowledge}))||[],B=(0,m.useState)([]),E=(0,_.Z)(B,2),z=E[0],S=E[1],P=(0,m.useState)([]),R=(0,_.Z)(P,2),W=R[0],p=R[1],re=(0,m.useState)(!1),I=(0,_.Z)(re,2),ee=I[0],ge=I[1],ce=(0,m.useState)({}),pe=(0,_.Z)(ce,2),be=pe[0],_e=pe[1],Le=(0,m.useState)(!1),he=(0,_.Z)(Le,2),je=he[0],Fe=he[1],Te=function(){if(Fe(!0),(h==null?void 0:h.c_type)=="norm"){C((h==null?void 0:h.setting)||[]),S(y);var Z=(0,Se.ic)(y,h),xe=Array(Z).fill(h==null?void 0:h.setting).flat();p(xe)}else{var J,Y,A=(h==null||(J=h.chapter_typesets)===null||J===void 0||(Y=J.find(function($){var G;return $.chapter==(n==null||(G=n.chapter)===null||G===void 0?void 0:G.id)}))===null||Y===void 0?void 0:Y.setting)||[];C(A);var k=(0,Se.P7)(A,M,y),ne=k.select_cnt,ie=k.format_layout;S(y==null?void 0:y.slice(0,ne)),p(ie)}Fe(!1)};return(0,m.useEffect)(function(){Te()},[f,o,n==null||(t=n.chapter)===null||t===void 0?void 0:t.id,n==null?void 0:n.paragraphs]),(0,a.jsxs)(De.Z,{spinning:je,children:[(0,a.jsx)(Re.ZP.Item,{label:"\u5DF2\u6392\u7248\u6BB5\u843D",children:(0,a.jsx)(da.Z,{size:[0,8],wrap:!0,children:y.map(function(V){return(0,a.jsx)(qa,{checked:z.includes(V),children:V},V)})})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(xa.Z,{gutter:16,children:[W==null?void 0:W.map(function(V,Z){return(0,a.jsx)(ha.Z,{span:8,children:(0,a.jsx)(Qa,{chapterParaData:n,layoutOriginData:M,layoutOptionsData:i,layoutTemplateId:V,index:Z,currentTypeset:h,setLoading:Fe,refreshSelectTagFunc:Te,pageLayoutList:W,paraLayoutRelation:f,setParaLayoutRelation:C,updateChapterParaDataFunc:c})})}),(h==null?void 0:h.c_type)=="custom"&&(z==null?void 0:z.length)<(y==null?void 0:y.length)&&(0,a.jsx)(ha.Z,{span:8,children:(0,a.jsx)(Ke.Z,{title:(0,a.jsx)("div",{children:"\xA0"}),bordered:!0,children:(0,a.jsx)("div",{style:{height:"350px",display:"flex",justifyContent:"center",alignItems:"center",border:"1px dashed gray"},children:(0,a.jsxs)(Wa.Z,{type:"primary",onClick:function(){var Z;ge(!0),_e(h==null||(Z=h.chapter_typesets)===null||Z===void 0?void 0:Z.find(function(xe){var J;return xe.chapter==(n==null||(J=n.chapter)===null||J===void 0?void 0:J.id)}))},children:[(0,a.jsx)(Xa.Z,{}),"\u65B0\u5EFA"]})})})})]}),ee&&(0,a.jsx)(Pa,{showTypesetModal:ee,setShowTypesetModal:ge,refreshSelectTagFunc:Te,updateChapterParaDataFunc:c,typesetData:be,layoutOptionsData:i})]})]})},at=et,ka=l(8212),Ct=l(17462),tt=l(76772),rt=function(e){var s=(0,m.useRef)(),r=(0,m.useRef)(),t=e.showTypesetModal,o=e.setShowTypesetModal,n=e.chapterParaData,i=e.updateChapterParaDataFunc,M=[{title:"\u6392\u5E8F",dataIndex:"seq",width:"8%"},{title:"\u6A21\u677F\u4FE1\u606F",dataIndex:"title",width:"30%",render:function(h,v){if((v==null?void 0:v.c_type)=="norm"){var b,f;return(0,a.jsxs)("div",{children:[v==null?void 0:v.title,(0,a.jsx)("br",{}),"grid_row_col: ",v==null||(b=v.layout_cfg)===null||b===void 0||(f=b[0])===null||f===void 0?void 0:f.grid_row_col]})}return v==null?void 0:v.title}},{title:"\u6A21\u677F\u7C7B\u578B",dataIndex:"c_type",width:"15%",valueEnum:{norm:{text:"\u5185\u7F6E\u6A21\u677F",value:"norm",disabled:!0},custom:{text:"\u4EBA\u5DE5\u5B9A\u5236",value:"custom"}}},{title:"\u64CD\u4F5C",valueType:"option",width:"18%",render:function(h,v,b,f){return[(0,a.jsx)("a",{hidden:(v==null?void 0:v.c_type)=="norm",onClick:function(){var y;f==null||(y=f.startEditable)===null||y===void 0||y.call(f,v.id)},children:"\u7F16\u8F91"},"editable"),(0,a.jsx)(ba.Z,{title:"\u786E\u5B9A\u5220\u9664\u6B64\u884C\uFF1F",onConfirm:(0,w.Z)((0,u.Z)().mark(function C(){return(0,u.Z)().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.prev=0,B.next=3,wa(v);case 3:return B.next=5,i();case 5:F.ZP.success("\u5220\u9664\u6210\u529F"),B.next=11;break;case 8:B.prev=8,B.t0=B.catch(0),F.ZP.error("\u5220\u9664\u5931\u8D25");case 11:case"end":return B.stop()}},C,null,[[0,8]])})),children:(0,a.jsx)("a",{hidden:(v==null?void 0:v.c_type)=="norm",children:"\u5220\u9664"})},"delete")]}}];return(0,a.jsxs)(ze.Y,{title:"\u7F16\u8F91\u7ED8\u672C\u5E03\u5C40",width:"750px",layout:"horizontal",visible:t,onVisibleChange:o,submitter:!1,children:[(0,a.jsx)(tt.Z,{message:"\u5F53\u524D\u4EC5\u652F\u6301\u6DFB\u52A0\u4EBA\u5DE5\u5B9A\u5236\u5E03\u5C40",type:"warning"}),(0,a.jsx)(_a.Z,{rowKey:"id",headerTitle:!1,actionRef:s,editableFormRef:r,style:{width:"100%"},recordCreatorProps:{position:"bottom",creatorButtonText:"\u6DFB\u52A0\u5E03\u5C40",record:function(){var h;return{id:(0,ca.DO)(),seq:((n==null||(h=n.typeset_data)===null||h===void 0?void 0:h.reduce(function(v,b){return b.seq>v?b.seq:v},0))||0)+1}}},loading:!1,columns:M,value:(n==null?void 0:n.typeset_data)||[],editable:{type:"multiple",onSave:function(){var c=(0,w.Z)((0,u.Z)().mark(function v(b,f,C){var y,B,E;return(0,u.Z)().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(f.pic_book=n==null||(y=n.chapter)===null||y===void 0?void 0:y.pic_book,typeof b!="string"){S.next=8;break}return S.next=4,Ea(f);case 4:B=S.sent,B!=null&&B.id?F.ZP.success("\u65B0\u589E\u6210\u529F"):F.ZP.error("\u65B0\u589E\u5931\u8D25"),S.next=12;break;case 8:return S.next=10,$a(f);case 10:E=S.sent,E!=null&&E.id?F.ZP.success("\u7F16\u8F91\u6210\u529F"):F.ZP.error("\u7F16\u8F91\u5931\u8D25");case 12:return S.next=14,i();case 14:case"end":return S.stop()}},v)}));function h(v,b,f){return c.apply(this,arguments)}return h}(),onDelete:function(){var c=(0,w.Z)((0,u.Z)().mark(function v(b,f){return(0,u.Z)().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.prev=0,console.log("row",f),y.next=4,wa(f);case 4:F.ZP.success("\u5220\u9664\u6210\u529F"),y.next=10;break;case 7:y.prev=7,y.t0=y.catch(0),F.ZP.error("\u5220\u9664\u5931\u8D25");case 10:case"end":return y.stop()}},v,null,[[0,7]])}));function h(v,b){return c.apply(this,arguments)}return h}()}})]})},nt=rt,it=function(e){var s,r,t,o,n=(0,m.useRef)(),i=e.picBookId,M=e.selectChapter,c=e.setSelectChapter,h=e.layoutOptionsData,v=e.layoutOriginData,b=e.setLayoutOriginData,f=e.configData,C=e.refreshMenu,y=(0,m.useRef)(),B=(0,m.useState)(!1),E=(0,_.Z)(B,2),z=E[0],S=E[1],P=(0,m.useState)(!1),R=(0,_.Z)(P,2),W=R[0],p=R[1],re=(0,m.useState)(!1),I=(0,_.Z)(re,2),ee=I[0],ge=I[1],ce=(0,m.useState)(!1),pe=(0,_.Z)(ce,2),be=pe[0],_e=pe[1],Le=(0,m.useState)({}),he=(0,_.Z)(Le,2),je=he[0],Fe=he[1],Te=(0,m.useState)([]),V=(0,_.Z)(Te,2),Z=V[0],xe=V[1],J=(0,m.useState)(0),Y=(0,_.Z)(J,2),A=Y[0],k=Y[1];(0,m.useEffect)((0,w.Z)((0,u.Z)().mark(function $(){return(0,u.Z)().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(!(M!=null&&M.chapter_id)){g.next=5;break}return S(!0),g.next=4,ne();case 4:S(!1);case 5:case"end":return g.stop()}},$)})),[M==null?void 0:M.chapter_id]);var ne=function(){var $=(0,w.Z)((0,u.Z)().mark(function G(){var g,le,O,ye;return(0,u.Z)().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,Ca({id:M==null?void 0:M.chapter_id});case 2:O=L.sent,O.paragraphs=O==null||(g=O.paragraphs)===null||g===void 0?void 0:g.map(function(ve,X){return(0,K.Z)((0,K.Z)({},ve),{},{illustration_url:[{url:ve.illustration}]})}),(O==null||(le=O.typeset_data)===null||le===void 0?void 0:le.length)>0&&A==0&&k((ye=O.typeset_data[0])===null||ye===void 0?void 0:ye.id),xe(O);case 6:case"end":return L.stop()}},G)}));return function(){return $.apply(this,arguments)}}(),ie=[{title:"\u6392\u5E8F",dataIndex:"seq",width:"8%"},{title:"\u77E5\u8BC6\u70B9",dataIndex:"knowledge",width:"22%",fieldProps:function(G,g){var le=g.rowIndex,O=g.rowKey;return{onChange:function(U){var L,ve,X,Pe,Be=Z==null||(L=Z.chapter)===null||L===void 0?void 0:L.text_template.replace(/{{word}}/g,U==null||(ve=U.target)===null||ve===void 0?void 0:ve.value);(X=n.current)===null||X===void 0||(Pe=X.setRowData)===null||Pe===void 0||Pe.call(X,O,{para_content:Be})}}}},{title:"\u5185\u5BB9",dataIndex:"para_content",width:"35%"},{title:"\u63D2\u56FE",dataIndex:"illustration",width:"15%",render:function(G,g){return g!=null&&g.illustration?(0,a.jsx)(Ra.Z,{src:g==null?void 0:g.illustration,width:35,height:35}):null},renderFormItem:function(G,g,le){if(G!=null&&G.entry)return(0,a.jsx)(Re.ZP,{initialValues:g==null?void 0:g.record,submitter:!1,children:(0,a.jsx)(La.Z,{max:1,name:"illustration_url",fieldProps:{data:{},defaultFileList:[],multiple:!1,accept:".png,.jpg,.jpeg",maxCount:1,customRequest:function(){var O=(0,w.Z)((0,u.Z)().mark(function U(L){var ve,X,Pe;return(0,u.Z)().wrap(function(Me){for(;;)switch(Me.prev=Me.next){case 0:ve=L.file,X=L.onSuccess,Pe=L.onError,Fe((0,Oa.Z)({},g.record.id,{file:ve,onSuccess:X,onError:Pe})),X();case 3:case"end":return Me.stop()}},U)}));function ye(U){return O.apply(this,arguments)}return ye}()},style:{height:30,width:30},extra:"\u652F\u6301 JPG\u3001PNG \u683C\u5F0F"})})}},{title:"\u64CD\u4F5C",valueType:"option",width:"18%",render:function(G,g,le,O){return[(0,a.jsx)("a",{onClick:function(){var U;O==null||(U=O.startEditable)===null||U===void 0||U.call(O,g.id)},children:"\u7F16\u8F91"},"editable"),(0,a.jsx)(ba.Z,{title:"\u786E\u5B9A\u5220\u9664\u6B64\u884C\uFF1F",onConfirm:(0,w.Z)((0,u.Z)().mark(function ye(){return(0,u.Z)().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.prev=0,L.next=3,Za(g);case 3:return L.next=5,ne();case 5:F.ZP.success("\u5220\u9664\u6210\u529F"),L.next=11;break;case 8:L.prev=8,L.t0=L.catch(0),F.ZP.error("\u5220\u9664\u5931\u8D25");case 11:case"end":return L.stop()}},ye,null,[[0,8]])})),children:(0,a.jsx)("a",{children:"\u5220\u9664"})},"delete")]}}];return(0,a.jsxs)(De.Z,{spinning:z,children:[(0,a.jsx)(Ke.Z,{title:"\u57FA\u7840\u914D\u7F6E",bordered:!0,style:{height:"100%"},children:(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"row",height:"100%"},children:[(0,a.jsxs)("div",{style:{flex:"1",display:"flex",flexDirection:"row",marginRight:"20px",position:"relative",height:35},children:[(0,a.jsx)("div",{style:{width:"50%",marginRight:"20px"},children:(0,a.jsx)(Re.ZP.Item,{label:(0,a.jsx)("strong",{children:"\u7ED8\u672C\u540D\u79F0"}),children:(0,a.jsx)("span",{children:f==null?void 0:f.title})})}),(0,a.jsx)("div",{style:{width:"50%"},children:(0,a.jsx)(Re.ZP.Item,{children:(0,a.jsx)("strong",{children:(0,a.jsxs)("a",{onClick:function(){ge(!0)},children:[(0,a.jsx)(ka.Z,{})," \u7ED8\u672C\u5E03\u5C40"]})})})}),(0,a.jsx)("div",{style:{top:0,bottom:0,left:"50%",width:"1px",backgroundColor:"#ccc",zIndex:1}})]}),(0,a.jsxs)("div",{style:{flex:"1",display:"flex",flexDirection:"row",position:"relative",height:35},children:[(0,a.jsx)("div",{style:{width:"30%",marginRight:"20px"},children:(0,a.jsx)(Re.ZP.Item,{label:(0,a.jsx)("strong",{children:"\u7AE0\u8282\u6807\u9898"}),children:(0,a.jsx)("span",{children:Z==null||(s=Z.chapter)===null||s===void 0?void 0:s.title})})}),(0,a.jsx)("div",{style:{width:"70%"},children:(0,a.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,a.jsxs)(Re.ZP.Item,{label:(0,a.jsx)("strong",{children:"\u7AE0\u8282\u6A21\u677F"}),children:[(0,a.jsx)("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:Z==null||(r=Z.chapter)===null||r===void 0?void 0:r.text_template}),(0,a.jsx)("a",{style:{marginLeft:5},onClick:function(){_e(!0)},children:(0,a.jsx)(ka.Z,{})})]})})})]})]})}),(0,a.jsx)(Ke.Z,{bordered:!0,extra:(0,a.jsx)(da.Z,{children:(0,a.jsx)("a",{onClick:function(){p(!0)},children:"\u5185\u5BB9\u6392\u5E8F"})}),style:{width:"100%",height:"100%"},title:"\u6BB5\u843D\u5185\u5BB9",children:(0,a.jsx)(_a.Z,{rowKey:"id",headerTitle:!1,actionRef:y,editableFormRef:n,scroll:{x:960,y:350},style:{width:"100%"},recordCreatorProps:{position:"bottom",creatorButtonText:"\u6DFB\u52A0\u6BB5\u843D",record:function(){var G;return{id:(0,ca.DO)(),seq:((Z==null||(G=Z.paragraphs)===null||G===void 0?void 0:G.reduce(function(g,le){return le.seq>g?le.seq:g},0))||0)+1}}},loading:!1,columns:ie,value:(Z==null?void 0:Z.paragraphs)||[],editable:{type:"multiple",onSave:function(){var $=(0,w.Z)((0,u.Z)().mark(function g(le,O,ye){var U,L,ve,X,Pe,Be,Me;return(0,u.Z)().wrap(function(ke){for(;;)switch(ke.prev=ke.next){case 0:if(X=new FormData,(U=je[le])!==null&&U!==void 0&&U.file&&X.append("illustration",(Pe=je[le])===null||Pe===void 0?void 0:Pe.file),X.append("pic_book",Z==null||(L=Z.chapter)===null||L===void 0?void 0:L.pic_book),X.append("chapter",Z==null||(ve=Z.chapter)===null||ve===void 0?void 0:ve.id),X.append("para_content",O.para_content),X.append("knowledge",O.knowledge),X.append("para_content_uniq",(0,ca.J6)(O.para_content)),typeof le!="string"){ke.next=14;break}return ke.next=10,Sa(X);case 10:Be=ke.sent,Be!=null&&Be.id?F.ZP.success("\u65B0\u589E\u6210\u529F"):F.ZP.error("\u65B0\u589E\u5931\u8D25"),ke.next=18;break;case 14:return ke.next=16,ja(O==null?void 0:O.id,X);case 16:Me=ke.sent,Me!=null&&Me.id?F.ZP.success("\u7F16\u8F91\u6210\u529F"):F.ZP.error("\u7F16\u8F91\u5931\u8D25");case 18:return ke.next=20,ne();case 20:case"end":return ke.stop()}},g)}));function G(g,le,O){return $.apply(this,arguments)}return G}(),onDelete:function(){var $=(0,w.Z)((0,u.Z)().mark(function g(le,O){return(0,u.Z)().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return U.prev=0,U.next=3,Za(O);case 3:F.ZP.success("\u5220\u9664\u6210\u529F"),U.next=9;break;case 6:U.prev=6,U.t0=U.catch(0),F.ZP.error("\u5220\u9664\u5931\u8D25");case 9:case"end":return U.stop()}},g,null,[[0,6]])}));function G(g,le){return $.apply(this,arguments)}return G}()}})}),(0,a.jsxs)(Ke.Z,{title:"\u6BB5\u843D\u6392\u7248",style:{marginTop:5},children:[(0,a.jsx)(ue.Z,{defaultActiveKey:A,items:Z==null||(t=Z.typeset_data)===null||t===void 0?void 0:t.map(function($,G){return{label:"".concat($==null?void 0:$.title,"(").concat($==null?void 0:$.c_type,")"),key:$==null?void 0:$.id}}),onChange:function(G){k(G)}}),(Z==null||(o=Z.paragraphs)===null||o===void 0?void 0:o.length)>0?(0,a.jsx)(at,{selectTypeset:A,chapterParaData:Z,layoutOriginData:v,layoutOptionsData:h,updateChapterParaDataFunc:ne}):(0,a.jsx)(Ba.ZP,{status:"warning",subTitle:"\u8BF7\u6DFB\u52A0\u6BB5\u843D\u540E\u8FDB\u884C\u6392\u7248"})]}),W&&(0,a.jsx)(Ua,{showModal:W,setShowModal:p,chapterParaData:Z,updateChapterParaDataFunc:ne}),be&&(0,a.jsx)(za,{showModal:be,setShowModal:_e,chapterData:Z==null?void 0:Z.chapter,refreshMenu:C,updateChapterParaDataFunc:ne}),ee&&(0,a.jsx)(nt,{showTypesetModal:ee,setShowTypesetModal:ge,chapterParaData:Z,updateChapterParaDataFunc:ne})]})},lt=it,ut=l(25049),St=l(62999),ot=l(54680),st=l(88611),dt=l(90672),ct=function(e){var s=(0,m.useState)(!1),r=(0,_.Z)(s,2),t=r[0],o=r[1],n=e.setShowMenuModal,i=e.showMenuModal,M=e.setEditMenu,c=e.editMenu,h=e.picBookId,v=e.layoutOptionsData,b=e.layoutOriginData,f=e.refreshMenu,C=(0,m.useState)((0,w.Z)((0,u.Z)().mark(function z(){var S,P,R;return(0,u.Z)().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,T({id:h});case 2:S=p.sent,P=S==null?void 0:S.map(function(re,I){return"children"in re&&delete re.children,re.value=re.key,re}),R=Object.assign([],P),R.unshift({key:"0-0",title:"\u65E0\u7236\u5206\u7EC4",value:"0-0"}),E(R);case 7:case"end":return p.stop()}},z)}))),y=(0,_.Z)(C,2),B=y[0],E=y[1];return(0,m.useEffect)((0,w.Z)((0,u.Z)().mark(function z(){var S;return(0,u.Z)().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(!(c!=null&&c.key)){R.next=9;break}return o(!0),R.next=4,Da({id:c==null?void 0:c.key});case 4:S=R.sent,c.text_template=S==null?void 0:S.text_template,o(!1),R.next=10;break;case 9:o(!1);case 10:case"end":return R.stop()}},z)})),[c==null?void 0:c.key]),!t&&(0,a.jsxs)(ze.Y,{title:(c==null?void 0:c.title)==null?"\u65B0\u5EFA\u7AE0\u8282":"\u4FEE\u6539\u7AE0\u8282",width:"600px",layout:"horizontal",visible:i,onVisibleChange:n,onFinish:function(){var z=(0,w.Z)((0,u.Z)().mark(function S(P){var R,W,p;return(0,u.Z)().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if((c==null?void 0:c.title)!=null){I.next=7;break}return W={pic_book:h,title:P==null?void 0:P.title,text_template:P==null?void 0:P.text_template,parent:typeof(P==null?void 0:P.parent)=="number"?P==null?void 0:P.parent:null},I.next=4,oe(W);case 4:p=I.sent,I.next=11;break;case 7:return W={id:c==null?void 0:c.key,title:P==null?void 0:P.title,text_template:P==null?void 0:P.text_template,parent:typeof(P==null?void 0:P.parent)=="number"?P==null?void 0:P.parent:null},I.next=10,ya(W);case 10:p=I.sent;case 11:if(!((R=p)!==null&&R!==void 0&&R.id)){I.next=17;break}return n(!1),I.next=15,f();case 15:I.next=18;break;case 17:F.ZP.error("\u5904\u7406\u5931\u8D25");case 18:case"end":return I.stop()}},S)}));return function(S){return z.apply(this,arguments)}}(),modalProps:{closable:!1},children:[(0,a.jsx)(pa.Z,{width:"md",name:"title",label:"\u7AE0\u8282\u540D\u79F0",labelCol:{span:4},initialValue:(c==null?void 0:c.title)||"",rules:[{required:!0}]}),(0,a.jsx)(dt.Z,{width:"md",name:"text_template",label:"\u6587\u6848\u6A21\u677F",labelCol:{span:4},initialValue:(c==null?void 0:c.text_template)||"",rules:[{required:!0}]}),(0,a.jsx)(st.A.Item,{label:"\u7236\u7AE0\u8282",name:"parent",labelCol:{span:4},initialValue:(c==null?void 0:c.parent)||"0-0",rules:[{required:!0}],children:(0,a.jsx)(ot.Z,{showSearch:!0,style:{width:330},treeNodeFilterProp:"title",treeData:Object.keys(B).length>0?B:[]})})]})},pt=ct,ht=function(e){var s,r,t,o=e==null||(s=e.location)===null||s===void 0?void 0:s.query,n=o.id,i=(0,m.useState)({}),M=(0,_.Z)(i,2),c=M[0],h=M[1],v=(0,m.useState)(!1),b=(0,_.Z)(v,2),f=b[0],C=b[1],y=(0,m.useState)(!1),B=(0,_.Z)(y,2),E=B[0],z=B[1],S=(0,m.useState)({}),P=(0,_.Z)(S,2),R=P[0],W=P[1],p=(0,m.useState)(!1),re=(0,_.Z)(p,2),I=re[0],ee=re[1],ge=(0,m.useState)([]),ce=(0,_.Z)(ge,2),pe=ce[0],be=ce[1],_e=(0,m.useState)({}),Le=(0,_.Z)(_e,2),he=Le[0],je=Le[1],Fe=(0,m.useState)((0,w.Z)((0,u.Z)().mark(function J(){var Y;return(0,u.Z)().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.next=2,(0,ut.Nk)({});case 2:Y=k.sent,Z(Y);case 4:case"end":return k.stop()}},J)}))),Te=(0,_.Z)(Fe,2),V=Te[0],Z=Te[1],xe=function(){var J=(0,w.Z)((0,u.Z)().mark(function Y(){var A,k;return(0,u.Z)().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return ee(!0),ie.next=3,T({id:n});case 3:A=ie.sent,k=(0,Se.rC)(A),je(k),be(A),ee(!1);case 8:case"end":return ie.stop()}},Y)}));return function(){return J.apply(this,arguments)}}();return(0,m.useEffect)((0,w.Z)((0,u.Z)().mark(function J(){var Y;return(0,u.Z)().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(!n){k.next=9;break}return k.next=3,xe();case 3:return ee(!0),k.next=6,(0,de.Cy)({id:n});case 6:Y=k.sent,h(Y),ee(!1);case 9:case"end":return k.stop()}},J)})),[n]),(0,a.jsxs)(fe._z,{title:!1,pageHeaderRender:!1,children:[(0,a.jsx)("div",{style:{width:f?40:260,position:"fixed",top:"68px",bottom:0,background:"#ffffff"},children:(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[(0,a.jsx)(ue.Z,{defaultActiveKey:"default",style:{flex:1,overflow:"scroll",margin:"0 8px"},tabBarExtraContent:{right:(0,a.jsx)("a",{onClick:function(){W({}),z(!0)},children:"\u6DFB\u52A0"})},children:(0,a.jsx)($e.Z,{tab:"\u76EE\u5F55",style:{color:"black"},children:I?(0,a.jsx)(De.Z,{spinning:!0,children:"\u76EE\u5F55\u52A0\u8F7D\u4E2D"}):Object.keys(pe).length>0?(0,a.jsx)(Ee.Z,{showLine:!0,defaultExpandAll:!0,onSelect:function(Y,A){var k,ne,ie;je({chapter_id:A==null||(k=A.node)===null||k===void 0?void 0:k.id,chapter_title:A==null||(ne=A.node)===null||ne===void 0?void 0:ne.title,parent:A==null||(ie=A.node)===null||ie===void 0?void 0:ie.parent})},defaultSelectedKeys:[he==null?void 0:he.chapter_id],draggable:{icon:!1},onDrop:function(){var J=(0,w.Z)((0,u.Z)().mark(function Y(A){var k,ne,ie,$;return(0,u.Z)().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(k=(0,Se.FC)(A),k!=null&&k.canDrag){g.next=8;break}if(!(k!=null&&k.errMsg)){g.next=7;break}return F.ZP.error(k==null?void 0:k.errMsg),g.abrupt("return");case 7:return g.abrupt("return");case 8:return ne=(0,Se.EF)(A,pe),ie=(0,Se.W8)(A,ne),ee(!0),g.next=13,Ma(ie);case 13:if($=g.sent,!($.length>0)){g.next=18;break}return F.ZP.success("\u4FEE\u6539\u6210\u529F"),g.next=18,xe();case 18:ee(!1);case 19:case"end":return g.stop()}},Y)}));return function(Y){return J.apply(this,arguments)}}(),treeData:pe}):"\u6682\u65E0\u6570\u636E"},"default")}),(0,a.jsx)("div",{style:{height:"39px",justifyContent:"center",alignItems:"center",display:"flex"},onClick:function(Y){C(!f)},children:f?(0,a.jsx)(H.Z,{title:"\u5C55\u5F00",placement:"right",children:(0,a.jsx)(ae.Z,{})}):(0,a.jsxs)("span",{children:[(0,a.jsx)(me.Z,{style:{marginRight:5}}),"\u6536\u8D77"]})})]})}),(0,a.jsx)("div",{style:{marginLeft:f?50:270},children:(he==null?void 0:he.chapter_id)&&(0,a.jsx)(lt,{picBookId:n,selectChapter:he,setSelectChapter:je,configData:c,layoutOriginData:V||[],refreshMenu:xe,layoutOptionsData:(0,Se.V1)(((r=Object.keys(V))===null||r===void 0?void 0:r.length)>0?V:[]),setLayoutOriginData:Z})}),E&&(0,a.jsx)(pt,{setShowMenuModal:z,showMenuModal:E,setEditMenu:W,editMenu:R,picBookId:n,layoutOriginData:V||[],layoutOptionsData:(0,Se.V1)(((t=Object.keys(V))===null||t===void 0?void 0:t.length)>0?V:[]),refreshMenu:xe})]})},vt=ht},25049:function(va,Oe,l){"use strict";l.d(Oe,{Nk:function(){return we},fc:function(){return We},Lk:function(){return Ve}});var Ze=l(39428),H=l(11849),se=l(3182),ue=l(78370);function we(_,m){return De.apply(this,arguments)}function De(){return De=(0,se.Z)((0,Ze.Z)().mark(function _(m,fe){return(0,Ze.Z)().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return ae.abrupt("return",(0,ue.Z)("/api/pic_book/layout/",(0,H.Z)({method:"GET",params:(0,H.Z)({},m)},fe||{})));case 1:case"end":return ae.stop()}},_)})),De.apply(this,arguments)}function We(_,m,fe){return Ee.apply(this,arguments)}function Ee(){return Ee=(0,se.Z)((0,Ze.Z)().mark(function _(m,fe,de){return(0,Ze.Z)().wrap(function(me){for(;;)switch(me.prev=me.next){case 0:return me.abrupt("return",(0,ue.Z)("/api/pic_book/layout/".concat(m,"/"),(0,H.Z)({method:"PATCH",data:fe},de||{})));case 1:case"end":return me.stop()}},_)})),Ee.apply(this,arguments)}function Ve(_,m){return F.apply(this,arguments)}function F(){return F=(0,se.Z)((0,Ze.Z)().mark(function _(m,fe){return(0,Ze.Z)().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return ae.abrupt("return",(0,ue.Z)("/api/pic_book/layout/",(0,H.Z)({method:"POST",data:m},fe||{})));case 1:case"end":return ae.stop()}},_)})),F.apply(this,arguments)}function u(_,m){return w.apply(this,arguments)}function w(){return w=_asyncToGenerator(_regeneratorRuntime().mark(function _(m,fe){var de,ae;return _regeneratorRuntime().wrap(function($e){for(;;)switch($e.prev=$e.next){case 0:return de=m.id,ae=de===void 0?0:de,$e.abrupt("return",request("/api/pic_book/layout/".concat(ae),_objectSpread({method:"DELETE"},fe||{})));case 2:case"end":return $e.stop()}},_)})),w.apply(this,arguments)}},61870:function(va,Oe,l){"use strict";l.d(Oe,{lQ:function(){return Ve},Cy:function(){return u},e:function(){return _},zk:function(){return fe},Zz:function(){return ae},Y6:function(){return Ce},Dh:function(){return He}});var Ze=l(93224),H=l(39428),se=l(11849),ue=l(3182),we=l(78370),De=["id"],We=["id"],Ee=null;function Ve(j,D){return F.apply(this,arguments)}function F(){return F=(0,ue.Z)((0,H.Z)().mark(function j(D,N){return(0,H.Z)().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.abrupt("return",(0,we.Z)("/api/pic_book/book/",(0,se.Z)({method:"GET",data:(0,se.Z)({},D)},N||{})));case 1:case"end":return T.stop()}},j)})),F.apply(this,arguments)}function u(j,D){return w.apply(this,arguments)}function w(){return w=(0,ue.Z)((0,H.Z)().mark(function j(D,N){var x,T,te;return(0,H.Z)().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return x=D.id,T=x===void 0?0:x,te=(0,Ze.Z)(D,De),Q.abrupt("return",(0,we.Z)("/api/pic_book/book/".concat(T,"/"),(0,se.Z)({method:"GET"},N||{})));case 2:case"end":return Q.stop()}},j)})),w.apply(this,arguments)}function _(j,D){return m.apply(this,arguments)}function m(){return m=(0,ue.Z)((0,H.Z)().mark(function j(D,N){var x,T,te;return(0,H.Z)().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return x=D.id,T=x===void 0?0:x,te=(0,Ze.Z)(D,We),Q.abrupt("return",(0,we.Z)("/api/pic_book/book/".concat(T,"/preview/"),(0,se.Z)({method:"GET"},N||{})));case 2:case"end":return Q.stop()}},j)})),m.apply(this,arguments)}function fe(j,D,N){return de.apply(this,arguments)}function de(){return de=(0,ue.Z)((0,H.Z)().mark(function j(D,N,x){return(0,H.Z)().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return te.abrupt("return",(0,we.Z)("/api/pic_book/book/".concat(D,"/"),(0,se.Z)({method:"PATCH",data:N},x||{})));case 1:case"end":return te.stop()}},j)})),de.apply(this,arguments)}function ae(j,D){return me.apply(this,arguments)}function me(){return me=(0,ue.Z)((0,H.Z)().mark(function j(D,N){return(0,H.Z)().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.abrupt("return",(0,we.Z)("/api/pic_book/book/",(0,se.Z)({method:"POST",data:D},N||{})));case 1:case"end":return T.stop()}},j)})),me.apply(this,arguments)}function $e(j,D){return K.apply(this,arguments)}function K(){return K=_asyncToGenerator(_regeneratorRuntime().mark(function j(D,N){var x,T;return _regeneratorRuntime().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return x=D.id,T=x===void 0?0:x,oe.abrupt("return",request("/api/pic_book/book/".concat(T),_objectSpread({method:"DELETE"},N||{})));case 2:case"end":return oe.stop()}},j)})),K.apply(this,arguments)}function Ce(j){return q.apply(this,arguments)}function q(){return q=(0,ue.Z)((0,H.Z)().mark(function j(D){return(0,H.Z)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.abrupt("return",(0,we.Z)("/api/pic_book/voice_template/",(0,se.Z)({method:"GET"},D||{})));case 1:case"end":return x.stop()}},j)})),q.apply(this,arguments)}function He(j){return Ie.apply(this,arguments)}function Ie(){return Ie=(0,ue.Z)((0,H.Z)().mark(function j(D){return(0,H.Z)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.abrupt("return",(0,we.Z)("/api/pic_book/author/",(0,se.Z)({method:"GET"},D||{})));case 1:case"end":return x.stop()}},j)})),Ie.apply(this,arguments)}function fa(j,D){return Ae.apply(this,arguments)}function Ae(){return Ae=_asyncToGenerator(_regeneratorRuntime().mark(function j(D,N){var x,T,te;return _regeneratorRuntime().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return x=D.id,T=x===void 0?0:x,te=_objectWithoutProperties(D,Ee),Q.abrupt("return",request("/api/pic_book/chapter/".concat(T,"/"),_objectSpread({method:"PATCH",data:te},N||{})));case 2:case"end":return Q.stop()}},j)})),Ae.apply(this,arguments)}function ma(j,D){return Ge.apply(this,arguments)}function Ge(){return Ge=_asyncToGenerator(_regeneratorRuntime().mark(function j(D,N){return _regeneratorRuntime().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.abrupt("return",request("/api/pic_book/chapter/",_objectSpread({method:"POST",data:_objectSpread({},D)},N||{})));case 1:case"end":return T.stop()}},j)})),Ge.apply(this,arguments)}function ga(j,D){return Ue.apply(this,arguments)}function Ue(){return Ue=_asyncToGenerator(_regeneratorRuntime().mark(function j(D,N){var x,T;return _regeneratorRuntime().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return x=D.id,T=x===void 0?0:x,oe.abrupt("return",request("/api/pic_book/chapter/".concat(T,"/"),_objectSpread({method:"DELETE"},N||{})).catch(function(Q){return{}}));case 2:case"end":return oe.stop()}},j)})),Ue.apply(this,arguments)}}}]);
