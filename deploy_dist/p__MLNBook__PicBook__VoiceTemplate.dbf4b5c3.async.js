(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[730],{37172:function(le,W,n){"use strict";n.r(W),n.d(W,{default:function(){return l}});var h=n(18106),g=n(63885),ee=n(57663),b=n(71577),w=n(62350),U=n(24565),ae=n(34792),E=n(48086),z=n(71153),T=n(60331),v=n(39428),V=n(3182),$=n(2824),H=n(45195),x=n(51042),N=n(43471),D=n(67294),ne=n(17294),R=n(24967),C=n(87766),O=n(37476),Y=n(64317),A=n(61870),o=n(85893),I=function(e){var d=e.setShowModal,_=e.showModal,p=e.updateVoiceListFunc,Q=e.picBookId;return(0,o.jsx)(O.Y,{title:"\u6DFB\u52A0\u7ED8\u672C\u8BED\u97F3\u6A21\u677F",width:"750px",layout:"horizontal",visible:_,onVisibleChange:d,onFinish:function(){var k=(0,V.Z)((0,v.Z)().mark(function j(B){var G,m;return(0,v.Z)().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return G={pic_book:Q,voice_template:B.voice_template},y.next=3,(0,C.tN)(G);case 3:if(m=y.sent,!(m!=null&&m.id)){y.next=10;break}return d(!1),y.next=8,p();case 8:y.next=11;break;case 10:E.ZP.error("\u6DFB\u52A0\u5931\u8D25");case 11:case"end":return y.stop()}},j)}));return function(j){return k.apply(this,arguments)}}(),children:(0,o.jsx)(Y.Z,{label:"\u58F0\u97F3\u6A21\u677F",rules:[{required:!0}],name:"voice_template",mode:"single",placeholder:"\u9009\u62E9\u58F0\u97F3\u6A21\u677F",request:(0,V.Z)((0,v.Z)().mark(function k(){var j,B;return(0,v.Z)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,(0,A.Y6)();case 2:return j=m.sent,B=j==null?void 0:j.map(function(S){return{label:"".concat(S.title,"(").concat(S.language,"\xB7").concat(S.tts_model,")"),value:S.id}}),m.abrupt("return",B);case 5:case"end":return m.stop()}},k)}))})})},r=I,t=function(e){var d,_,p,Q=e==null||(d=e.location)===null||d===void 0?void 0:d.query,k=Q.id,j=(0,D.useState)(!1),B=(0,$.Z)(j,2),G=B[0],m=B[1],S=(0,D.useState)({}),y=(0,$.Z)(S,2),u=y[0],se=y[1],ce=(0,D.useState)(!1),te=(0,$.Z)(ce,2),re=te[0],ie=te[1],de=(0,D.useState)(""),oe=(0,$.Z)(de,2),M=oe[0],ue=oe[1];(0,D.useEffect)((0,V.Z)((0,v.Z)().mark(function Z(){return(0,v.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!k){i.next=3;break}return i.next=3,X();case 3:case"end":return i.stop()}},Z)})),[k]);var X=function(){var Z=(0,V.Z)((0,v.Z)().mark(function f(){var i,a,c,K;return(0,v.Z)().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return m(!0),F.next=3,(0,C.aL)({id:k});case 3:a=F.sent,a.voice_map=a==null||(i=a.voice_files)===null||i===void 0?void 0:i.reduce(function(J,P){var q="".concat(P==null?void 0:P.voice_template,"_").concat(P==null?void 0:P.para_content_uniq);return J[q]=P,J},{}),se(a),(a==null?void 0:a.book_voice_relation.length)>0&&ue(a==null||(c=a.book_voice_relation[0])===null||c===void 0||(K=c.voice_template)===null||K===void 0?void 0:K.id),m(a);case 8:case"end":return F.stop()}},f)}));return function(){return Z.apply(this,arguments)}}(),ve=[{title:"ID",dataIndex:"id"},{title:"\u77E5\u8BC6\u70B9",dataIndex:"knowledge"},{title:"\u6BB5\u843D\u5185\u5BB9",dataIndex:"para_content",valueType:"textarea"},{title:"\u8BED\u97F3\u72B6\u6001",dataIndex:"_",render:function(f,i){var a,c="".concat(M,"_").concat(i==null?void 0:i.para_content_uniq);return u!=null&&(a=u.voice_map)!==null&&a!==void 0&&a[c]?(u==null?void 0:u.voice_map[c].job_state)==0?(0,o.jsx)(T.Z,{color:"processing",children:"\u751F\u6210\u4E2D"}):(0,o.jsx)(T.Z,{color:"success",children:"\u5DF2\u751F\u6210"}):(0,o.jsx)(T.Z,{color:"default",children:"\u5F85\u751F\u6210"})}},{title:"\u64CD\u4F5C",dataIndex:"option",valueType:"option",render:function(f,i){var a,c;return[(0,o.jsx)(U.Z,{title:"\u786E\u8BA4\u91CD\u65B0\u751F\u6210\u8BED\u97F3\u5417\uFF1F",onConfirm:function(){try{var L={pic_book:k,voice_template:M,para_content_uniq:i==null?void 0:i.para_content_uniq};(0,C.R$)(L),E.ZP.success("\u64CD\u4F5C\u6210\u529F\uFF0C\u8BF7\u7A0D\u540E\u5237\u65B0\u9875\u9762\u67E5\u770B\u72B6\u6001")}catch(F){E.ZP.error("\u64CD\u4F5C\u5931\u8D25")}},children:(0,o.jsx)("a",{children:"\u91CD\u65B0\u751F\u6210"})},"1"),(0,o.jsxs)("a",{hidden:!(u!=null&&(a=u.voice_map)!==null&&a!==void 0&&(c=a["".concat(M,"_").concat(i==null?void 0:i.para_content_uniq)])!==null&&c!==void 0&&c.voice_file),onClick:function(){var L,F,J=u==null||(L=u.voice_map)===null||L===void 0||(F=L["".concat(M,"_").concat(i==null?void 0:i.para_content_uniq)])===null||F===void 0?void 0:F.voice_file,P=new Audio(J);P.play().catch(function(q){console.error("\u97F3\u9891\u64AD\u653E\u5931\u8D25:",q)})},children:[(0,o.jsx)(H.Z,{style:{marginRight:"2px",fontSize:"16px",color:"blue"}})," \u8BD5\u542C"]})]}}];return(0,o.jsxs)(ne.ZP,{title:!1,pageHeaderRender:!1,loading:G,children:[(0,o.jsx)(g.Z,{tabBarExtraContent:(0,o.jsxs)(b.Z,{type:"primary",onClick:function(){ie(!0)},children:[(0,o.jsx)(x.Z,{}),"\u5173\u8054\u65B0\u8BED\u97F3\u6A21\u677F"]}),defaultActiveKey:M,items:u==null||(_=u.book_voice_relation)===null||_===void 0?void 0:_.map(function(Z,f){var i=String(f+1),a=Z==null?void 0:Z.voice_template;return{label:"".concat(a==null?void 0:a.title,"(").concat(a==null?void 0:a.language,"\xB7").concat(a==null?void 0:a.tts_model,")"),key:a==null?void 0:a.id}}),onChange:function(f){ue(f)}}),(u==null||(p=u.book_voice_relation)===null||p===void 0?void 0:p.length)>0?(0,o.jsx)(R.ZP,{headerTitle:"\u6BB5\u843D\u5217\u8868",rowKey:"key",size:"small",search:!1,options:{density:!1,reload:!1,setting:!1},toolBarRender:function(){return[(0,o.jsx)(b.Z,{type:"dashed",style:{color:"red"},children:(0,o.jsxs)(U.Z,{title:"\u6279\u91CF\u751F\u6210\u6A21\u677F\u6240\u6709\u8BED\u97F3\u5417",onConfirm:(0,V.Z)((0,v.Z)().mark(function f(){var i;return(0,v.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,i={pic_book:k,voice_template:M},c.next=4,(0,C.VJ)(i);case 4:E.ZP.success("\u64CD\u4F5C\u6210\u529F\uFF0C\u7A0D\u540E\u5237\u65B0\u5217\u8868\u67E5\u770B\u72B6\u6001."),c.next=10;break;case 7:c.prev=7,c.t0=c.catch(0),E.ZP.error("\u64CD\u4F5C\u5931\u8D25");case 10:case"end":return c.stop()}},f,null,[[0,7]])})),children:[(0,o.jsx)(H.Z,{})," \u6279\u91CF\u751F\u6210"]},"delete")},"primary"),(0,o.jsxs)(b.Z,{onClick:(0,V.Z)((0,v.Z)().mark(function f(){return(0,v.Z)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,X();case 2:case"end":return a.stop()}},f)})),children:[(0,o.jsx)(N.Z,{})," \u5237\u65B0"]})]},dataSource:(u==null?void 0:u.paragraph)||[],columns:ve||[]}):(0,o.jsx)("span",{children:"\u6682\u65E0\u5173\u8054\u8BED\u97F3\u6A21\u677F\uFF0C\u8BF7\u5148\u521B\u5EFA"}),re&&(0,o.jsx)(r,{setShowModal:ie,showModal:re,updateVoiceListFunc:X,picBookId:k})]})},l=t},87766:function(le,W,n){"use strict";n.d(W,{aL:function(){return E},tN:function(){return T},VJ:function(){return V},R$:function(){return H},BT:function(){return N},aU:function(){return C},y0:function(){return Y}});var h=n(39428),g=n(11849),ee=n(93224),b=n(3182),w=n(78370),U=["id"],ae=null;function E(r,t){return z.apply(this,arguments)}function z(){return z=(0,b.Z)((0,h.Z)().mark(function r(t,l){var s,e,d;return(0,h.Z)().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return s=t.id,e=s===void 0?0:s,d=(0,ee.Z)(t,U),p.abrupt("return",(0,w.Z)("/api/pic_book/book/".concat(e,"/voice_list/"),(0,g.Z)({method:"GET",params:(0,g.Z)({},d)},l||{})));case 2:case"end":return p.stop()}},r)})),z.apply(this,arguments)}function T(r,t){return v.apply(this,arguments)}function v(){return v=(0,b.Z)((0,h.Z)().mark(function r(t,l){return(0,h.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,w.Z)("/api/pic_book/book_voice/",(0,g.Z)({method:"POST",data:t},l||{})));case 1:case"end":return e.stop()}},r)})),v.apply(this,arguments)}function V(r,t){return $.apply(this,arguments)}function $(){return $=(0,b.Z)((0,h.Z)().mark(function r(t,l){return(0,h.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,w.Z)("/api/pic_book/book_voice/bulk_gen_voice_files/",(0,g.Z)({method:"POST",data:t},l||{})));case 1:case"end":return e.stop()}},r)})),$.apply(this,arguments)}function H(r,t){return x.apply(this,arguments)}function x(){return x=(0,b.Z)((0,h.Z)().mark(function r(t,l){return(0,h.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,w.Z)("/api/pic_book/book_voice/paragraph_voice_file/",(0,g.Z)({method:"POST",data:t},l||{})));case 1:case"end":return e.stop()}},r)})),x.apply(this,arguments)}function N(r,t){return D.apply(this,arguments)}function D(){return D=(0,b.Z)((0,h.Z)().mark(function r(t,l){return(0,h.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,w.Z)("/api/pic_book/paragraph_voice/",(0,g.Z)({method:"GET",params:(0,g.Z)({},t)},l||{})));case 1:case"end":return e.stop()}},r)})),D.apply(this,arguments)}function ne(r,t){return R.apply(this,arguments)}function R(){return R=_asyncToGenerator(_regeneratorRuntime().mark(function r(t,l){var s,e,d;return _regeneratorRuntime().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return s=t.id,e=s===void 0?0:s,d=_objectWithoutProperties(t,ae),p.abrupt("return",request("/api/pic_book/paragraph_voice/".concat(e,"/"),_objectSpread({method:"GET",params:_objectSpread({},d)},l||{})));case 2:case"end":return p.stop()}},r)})),R.apply(this,arguments)}function C(r,t){return O.apply(this,arguments)}function O(){return O=(0,b.Z)((0,h.Z)().mark(function r(t,l){return(0,h.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,w.Z)("/api/pic_book/paragraph_voice/",(0,g.Z)({method:"POST",data:t},l||{})));case 1:case"end":return e.stop()}},r)})),O.apply(this,arguments)}function Y(r,t,l){return A.apply(this,arguments)}function A(){return A=(0,b.Z)((0,h.Z)().mark(function r(t,l,s){return(0,h.Z)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,w.Z)("/api/pic_book/paragraph_voice/".concat(t,"/"),(0,g.Z)({method:"PATCH",data:l},s||{})));case 1:case"end":return d.stop()}},r)})),A.apply(this,arguments)}function o(r,t){return I.apply(this,arguments)}function I(){return I=_asyncToGenerator(_regeneratorRuntime().mark(function r(t,l){var s,e;return _regeneratorRuntime().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return s=t.id,e=s===void 0?0:s,_.abrupt("return",request("/api/pic_book/paragraph_voice/".concat(e,"/"),_objectSpread({method:"DELETE"},l||{})).catch(function(p){return{}}));case 2:case"end":return _.stop()}},r)})),I.apply(this,arguments)}}}]);
