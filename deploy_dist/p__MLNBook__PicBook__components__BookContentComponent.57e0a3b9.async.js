(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[217],{88032:function(Ie,ge,r){"use strict";var F=r(39428),L=r(3182),ue=r(67294),N=r(37476),W=r(5966),ae=r(90672),ye=r(64317),re=r(24739),ve=r(25049),he=r(94544),Ee=r(15643),S=r(85893),X=function(d){var l=d.record,a=d.setShowModal,i=d.showModal,o=d.actionRef,v=d.updatePageDetailsFunc;l!=null&&l.background_img&&(l.background_img=[{url:l==null?void 0:l.background_img}]);var M=l.id?l:{c_type:"protected",grid_row_col:"[[24]]",grid_gutter:"[16, 24]",font_color:"#0000E0",font_family:"Arial",font_size:14,background_color:"#FFFFFF",text_flex_justify:"flex-end",text_flex_align:"flex-end",text_opacity:1};return(0,S.jsxs)(N.Y,{title:l!=null&&l.id?"\u7F16\u8F91\u9875\u9762\u6A21\u677F:".concat(l==null?void 0:l.id):"\u65B0\u5EFA\u9875\u9762\u6A21\u677F",width:"750px",layout:"horizontal",visible:i,initialValues:M,onVisibleChange:a,onFinish:function(){var R=(0,L.Z)((0,F.Z)().mark(function I(Ze){var V,b;return(0,F.Z)().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(V=new FormData,Object.keys(Ze).forEach(function(j){j==="background_img"?Ze[j][0].originFileObj&&V.append(j,Ze[j][0].originFileObj):V.append(j,Ze[j])}),!(l!=null&&l.id)){y.next=9;break}return V.append("id",l==null?void 0:l.id),y.next=6,(0,ve.fc)(l==null?void 0:l.id,V);case 6:b=y.sent,y.next=12;break;case 9:return y.next=11,(0,ve.Lk)(V);case 11:b=y.sent;case 12:if(!b){y.next=20;break}if(a(!1),!v){y.next=19;break}return y.next=17,v();case 17:y.next=20;break;case 19:o.current&&o.current.reload();case 20:case"end":return y.stop()}},I)}));return function(I){return R.apply(this,arguments)}}(),children:[(0,S.jsx)(W.Z,{rules:[{required:!0}],label:"\u6807\u9898",name:"title"}),(0,S.jsx)(ae.Z,{rules:[{required:!0}],label:"\u63CF\u8FF0",name:"description"}),(0,S.jsx)(ye.Z,{rules:[{required:!0}],label:"\u7C7B\u578B",name:"c_type",options:[{label:"\u5B8C\u5168\u516C\u5F00",value:"public"},{label:"\u5185\u90E8\u4F7F\u7528",value:"protected"},{label:"\u79C1\u6709",value:"private"}]}),(0,S.jsxs)(re.UW,{children:[(0,S.jsx)(W.Z,{rules:[{required:!0}],label:"\u6805\u683C\u5E03\u5C40",name:"grid_row_col"}),(0,S.jsx)(W.Z,{rules:[{required:!0}],label:"\u6805\u683C\u95F4\u8DDD",name:"grid_gutter"})]}),(0,S.jsxs)(re.UW,{children:[(0,S.jsx)(he.Z,{label:"\u5B57\u4F53\u989C\u8272",rules:[{required:!0}],name:"font_color"}),(0,S.jsx)(W.Z,{rules:[{required:!0}],label:"\u5B57\u4F53",width:150,name:"font_family"}),(0,S.jsx)(W.Z,{rules:[{required:!0}],label:"\u5B57\u4F53\u5927\u5C0F",width:125,name:"font_size"})]}),(0,S.jsxs)(re.UW,{children:[(0,S.jsx)(Ee.Z,{name:"background_img",label:"\u80CC\u666F\u56FE",max:1,fieldProps:{data:{},defaultFileList:[],multiple:!1,listType:"picture-card",accept:".png,.jpg,.jpeg",maxCount:1},extra:"\u652F\u6301 JPG\u3001PNG \u683C\u5F0F"}),(0,S.jsx)(he.Z,{label:"\u80CC\u666F\u989C\u8272",rules:[{required:!0}],name:"background_color"})]}),(0,S.jsxs)(re.UW,{children:[(0,S.jsx)(ye.Z,{rules:[{required:!0}],label:"\u6587\u672C\u4E3B\u8F74\u4F4D\u7F6E",name:"text_flex_justify",fieldProps:{dropdownMatchSelectWidth:!1},options:[{label:"flex-start",value:"flex-start"},{label:"center",value:"center"},{label:"flex-end",value:"flex-end"},{label:"space-between",value:"space-between"},{label:"space-around",value:"space-around"},{label:"space-evenly",value:"space-evenly"}]}),(0,S.jsx)(ye.Z,{rules:[{required:!0}],label:"\u6587\u672C\u4EA4\u53C9\u8F74\u4F4D\u7F6E",name:"text_flex_align",fieldProps:{dropdownMatchSelectWidth:!1},options:[{label:"flex-start",value:"flex-start"},{label:"center",value:"center"},{label:"flex-end",value:"flex-end"}]}),(0,S.jsx)(W.Z,{rules:[{required:!0}],label:"\u6587\u672C\u900F\u660E\u5EA6",name:"text_opacity",width:80})]})]})};ge.Z=X},83924:function(Ie,ge,r){"use strict";r.r(ge),r.d(ge,{default:function(){return kr}});var F=r(22385),L=r(45777),ue=r(18106),N=r(63885),W=r(20228),ae=r(11382),ye=r(32157),re=r(3974),ve=r(59250),he=r(13013),Ee=r(62350),S=r(24565),X=r(30887),B=r(18515),d=r(34792),l=r(48086),a=r(39428),i=r(3182),o=r(2824),v=r(67294),M=r(87720),R=r(61870),I=r(8212),Ze=r(1351),V=r(76629),b=r(42698),h=r(11849),y=r(93224),j=r(78370),x=["id"],je=["id"],Te=["id"],Ce=["id"],Ra=["id"],Ia=["id"],Aa=null,Ua=null,Wa=["id"];function Va(p,n){return ea.apply(this,arguments)}function ea(){return ea=(0,i.Z)((0,a.Z)().mark(function p(n,f){var s,t,u;return(0,a.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return s=n.id,t=s===void 0?0:s,u=(0,y.Z)(n,x),c.abrupt("return",(0,j.Z)("/api/pic_book/book/".concat(t,"/chapter_page_menu/"),(0,h.Z)({method:"GET"},f||{})));case 2:case"end":return c.stop()}},p)})),ea.apply(this,arguments)}function Ka(p,n){return aa.apply(this,arguments)}function aa(){return aa=(0,i.Z)((0,a.Z)().mark(function p(n,f){var s,t,u;return(0,a.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return s=n.id,t=s===void 0?0:s,u=(0,y.Z)(n,je),c.abrupt("return",(0,j.Z)("/api/pic_book/book/".concat(t,"/chapter_menu/"),(0,h.Z)({method:"GET"},f||{})));case 2:case"end":return c.stop()}},p)})),aa.apply(this,arguments)}function Ga(p,n){return ra.apply(this,arguments)}function ra(){return ra=(0,i.Z)((0,a.Z)().mark(function p(n,f){return(0,a.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,j.Z)("/api/pic_book/chapter/",(0,h.Z)({method:"POST",data:(0,h.Z)({},n)},f||{})));case 1:case"end":return t.stop()}},p)})),ra.apply(this,arguments)}function za(p,n){return ta.apply(this,arguments)}function ta(){return ta=(0,i.Z)((0,a.Z)().mark(function p(n,f){var s,t,u;return(0,a.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return s=n.id,t=s===void 0?0:s,u=(0,y.Z)(n,Te),c.abrupt("return",(0,j.Z)("/api/pic_book/chapter/".concat(t,"/"),(0,h.Z)({method:"GET",params:u},f||{})));case 2:case"end":return c.stop()}},p)})),ta.apply(this,arguments)}function ba(p,n){return na.apply(this,arguments)}function na(){return na=(0,i.Z)((0,a.Z)().mark(function p(n,f){var s,t,u;return(0,a.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return s=n.id,t=s===void 0?0:s,u=(0,y.Z)(n,Ce),c.abrupt("return",(0,j.Z)("/api/pic_book/chapter/".concat(t,"/"),(0,h.Z)({method:"PATCH",data:u},f||{})));case 2:case"end":return c.stop()}},p)})),na.apply(this,arguments)}function Na(p,n){return la.apply(this,arguments)}function la(){return la=(0,i.Z)((0,a.Z)().mark(function p(n,f){var s,t;return(0,a.Z)().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return s=n.id,t=s===void 0?0:s,P.abrupt("return",(0,j.Z)("/api/pic_book/chapter/".concat(t,"/"),(0,h.Z)({method:"DELETE"},f||{})).catch(function(c){return{}}));case 2:case"end":return P.stop()}},p)})),la.apply(this,arguments)}function Ha(p,n){return ua.apply(this,arguments)}function ua(){return ua=(0,i.Z)((0,a.Z)().mark(function p(n,f){var s,t,u;return(0,a.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return s=n.id,t=s===void 0?0:s,u=(0,y.Z)(n,Ra),c.abrupt("return",(0,j.Z)("/api/pic_book/book_page/".concat(t,"/"),(0,h.Z)({method:"GET",params:u},f||{})));case 2:case"end":return c.stop()}},p)})),ua.apply(this,arguments)}function Ja(p,n){return ia.apply(this,arguments)}function ia(){return ia=(0,i.Z)((0,a.Z)().mark(function p(n,f){var s,t,u;return(0,a.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return s=n.id,t=s===void 0?0:s,u=(0,y.Z)(n,Ia),c.abrupt("return",(0,j.Z)("/api/pic_book/book_page/".concat(t,"/chapter_paragraph/"),(0,h.Z)({method:"GET",params:u},f||{})));case 2:case"end":return c.stop()}},p)})),ia.apply(this,arguments)}function $r(p,n){return oa.apply(this,arguments)}function oa(){return oa=_asyncToGenerator(_regeneratorRuntime().mark(function p(n,f){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/api/pic_book/book_page/",_objectSpread({method:"POST",data:_objectSpread({},n)},f||{})));case 1:case"end":return t.stop()}},p)})),oa.apply(this,arguments)}function Ya(p,n){return sa.apply(this,arguments)}function sa(){return sa=(0,i.Z)((0,a.Z)().mark(function p(n,f){var s,t;return(0,a.Z)().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return s=n.id,t=s===void 0?0:s,P.abrupt("return",(0,j.Z)("/api/pic_book/book_page/".concat(t,"/"),(0,h.Z)({method:"DELETE"},f||{})).catch(function(c){return{}}));case 2:case"end":return P.stop()}},p)})),sa.apply(this,arguments)}function Lr(p,n){return da.apply(this,arguments)}function da(){return da=_asyncToGenerator(_regeneratorRuntime().mark(function p(n,f){var s,t,u;return _regeneratorRuntime().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return s=n.id,t=s===void 0?0:s,u=_objectWithoutProperties(n,Aa),c.abrupt("return",request("/api/pic_book/book_page/".concat(t,"/"),_objectSpread({method:"PATCH",data:u},f||{})));case 2:case"end":return c.stop()}},p)})),da.apply(this,arguments)}function Rr(p,n){return ca.apply(this,arguments)}function ca(){return ca=_asyncToGenerator(_regeneratorRuntime().mark(function p(n,f){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/api/pic_book/paragraph/",_objectSpread({method:"GET",params:_objectSpread({},n)},f||{})));case 1:case"end":return t.stop()}},p)})),ca.apply(this,arguments)}function Ir(p,n){return pa.apply(this,arguments)}function pa(){return pa=_asyncToGenerator(_regeneratorRuntime().mark(function p(n,f){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/api/pic_book/paragraph/",_objectSpread({method:"POST",data:_objectSpread({},n)},f||{})));case 1:case"end":return t.stop()}},p)})),pa.apply(this,arguments)}function Ar(p,n){return va.apply(this,arguments)}function va(){return va=_asyncToGenerator(_regeneratorRuntime().mark(function p(n,f){var s,t,u;return _regeneratorRuntime().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return s=n.id,t=s===void 0?0:s,u=_objectWithoutProperties(n,Ua),c.abrupt("return",request("/api/pic_book/paragraph/".concat(t,"/"),_objectSpread({method:"PATCH",data:u},f||{})));case 2:case"end":return c.stop()}},p)})),va.apply(this,arguments)}function Ur(p,n){return ha.apply(this,arguments)}function ha(){return ha=_asyncToGenerator(_regeneratorRuntime().mark(function p(n,f){var s,t;return _regeneratorRuntime().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return s=n.id,t=s===void 0?0:s,P.abrupt("return",request("/api/pic_book/paragraph/".concat(t,"/"),_objectSpread({method:"DELETE"},f||{})).catch(function(c){return{}}));case 2:case"end":return P.stop()}},p)})),ha.apply(this,arguments)}function Qa(p,n){return fa.apply(this,arguments)}function fa(){return fa=(0,i.Z)((0,a.Z)().mark(function p(n,f){var s,t,u;return(0,a.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return s=n.id,t=s===void 0?0:s,u=(0,y.Z)(n,Wa),c.abrupt("return",(0,j.Z)("/api/pic_book/paragraph/set_seq/",(0,h.Z)({method:"POST",data:u},f||{})));case 2:case"end":return c.stop()}},p)})),fa.apply(this,arguments)}function Xa(p,n){return ma.apply(this,arguments)}function ma(){return ma=(0,i.Z)((0,a.Z)().mark(function p(n,f){return(0,a.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,j.Z)("/api/pic_book/book/sort_menu/",(0,h.Z)({method:"POST",data:(0,h.Z)({},n)},f||{})));case 1:case"end":return t.stop()}},p)})),ma.apply(this,arguments)}var Wr=r(13062),xa=r(71230),Vr=r(89032),_a=r(15746),Kr=r(49111),Ge=r(19650),qa=r(32059),Gr=r(12968),wa=r(20352),be=r(952),er=r(60451),ga=r(24739),ze=r(27510),ar=r(5314),Pa=r(86028),We=r(27408),rr=r(92305),tr=r(42762),e=r(85893),nr=function(n){var f=(0,v.useRef)(),s=n.showModal,t=n.setShowModal,u=n.page_id,P=n.chapterParaData,c=n.updateChapterParaDataFunc,se=[{title:"\u6392\u5E8F",dataIndex:"seq",render:function(A,te,ie){return(0,e.jsxs)("span",{className:"customRender",children:[" ",te==null?void 0:te.seq]})}},{title:"ID",dataIndex:"id"},{title:"\u5185\u5BB9",dataIndex:"para_content"},{title:"\u77E5\u8BC6\u70B9",dataIndex:"knowledge"}],fe=function(){var K=(0,i.Z)((0,a.Z)().mark(function A(te,ie,k){var q;return(0,a.Z)().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return q=k==null?void 0:k.map(function(de,H){return de==null?void 0:de.id}),w.next=3,Qa({seq_list:q});case 3:return w.next=5,c();case 5:case"end":return w.stop()}},A)}));return function(te,ie,k){return K.apply(this,arguments)}}(),_=function(A,te){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(tr.Z,{style:{cursor:"grab",color:"gold"}})})};return(0,e.jsx)(We.Y,{title:"\u8C03\u6574\u6BB5\u843D\u5185\u5BB9\u987A\u5E8F",width:"600px",layout:"horizontal",visible:s,onVisibleChange:t,onFinish:function(){var K=(0,i.Z)((0,a.Z)().mark(function A(te){return(0,a.Z)().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:t(!1);case 1:case"end":return k.stop()}},A)}));return function(A){return K.apply(this,arguments)}}(),modalProps:{closable:!1},submitter:{render:function(A,te){return(0,e.jsxs)("div",{children:[te[1]," "]})}},children:(0,e.jsx)(rr.Z,{actionRef:f,columns:se,rowKey:"id",size:"small",search:!1,options:{density:!1},toolBarRender:!1,pagination:!1,dataSource:P==null?void 0:P.paragraph,dragSortKey:"seq",onDragSortEnd:fe,dragSortHandlerRender:_})})},lr=nr,ur=r(82061),ja=r(47745),ir=function(n){var f=n.showModal,s=n.setShowModal,t=n.chapterData,u=n.updateChapterParaDataFunc;return(0,e.jsx)(We.Y,{title:"\u7F16\u8F91\u7AE0\u8282\u6A21\u677F",width:"500px",layout:"horizontal",visible:f,onVisibleChange:s,initialValues:t,onFinish:function(){var P=(0,i.Z)((0,a.Z)().mark(function c(se){var fe,_;return(0,a.Z)().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return fe={id:t==null?void 0:t.id,text_template:se==null?void 0:se.text_template},A.next=3,ba(fe);case 3:if(_=A.sent,!_){A.next=8;break}return l.ZP.success("\u66F4\u65B0\u7AE0\u8282\u6A21\u677F\u6210\u529F"),A.next=8,u();case 8:s(!1);case 9:case"end":return A.stop()}},c)}));return function(c){return P.apply(this,arguments)}}(),children:(0,e.jsx)(ja.Z,{name:"text_template",label:"\u6A21\u677F"})})},or=ir,Ne=r(87766),sr=function(n){var f,s=(0,v.useRef)(null),t=n.chapterParaData,u=n.page_layout,P=(0,v.useState)(!1),c=(0,o.Z)(P,2),se=c[0],fe=c[1],_=(0,v.useState)({}),K=(0,o.Z)(_,2),A=K[0],te=K[1];return(0,v.useEffect)(function(){var ie=function(){var k=(0,i.Z)((0,a.Z)().mark(function q(){var G,w,de,H;return(0,a.Z)().wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:return fe(!0),w={pic_book:t==null||(G=t.paragraph)===null||G===void 0?void 0:G.pic_book},xe.next=4,(0,Ne.BT)(w);case 4:de=xe.sent,H=de.reduce(function(D,$){return D[$.para_content_uniq]=$==null?void 0:$.voice_file,D},{}),te(H),fe(!1);case 8:case"end":return xe.stop()}},q)}));return function(){return k.apply(this,arguments)}}();ie()},[t==null?void 0:t.id]),!se&&(0,e.jsx)("div",{style:{width:"414px",height:"896px",border:"1px dashed gray",backgroundImage:"url(".concat(u==null?void 0:u.background_img,")"),backgroundColor:u==null?void 0:u.background_color},children:(0,e.jsx)(xa.Z,{gutter:u==null?void 0:u.grid_gutter,align:"stretch",style:{height:"100%"},children:(f=JSON.parse(u==null?void 0:u.grid_row_col))===null||f===void 0?void 0:f.map(function(ie,k){var q,G=(t==null||(q=t.paragraph)===null||q===void 0?void 0:q[k])||{};return(0,e.jsxs)(_a.Z,{span:ie,children:[(0,e.jsx)("div",{style:{fontFamily:(u==null?void 0:u.font_family)||"Arial",fontSize:(u==null?void 0:u.font_size)||14,color:(u==null?void 0:u.font_color)||"black",backgroundImage:"url(".concat(G==null?void 0:G.illustration,")"),backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center",opacity:(u==null?void 0:u.text_opacity)||1,height:"92%",display:"flex",flexDirection:"column",alignItems:(u==null?void 0:u.text_flex_align)||"center",justifyContent:(u==null?void 0:u.text_flex_justify)||"center"}}),(0,e.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",fontFamily:(u==null?void 0:u.font_family)||"Arial",fontSize:(u==null?void 0:u.font_size)||14,color:(u==null?void 0:u.font_color)||"black",height:"8%"},children:G==null?void 0:G.para_content})]})})})})},dr=sr,cr=function(n){var f=n.showPreviewModal,s=n.setShowPreviewModal,t=n.chapterParaData,u=n.page_layout;return(0,e.jsx)(We.Y,{title:(0,e.jsxs)("div",{children:["\u9875\u9762\u9884\u89C8:",(0,e.jsx)("span",{style:{fontSize:14},children:u==null?void 0:u.title})]}),width:"462px",style:{padding:0},layout:"horizontal",visible:f,onVisibleChange:s,submitter:!1,children:(0,e.jsx)(dr,{chapterParaData:t,page_layout:u})})},pr=cr,vr=r(88032),ka=r(25049),zr=r(57663),hr=r(71577),fr=r(15643),mr=function(n){var f=n.showModal,s=n.setShowModal,t=n.record,u=(0,v.useState)(!1),P=(0,o.Z)(u,2),c=P[0],se=P[1],fe=(0,v.useState)(!1),_=(0,o.Z)(fe,2),K=_[0],A=_[1],te=(0,v.useState)({}),ie=(0,o.Z)(te,2),k=ie[0],q=ie[1];return(0,v.useEffect)(function(){var G=function(){var w=(0,i.Z)((0,a.Z)().mark(function de(){var H,ee;return(0,a.Z)().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return se(!0),H={pic_book:t==null?void 0:t.pic_book,para_content_uniq:t==null?void 0:t.para_content_uniq},D.prev=2,D.next=5,(0,Ne.BT)(H);case 5:ee=D.sent,q((ee==null?void 0:ee[0])||{}),D.next=12;break;case 9:D.prev=9,D.t0=D.catch(2),console.error("Error fetching data:",D.t0);case 12:return D.prev=12,se(!1),D.finish(12);case 15:case"end":return D.stop()}},de,null,[[2,9,12,15]])}));return function(){return w.apply(this,arguments)}}();G()},[t==null?void 0:t.id]),(0,e.jsx)(We.Y,{title:"\u7F16\u8F91\u8BED\u97F3",width:"600px",layout:"horizontal",visible:f,onVisibleChange:s,onFinish:function(){var G=(0,i.Z)((0,a.Z)().mark(function w(de){var H,ee;return(0,a.Z)().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(H=new FormData,H.append("voice_file",de.voice_file[0].originFileObj),H.append("pic_book",t==null?void 0:t.pic_book),H.append("voice_template","1"),H.append("para_content_uniq",t==null?void 0:t.para_content_uniq),!(k!=null&&k.id)){D.next=12;break}return H.append("id",k==null?void 0:k.id),D.next=9,(0,Ne.y0)(k==null?void 0:k.id,H);case 9:ee=D.sent,D.next=15;break;case 12:return D.next=14,(0,Ne.aU)(H);case 14:ee=D.sent;case 15:ee&&s(!1);case 16:case"end":return D.stop()}},w)}));return function(w){return G.apply(this,arguments)}}(),modalProps:{closable:!1},children:(0,e.jsx)("div",{children:k!=null&&k.voice_file&&!K?(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,e.jsxs)("audio",{controls:!0,style:{marginRight:"20px"},children:[(0,e.jsx)("source",{src:k==null?void 0:k.voice_file,type:"audio/mpeg"}),"Your browser does not support the audio element."]}),(0,e.jsx)("div",{children:(0,e.jsx)(hr.Z,{type:"primary",onClick:function(){A(!0)},children:"\u66FF\u6362"})})]}):(0,e.jsx)("div",{children:(0,e.jsx)(fr.Z,{name:"voice_file",label:"\u8BED\u97F3\u6587\u4EF6",max:1,fieldProps:{data:{},defaultFileList:[],multiple:!1,listType:"picture-card",accept:".mp3,.wav",maxCount:1},extra:"\u652F\u6301 mp3\u3001wav \u683C\u5F0F"})})})})},_r=mr,gr=function(n){var f,s,t,u,P,c,se,fe,_,K,A,te,ie,k,q=(0,v.useRef)(),G=n.picBookId,w=n.selectPage,de=n.setSelectPage,H=n.layoutOptionsData,ee=n.layoutOriginData,xe=n.setLayoutOriginData,D=n.configData,$=n.refreshMenu,Z=(0,v.useRef)(),ce=(0,v.useState)(!1),oe=(0,o.Z)(ce,2),$e=oe[0],Ve=oe[1],J=(0,v.useState)(!1),ke=(0,o.Z)(J,2),Ae=ke[0],He=ke[1],Je=(0,v.useState)(!1),ya=(0,o.Z)(Je,2),Ye=ya[0],Qe=ya[1],Xe=(0,v.useState)({}),Le=(0,o.Z)(Xe,2),qe=Le[0],Re=Le[1],De=(0,v.useState)(!1),U=(0,o.Z)(De,2),O=U[0],E=U[1],ne=(0,v.useState)(!1),me=(0,o.Z)(ne,2),Be=me[0],Ue=me[1],_e=(0,v.useState)({}),Ca=(0,o.Z)(_e,2),Dr=Ca[0],Hr=Ca[1],Mr=(0,v.useState)(!1),Ea=(0,o.Z)(Mr,2),Sa=Ea[0],Fa=Ea[1],Cr=(0,v.useState)({}),Ba=(0,o.Z)(Cr,2),Ta=Ba[0],Er=Ba[1],Sr=(0,v.useState)([]),Oa=(0,o.Z)(Sr,2),pe=Oa[0],Fr=Oa[1],Br=(0,v.useState)({}),$a=(0,o.Z)(Br,2),g=$a[0],Tr=$a[1];(0,v.useEffect)((0,i.Z)((0,a.Z)().mark(function le(){return(0,a.Z)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(!(w!=null&&w.page_id)){m.next=7;break}return Ve(!0),m.next=4,La();case 4:return m.next=6,Ke();case 6:Ve(!1);case 7:case"end":return m.stop()}},le)})),[w==null?void 0:w.page_id]);var La=function(){var le=(0,i.Z)((0,a.Z)().mark(function Y(){var m,z,Q;return(0,a.Z)().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,Ha({id:w==null?void 0:w.page_id});case 2:return m=C.sent,C.next=5,(0,ka.Nk)({});case 5:z=C.sent,xe(z),Q=z==null?void 0:z.find(function(T){return T.id==(m==null?void 0:m.layout)}),m.layout_cfg=Q,Tr(m);case 10:case"end":return C.stop()}},Y)}));return function(){return le.apply(this,arguments)}}(),Ke=function(){var le=(0,i.Z)((0,a.Z)().mark(function Y(){var m,z;return(0,a.Z)().wrap(function(we){for(;;)switch(we.prev=we.next){case 0:return we.next=2,Ja({id:w==null?void 0:w.page_id});case 2:z=we.sent,z.paragraph=z==null||(m=z.paragraph)===null||m===void 0?void 0:m.map(function(C,T){return(0,h.Z)((0,h.Z)({},C),{},{illustration_url:[{url:C.illustration}]})}),Fr(z);case 5:case"end":return we.stop()}},Y)}));return function(){return le.apply(this,arguments)}}(),Or=[{title:"\u6392\u5E8F",dataIndex:"seq",width:"8%"},{title:"\u77E5\u8BC6\u70B9",dataIndex:"knowledge",width:"22%",fieldProps:function(Y,m){var z=m.rowIndex,Q=m.rowKey;return{onChange:function(C){var T,Fe,Me,Se,Za=pe==null||(T=pe.chapter)===null||T===void 0?void 0:T.text_template.replace(/{{word}}/g,C==null||(Fe=C.target)===null||Fe===void 0?void 0:Fe.value);(Me=q.current)===null||Me===void 0||(Se=Me.setRowData)===null||Se===void 0||Se.call(Me,Q,{para_content:Za})}}}},{title:"\u5185\u5BB9",dataIndex:"para_content",width:"35%"},{title:"\u63D2\u56FE",dataIndex:"illustration",width:"15%",render:function(Y,m){return m!=null&&m.illustration?(0,e.jsx)(wa.Z,{src:m==null?void 0:m.illustration,width:35,height:35}):null},renderFormItem:function(Y,m,z){if(Y!=null&&Y.entry)return(0,e.jsx)(be.ZP,{initialValues:m==null?void 0:m.record,submitter:!1,children:(0,e.jsx)(er.Z,{max:1,name:"illustration_url",fieldProps:{data:{},defaultFileList:[],multiple:!1,accept:".png,.jpg,.jpeg",maxCount:1,customRequest:function(){var Q=(0,i.Z)((0,a.Z)().mark(function C(T){var Fe,Me,Se;return(0,a.Z)().wrap(function(Pe){for(;;)switch(Pe.prev=Pe.next){case 0:Fe=T.file,Me=T.onSuccess,Se=T.onError,Er((0,qa.Z)({},m.record.id,{file:Fe,onSuccess:Me,onError:Se})),Me();case 3:case"end":return Pe.stop()}},C)}));function we(C){return Q.apply(this,arguments)}return we}()},style:{height:30,width:30},extra:"\u652F\u6301 JPG\u3001PNG \u683C\u5F0F"})})}},{title:"\u64CD\u4F5C",valueType:"option",width:"18%",render:function(Y,m,z,Q){return[(0,e.jsx)("a",{onClick:function(){var C;Q==null||(C=Q.startEditable)===null||C===void 0||C.call(Q,m.id)},children:"\u7F16\u8F91"},"editable"),(0,e.jsx)(S.Z,{title:"\u786E\u5B9A\u5220\u9664\u6B64\u884C\uFF1F",onConfirm:(0,i.Z)((0,a.Z)().mark(function we(){return(0,a.Z)().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.prev=0,T.next=3,(0,R.jV)(m);case 3:return T.next=5,Ke();case 5:l.ZP.success("\u5220\u9664\u6210\u529F"),T.next=11;break;case 8:T.prev=8,T.t0=T.catch(0),l.ZP.error("\u5220\u9664\u5931\u8D25");case 11:case"end":return T.stop()}},we,null,[[0,8]])})),children:(0,e.jsx)("a",{children:"\u5220\u9664"})},"delete")]}}];return(0,e.jsxs)(ae.Z,{spinning:$e,children:[(0,e.jsxs)(ze.Z,{title:(0,e.jsxs)("div",{children:["\u7F16\u8F91\u9875\u9762: ",(0,e.jsx)("span",{style:{color:"red"},children:(0,e.jsx)("strong",{children:w==null?void 0:w.page_title})})]}),bordered:!0,direction:"column",extra:(0,e.jsx)(Ge.Z,{children:(0,e.jsx)(L.Z,{title:"\u5220\u9664\u5F53\u524D\u9875\u9762",children:(0,e.jsx)(S.Z,{title:"\u786E\u5B9A\u5220\u9664\u6B64\u9875\u9762\u5417\uFF1F",onConfirm:(0,i.Z)((0,a.Z)().mark(function le(){return(0,a.Z)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.prev=0,m.next=3,Ya({id:w==null?void 0:w.page_id});case 3:return de(null),m.next=6,$();case 6:l.ZP.success("\u5220\u9664\u6210\u529F"),m.next=12;break;case 9:m.prev=9,m.t0=m.catch(0),l.ZP.error("\u5220\u9664\u5931\u8D25");case 12:case"end":return m.stop()}},le,null,[[0,9]])})),children:(0,e.jsx)(ur.Z,{style:{color:"red",fontSize:"18px"}})},"delete")})}),children:[(0,e.jsxs)(xa.Z,{gutter:[16,16],children:[(0,e.jsx)(_a.Z,{span:16,children:(0,e.jsxs)(ze.Z,{bordered:!0,title:"\u9875\u9762\u6A21\u677F",extra:(0,e.jsx)(Ge.Z,{children:(0,e.jsx)("a",{onClick:function(){Re((g==null?void 0:g.layout_cfg)||{}),Qe(!0)},children:"\u7F16\u8F91"})}),children:[(0,e.jsxs)(ga.UW,{style:{height:35},children:[(0,e.jsx)(be.ZP.Item,{label:(0,e.jsx)("strong",{children:"\u540D\u79F0"}),children:(0,e.jsx)("span",{children:g==null||(f=g.layout_cfg)===null||f===void 0?void 0:f.title})}),(0,e.jsx)(be.ZP.Item,{label:(0,e.jsx)("strong",{children:"\u63CF\u8FF0"}),children:(0,e.jsx)("span",{children:g==null||(s=g.layout_cfg)===null||s===void 0?void 0:s.description})}),(0,e.jsx)(be.ZP.Item,{label:(0,e.jsx)("strong",{children:"\u6805\u683C\u95F4\u8DDD"}),children:(0,e.jsx)("span",{children:g==null||(t=g.layout_cfg)===null||t===void 0?void 0:t.grid_gutter})}),(0,e.jsx)(be.ZP.Item,{label:(0,e.jsx)("strong",{children:"\u6805\u683C\u5E03\u5C40"}),children:(0,e.jsx)("span",{children:g==null||(u=g.layout_cfg)===null||u===void 0?void 0:u.grid_row_col})})]}),(0,e.jsxs)(ga.UW,{style:{height:35},children:[(0,e.jsx)(be.ZP.Item,{label:(0,e.jsx)("strong",{children:"\u5B57\u4F53"}),children:(0,e.jsx)("span",{children:g==null||(P=g.layout_cfg)===null||P===void 0?void 0:P.font_family})}),(0,e.jsx)(be.ZP.Item,{label:(0,e.jsx)("strong",{children:"\u5B57\u4F53\u989C\u8272"}),children:(0,e.jsx)("div",{style:{backgroundColor:g==null||(c=g.layout_cfg)===null||c===void 0?void 0:c.font_color,marginTop:6,width:"55px",height:"20px",border:"1px solid lightgray",display:"inline-block"}})}),(0,e.jsx)(be.ZP.Item,{label:(0,e.jsx)("strong",{children:"\u5B57\u4F53\u5927\u5C0F"}),children:(0,e.jsx)("span",{children:g==null||(se=g.layout_cfg)===null||se===void 0?void 0:se.font_size})}),(0,e.jsx)(be.ZP.Item,{label:(0,e.jsx)("strong",{children:"\u6587\u672C\u900F\u660E\u5EA6"}),children:(0,e.jsx)("span",{children:g==null||(fe=g.layout_cfg)===null||fe===void 0?void 0:fe.text_opacity})})]}),(0,e.jsxs)(ga.UW,{style:{height:35},children:[(0,e.jsx)(be.ZP.Item,{label:(0,e.jsx)("strong",{children:"\u6587\u672C\u4E3B\u8F74\u4F4D\u7F6E"}),children:(0,e.jsx)("span",{children:g==null||(_=g.layout_cfg)===null||_===void 0?void 0:_.text_flex_justify})}),(0,e.jsx)(be.ZP.Item,{label:(0,e.jsx)("strong",{children:"\u6587\u672C\u4EA4\u53C9\u8F74\u4F4D\u7F6E"}),children:(0,e.jsx)("span",{children:g==null||(K=g.layout_cfg)===null||K===void 0?void 0:K.text_flex_align})}),(0,e.jsx)(be.ZP.Item,{label:(0,e.jsx)("strong",{children:"\u80CC\u666F\u56FE\u7247"}),children:(0,e.jsx)(wa.Z,{src:g==null||(A=g.layout_cfg)===null||A===void 0?void 0:A.background_img,width:35,height:35})}),(0,e.jsx)(be.ZP.Item,{label:(0,e.jsx)("strong",{children:"\u80CC\u666F\u989C\u8272"}),children:(0,e.jsx)("div",{style:{backgroundColor:g==null||(te=g.layout_cfg)===null||te===void 0?void 0:te.background_color,marginTop:6,width:"55px",height:"20px",border:"1px solid lightgray",display:"inline-block"}})})]})]})}),(0,e.jsx)(_a.Z,{span:8,children:(0,e.jsx)(ze.Z,{title:"\u7AE0\u8282\u6A21\u677F",bordered:!0,style:{height:"100%"},extra:(0,e.jsx)(Ge.Z,{children:(0,e.jsx)("a",{onClick:function(){Fa(!0)},children:"\u7F16\u8F91"})}),children:(0,e.jsx)(be.ZP.Item,{children:(0,e.jsx)("span",{children:pe==null||(ie=pe.chapter)===null||ie===void 0?void 0:ie.text_template})})})})]}),(0,e.jsx)(ze.Z,{bordered:!0,extra:(0,e.jsxs)(Ge.Z,{children:[(0,e.jsx)("a",{onClick:function(){He(!0)},children:"\u9875\u9762\u9884\u89C8"}),(0,e.jsx)("a",{onClick:function(){E(!0)},children:"\u5185\u5BB9\u6392\u5E8F"})]}),style:{width:"100%",height:"100%",marginTop:10},title:"\u6BB5\u843D\u5185\u5BB9",subTitle:(0,e.jsxs)("div",{children:["\u6BCF\u9875",(0,e.jsx)("span",{style:{color:"red"},children:JSON.parse((g==null||(k=g.layout_cfg)===null||k===void 0?void 0:k.grid_row_col)||"[]").length}),"\u4E2A\u77E5\u8BC6\u70B9\uFF01"]}),children:(0,e.jsx)(ar.Z,{rowKey:"id",headerTitle:!1,maxLength:5,actionRef:Z,editableFormRef:q,style:{width:"100%"},recordCreatorProps:{position:"bottom",creatorButtonText:"\u6DFB\u52A0\u6BB5\u843D",record:function(){var Y;return{id:(0,Pa.D)(),seq:(pe==null||(Y=pe.paragraph)===null||Y===void 0?void 0:Y.reduce(function(m,z){return z.seq>m?z.seq:m},0))+1}}},loading:!1,columns:Or,value:(pe==null?void 0:pe.paragraph)||[],editable:{type:"multiple",onSave:function(){var le=(0,i.Z)((0,a.Z)().mark(function m(z,Q,we){var C,T,Fe,Me,Se;return(0,a.Z)().wrap(function(Pe){for(;;)switch(Pe.prev=Pe.next){case 0:if(T=new FormData,(C=Ta[z])!==null&&C!==void 0&&C.file&&T.append("illustration",(Fe=Ta[z])===null||Fe===void 0?void 0:Fe.file),T.append("pic_book",g==null?void 0:g.pic_book),T.append("chapter",g==null?void 0:g.chapter),T.append("book_page",w==null?void 0:w.page_id),T.append("para_content",Q.para_content),T.append("knowledge",Q.knowledge),T.append("para_content_uniq",(0,Pa.J)(Q.para_content)),typeof z!="string"){Pe.next=15;break}return Pe.next=11,(0,R.HA)(T);case 11:Me=Pe.sent,Me!=null&&Me.id?l.ZP.success("\u65B0\u589E\u6210\u529F"):l.ZP.error("\u65B0\u589E\u5931\u8D25"),Pe.next=19;break;case 15:return Pe.next=17,(0,R.YA)(Q==null?void 0:Q.id,T);case 17:Se=Pe.sent,Se!=null&&Se.id?l.ZP.success("\u7F16\u8F91\u6210\u529F"):l.ZP.error("\u7F16\u8F91\u5931\u8D25");case 19:return Pe.next=21,Ke();case 21:case"end":return Pe.stop()}},m)}));function Y(m,z,Q){return le.apply(this,arguments)}return Y}(),onDelete:function(){var le=(0,i.Z)((0,a.Z)().mark(function m(z,Q){return(0,a.Z)().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.prev=0,C.next=3,(0,R.jV)(Q);case 3:l.ZP.success("\u5220\u9664\u6210\u529F"),C.next=9;break;case 6:C.prev=6,C.t0=C.catch(0),l.ZP.error("\u5220\u9664\u5931\u8D25");case 9:case"end":return C.stop()}},m,null,[[0,6]])}));function Y(m,z){return le.apply(this,arguments)}return Y}()}})})]}),O&&(0,e.jsx)(lr,{showModal:O,setShowModal:E,chapterParaData:pe,updateChapterParaDataFunc:Ke,page_id:w==null?void 0:w.page_id}),Sa&&(0,e.jsx)(or,{showModal:Sa,setShowModal:Fa,chapterData:pe==null?void 0:pe.chapter,updateChapterParaDataFunc:Ke}),Ae&&(0,e.jsx)(pr,{showPreviewModal:Ae,setShowPreviewModal:He,chapterParaData:pe,page_layout:g==null?void 0:g.layout_cfg}),Ye&&(0,e.jsx)(vr.Z,{record:qe,setShowModal:Qe,showModal:Ye,updatePageDetailsFunc:La}),Be&&(0,e.jsx)(_r,{record:Dr,setShowModal:Ue,showModal:Be})]})},yr=gr,Oe=r(91214),Nr=r(62999),Da=r(54680),Zr=r(98442),Ma=r(88611),br=r(90672),xr=r(64317),wr=function(n){var f=(0,v.useState)(!1),s=(0,o.Z)(f,2),t=s[0],u=s[1],P=(0,v.useRef)(),c=n.setShowMenuModal,se=n.showMenuModal,fe=n.setEditMenu,_=n.editMenu,K=n.picBookId,A=n.layoutOptionsData,te=n.layoutOriginData,ie=n.refreshMenu,k=(0,v.useState)("chapter"),q=(0,o.Z)(k,2),G=q[0],w=q[1],de=(0,v.useState)((0,i.Z)((0,a.Z)().mark(function D(){var $,Z;return(0,a.Z)().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return oe.next=2,Ka({id:K});case 2:$=oe.sent,(0,Oe.IT)($),Z=Object.assign([],$),Z.unshift({key:"0-0",title:"\u65E0\u7236\u5206\u7EC4",value:"0-0"}),xe({withDefault:Z,unDefault:$});case 7:case"end":return oe.stop()}},D)}))),H=(0,o.Z)(de,2),ee=H[0],xe=H[1];return(0,v.useEffect)((0,i.Z)((0,a.Z)().mark(function D(){var $;return(0,a.Z)().wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:if(!(_!=null&&_.key)){ce.next=9;break}return u(!0),ce.next=4,za({id:_==null?void 0:_.key});case 4:$=ce.sent,_.text_template=$==null?void 0:$.text_template,u(!1),ce.next=10;break;case 9:u(!1);case 10:case"end":return ce.stop()}},D)})),[_==null?void 0:_.key]),!t&&(0,e.jsxs)(We.Y,{title:(_==null?void 0:_.title)==null?"\u65B0\u5EFA\u7AE0\u8282/\u9875\u9762":"\u4FEE\u6539\u7AE0\u8282",width:"600px",layout:"horizontal",visible:se,onVisibleChange:c,onFinish:function(){var D=(0,i.Z)((0,a.Z)().mark(function $(Z){var ce,oe,$e;return(0,a.Z)().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:if((_==null?void 0:_.title)!=null){J.next=15;break}if(G!="chapter"){J.next=8;break}return oe={pic_book:K,title:Z==null?void 0:Z.title,text_template:Z==null?void 0:Z.text_template,parent:typeof(Z==null?void 0:Z.parent)=="number"?Z==null?void 0:Z.parent:null},J.next=5,Ga(oe);case 5:$e=J.sent,J.next=13;break;case 8:if(G!="page"){J.next=13;break}return oe={title:Z==null?void 0:Z.title,chapter:Z==null?void 0:Z.chapter,paragraphs:[],pic_book:K,layout:Z==null?void 0:Z.layout},J.next=12,(0,R.WR)(oe);case 12:$e=J.sent;case 13:J.next=19;break;case 15:return oe={id:_==null?void 0:_.key,title:Z==null?void 0:Z.title,text_template:Z==null?void 0:Z.text_template,parent:typeof(Z==null?void 0:Z.parent)=="number"?Z==null?void 0:Z.parent:null},J.next=18,ba(oe);case 18:$e=J.sent;case 19:if(!((ce=$e)!==null&&ce!==void 0&&ce.id)){J.next=25;break}return c(!1),J.next=23,ie();case 23:J.next=26;break;case 25:l.ZP.error("\u5904\u7406\u5931\u8D25");case 26:case"end":return J.stop()}},$)}));return function($){return D.apply(this,arguments)}}(),modalProps:{closable:!1},children:[(_==null?void 0:_.title)==null&&(0,e.jsx)(Zr.Z.Group,{name:"add_type",label:"\u65B0\u5EFA\u7C7B\u578B",initialValue:G,labelCol:{span:4},rules:[{required:!0}],options:[{label:"\u7AE0\u8282",value:"chapter"},{label:"\u9875\u9762",value:"page"}],fieldProps:{onChange:function($){var Z;w($==null||(Z=$.target)===null||Z===void 0?void 0:Z.value)}}}),G=="chapter"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ja.Z,{width:"md",name:"title",label:"\u7AE0\u8282\u540D\u79F0",labelCol:{span:4},initialValue:(_==null?void 0:_.title)||"",rules:[{required:!0}]}),(0,e.jsx)(br.Z,{width:"md",name:"text_template",label:"\u6587\u6848\u6A21\u677F",labelCol:{span:4},initialValue:(_==null?void 0:_.text_template)||"",rules:[{required:!0}]}),(0,e.jsx)(Ma.A.Item,{label:"\u7236\u7AE0\u8282",name:"parent",labelCol:{span:4},initialValue:(_==null?void 0:_.parent)||"0-0",rules:[{required:!0}],children:(0,e.jsx)(Da.Z,{showSearch:!0,style:{width:330},treeNodeFilterProp:"title",treeData:Object.keys(ee).length>0?ee==null?void 0:ee.withDefault:[]})})]}),G=="page"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(xr.Z,{rules:[{required:!0}],labelCol:{span:4},width:"md",label:"\u9875\u9762\u6A21\u677F",name:"layout",options:A}),(0,e.jsx)(Ma.A.Item,{label:"\u6240\u5C5E\u7AE0\u8282",name:"chapter",labelCol:{span:4},initialValue:(_==null?void 0:_.parent)||void 0,rules:[{required:!0}],children:(0,e.jsx)(Da.Z,{showSearch:!0,style:{width:330},treeNodeFilterProp:"title",treeData:Object.keys(ee).length>0?ee==null?void 0:ee.unDefault:[]})})]})]})},Pr=wr,jr=function(n){var f,s=n==null||(f=n.location)===null||f===void 0?void 0:f.query,t=s.id,u=(0,v.useState)({}),P=(0,o.Z)(u,2),c=P[0],se=P[1],fe=(0,v.useState)(!1),_=(0,o.Z)(fe,2),K=_[0],A=_[1],te=(0,v.useState)(!1),ie=(0,o.Z)(te,2),k=ie[0],q=ie[1],G=(0,v.useState)({}),w=(0,o.Z)(G,2),de=w[0],H=w[1],ee=(0,v.useState)(!1),xe=(0,o.Z)(ee,2),D=xe[0],$=xe[1],Z=(0,v.useState)([]),ce=(0,o.Z)(Z,2),oe=ce[0],$e=ce[1],Ve=(0,v.useState)({}),J=(0,o.Z)(Ve,2),ke=J[0],Ae=J[1],He=(0,v.useState)({}),Je=(0,o.Z)(He,2),ya=Je[0],Ye=Je[1],Qe=(0,v.useState)((0,i.Z)((0,a.Z)().mark(function De(){var U;return(0,a.Z)().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,(0,ka.Nk)({});case 2:U=E.sent,qe(U);case 4:case"end":return E.stop()}},De)}))),Xe=(0,o.Z)(Qe,2),Le=Xe[0],qe=Xe[1],Re=function(){var De=(0,i.Z)((0,a.Z)().mark(function U(){var O,E;return(0,a.Z)().wrap(function(me){for(;;)switch(me.prev=me.next){case 0:return $(!0),me.next=3,Va({id:t});case 3:O=me.sent,E=(0,Oe.hs)(O),Ae(E),$e(O),$(!1);case 8:case"end":return me.stop()}},U)}));return function(){return De.apply(this,arguments)}}();return(0,v.useEffect)((0,i.Z)((0,a.Z)().mark(function De(){var U;return(0,a.Z)().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(!t){E.next=9;break}return E.next=3,Re();case 3:return $(!0),E.next=6,(0,R.Cy)({id:t});case 6:U=E.sent,se(U),$(!1);case 9:case"end":return E.stop()}},De)})),[t]),(0,e.jsxs)(M._z,{title:!1,pageHeaderRender:!1,children:[(0,e.jsx)("div",{style:{width:K?40:260,position:"fixed",top:"68px",bottom:0,background:"#ffffff"},children:(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[(0,e.jsx)(N.Z,{defaultActiveKey:"default",style:{flex:1,overflow:"scroll",margin:"0 8px"},tabBarExtraContent:{right:(0,e.jsx)("a",{onClick:function(){H({}),q(!0)},children:"\u6DFB\u52A0"})},children:(0,e.jsx)(b.Z,{tab:"\u76EE\u5F55",style:{color:"black"},children:D?(0,e.jsx)(ae.Z,{spinning:!0,children:"\u76EE\u5F55\u52A0\u8F7D\u4E2D"}):Object.keys(oe).length>0?(0,e.jsx)(re.Z,{showLine:!0,defaultExpandAll:!0,onSelect:function(U,O){var E,ne,me;if(!((O==null||(E=O.node)===null||E===void 0?void 0:E.id)==(ke==null?void 0:ke.page_id)||D)&&(Ye(O==null||(ne=O.node)===null||ne===void 0?void 0:ne.key),O!=null&&(me=O.node)!==null&&me!==void 0&&me.isLeaf)){var Be,Ue;Ae({page_id:O==null||(Be=O.node)===null||Be===void 0?void 0:Be.id,parent:O==null||(Ue=O.node)===null||Ue===void 0?void 0:Ue.parent})}},selectedKeys:["leaf_".concat(ke==null?void 0:ke.page_id)],draggable:{icon:!1},onDrop:function(){var De=(0,i.Z)((0,a.Z)().mark(function U(O){var E,ne,me,Be;return(0,a.Z)().wrap(function(_e){for(;;)switch(_e.prev=_e.next){case 0:if(E=(0,Oe.FC)(O),E!=null&&E.canDrag){_e.next=8;break}if(!(E!=null&&E.errMsg)){_e.next=7;break}return l.ZP.error(E==null?void 0:E.errMsg),_e.abrupt("return");case 7:return _e.abrupt("return");case 8:if(ne=(0,Oe.EF)(O,oe),me=(0,Oe.W8)(O,ne),(0,Oe.Pv)(me)){_e.next=12;break}return _e.abrupt("return");case 12:return $(!0),_e.next=15,Xa(me);case 15:if(Be=_e.sent,!(Be.length>0)){_e.next=20;break}return l.ZP.success("\u4FEE\u6539\u6210\u529F"),_e.next=20,Re();case 20:$(!1);case 21:case"end":return _e.stop()}},U)}));return function(U){return De.apply(this,arguments)}}(),titleRender:function(U){return[U==null?void 0:U.title,(0,e.jsx)("span",{style:{marginLeft:5},children:(0,e.jsx)(he.Z,{overlay:(0,e.jsxs)(B.Z,{children:[(0,e.jsx)(B.Z.Item,{onClick:function(){H(U),q(!0)},children:"\u4FEE\u6539\u7AE0\u8282"}),(0,e.jsx)(B.Z.Item,{children:(0,e.jsx)(S.Z,{title:"\u786E\u5B9A\u5220\u9664\u8BE5\u7AE0\u8282\u5417\uFF1F",onConfirm:(0,i.Z)((0,a.Z)().mark(function O(){return(0,a.Z)().wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:return ne.prev=0,ne.next=3,Na({id:U==null?void 0:U.key});case 3:return ne.next=5,Re();case 5:l.ZP.success("\u5220\u9664\u6210\u529F"),ne.next=11;break;case 8:ne.prev=8,ne.t0=ne.catch(0),l.ZP.error("\u5220\u9664\u5931\u8D25");case 11:case"end":return ne.stop()}},O,null,[[0,8]])})),children:"\u5220\u9664\u7AE0\u8282"},"delete")})]}),placement:"bottomLeft",arrow:!0,children:(0,e.jsx)("a",{style:{marginLeft:10},children:(0,e.jsx)(I.Z,{hidden:U==null?void 0:U.isLeaf})})})})]},expandAction:"doubleClick",treeData:oe}):"\u6682\u65E0\u6570\u636E"},"default")}),(0,e.jsx)("div",{style:{height:"39px",justifyContent:"center",alignItems:"center",display:"flex"},onClick:function(U){A(!K)},children:K?(0,e.jsx)(L.Z,{title:"\u5C55\u5F00",placement:"right",children:(0,e.jsx)(Ze.Z,{})}):(0,e.jsxs)("span",{children:[(0,e.jsx)(V.Z,{style:{marginRight:5}}),"\u6536\u8D77"]})})]})}),(0,e.jsx)("div",{style:{marginLeft:K?50:270},children:(ke==null?void 0:ke.page_id)&&(0,e.jsx)(yr,{picBookId:t,selectPage:ke,setSelectPage:Ae,configData:c,layoutOriginData:Le,refreshMenu:Re,layoutOptionsData:(0,Oe.V1)(Le),setLayoutOriginData:qe})}),k&&(0,e.jsx)(Pr,{setShowMenuModal:q,showMenuModal:k,setEditMenu:H,editMenu:de,picBookId:t,layoutOriginData:Le,layoutOptionsData:(0,Oe.V1)(Le),refreshMenu:Re})]})},kr=jr},91214:function(Ie,ge,r){"use strict";r.d(ge,{hs:function(){return W},f$:function(){return ae},V1:function(){return ye},IT:function(){return re},FC:function(){return ve},W8:function(){return he},EF:function(){return S},Pv:function(){return X}});var F=r(39428),L=r(3182),ue=r(86582),N=r(37720),W=function(d){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=void 0,i=function v(M,R){for(var I=0;I<M.length;I++){if(M[I].isLeaf)return R(l?M[I].tag_label:{page_id:M[I].id,page_title:M[I].title,parent:M[I].parent});M[I].children&&v(M[I].children,R)}},o=(0,ue.Z)(d);return i(o,function(v){a==null&&(a=v)}),a},ae=function(){var B=(0,L.Z)((0,F.Z)().mark(function d(){var l;return(0,F.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,N.Qm)({});case 2:return l=i.sent,i.abrupt("return",l==null?void 0:l.map(function(o){return{label:o==null?void 0:o.knowledge,value:o==null?void 0:o.id}}));case 4:case"end":return i.stop()}},d)}));return function(){return B.apply(this,arguments)}}(),ye=function(d){return d==null?void 0:d.map(function(l){return{label:"".concat(l==null?void 0:l.title,"(").concat(l==null?void 0:l.grid_row_col,")"),value:l==null?void 0:l.id}})},re=function B(d){d==null||d.forEach(function(l){l.value=l.key,l!=null&&l.children&&B(l==null?void 0:l.children)})},ve=function(d){var l=!0,a="";if(d.dragNode.isLeaf&&d.dropPosition==-1)return{canDrag:!1,errMsg:"\u7981\u6B62page\u8282\u70B9\u653E\u5230\u6700\u5916\u5C42"};if(d.node.pos.split("-").length>5)return{canDrag:!1,errMsg:"\u76EE\u5F55\u6700\u5927\u5C42\u7EA7\u4E0D\u80FD\u8D85\u8FC73\u5C42"};if(d.dropToGap){if(d.dragNode.isLeaf)return{canDrag:!1,errMsg:"page\u8282\u70B9\u53EA\u80FD\u653E\u5728\u7AE0\u8282\u5185"}}else{var i;if(!d.dragNode.isLeaf&&!d.node.isLeaf)return{canDrag:!1,errMsg:"\u7981\u6B62\u7AE0\u8282\u62D6\u653E\u5230page\u8282\u70B9"};if(d.node.expanded&&((i=d.node.pos.split("-"))===null||i===void 0?void 0:i.length)>4)return{canDrag:!1,errMsg:"\u76EE\u5F55\u6700\u5927\u5C42\u7EA7\u4E0D\u80FD\u8D85\u8FC73\u5C42"}}return{canDrag:l,errMsg:a}},he=function(d,l){var a,i=Ee(d.dragNode.key,l);return{sort_key:d.dragNode.key,target_parent:i.target_parent,target_children:(a=i.target_children)===null||a===void 0?void 0:a.map(function(o){return o.key})}},Ee=function(d,l){var a="",i=[],o=function v(M,R,I,Ze){for(var V=0;V<M.length;V++){if(M[V].key===R)return Ze(M[V],V,I,M);M[V].children&&v(M[V].children,R,M[V].key,Ze)}};return o(l,d,null,function(v,M,R,I){a=R,i=I}),{target_parent:a,target_children:i}},S=function(d,l){var a=d.node.key,i=d.dragNode.key,o=d.node.pos.split("-"),v=d.dropPosition-Number(o[o.length-1]),M=function b(h,y,j){for(var x=0;x<h.length;x++){if(h[x].key===y)return j(h[x],x,h);h[x].children&&b(h[x].children,y,j)}},R=(0,ue.Z)(l),I;if(M(R,i,function(b,h,y){y.splice(h,1),I=b}),!d.dropToGap)M(R,a,function(b){b.children=b.children||[],b.children.unshift(I)});else if((d.node.props.children||[]).length>0&&d.node.props.expanded&&v===1)M(R,a,function(b){b.children=b.children||[],b.children.unshift(I)});else{var Ze,V;M(R,a,function(b,h,y){Ze=y,V=h}),v===-1?Ze.splice(V,0,I):Ze.splice(V+1,0,I)}return R},X=function(d){var l;return!(d.sort_key.toString().startsWith("leaf_")&&(l=d.target_parent)!==null&&l!==void 0&&l.toString().startsWith("leaf_")||d.target_parent==null)}},86028:function(Ie,ge,r){"use strict";r.d(ge,{J:function(){return ue},D:function(){return N}});var F=r(81354),L=r.n(F),ue=function(ae){return F.MD5(ae).toString()},N=function(){var ae=new Date().getTime(),ye="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(re){var ve=(ae+Math.random()*16)%16|0;return ae=Math.floor(ae/16),(re=="x"?ve:ve&7|8).toString(16)});return ye}},37720:function(Ie,ge,r){"use strict";r.d(ge,{Qm:function(){return ye},Et:function(){return ve},dz:function(){return Ee}});var F=r(93224),L=r(39428),ue=r(11849),N=r(3182),W=r(78370),ae=["id"];function ye(d,l){return re.apply(this,arguments)}function re(){return re=(0,N.Z)((0,L.Z)().mark(function d(l,a){return(0,L.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,W.Z)("/api/pic_book/knowledge/",(0,ue.Z)({method:"GET",params:(0,ue.Z)({},l)},a||{})));case 1:case"end":return o.stop()}},d)})),re.apply(this,arguments)}function ve(d,l){return he.apply(this,arguments)}function he(){return he=(0,N.Z)((0,L.Z)().mark(function d(l,a){var i,o,v;return(0,L.Z)().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return i=l.id,o=i===void 0?0:i,v=(0,F.Z)(l,ae),R.abrupt("return",(0,W.Z)("/api/pic_book/knowledge/".concat(o,"/"),(0,ue.Z)({method:"PATCH",data:(0,ue.Z)({},v)},a||{})));case 2:case"end":return R.stop()}},d)})),he.apply(this,arguments)}function Ee(d,l){return S.apply(this,arguments)}function S(){return S=(0,N.Z)((0,L.Z)().mark(function d(l,a){return(0,L.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,W.Z)("/api/pic_book/knowledge/",(0,ue.Z)({method:"POST",data:(0,ue.Z)({},l)},a||{})));case 1:case"end":return o.stop()}},d)})),S.apply(this,arguments)}function X(d,l){return B.apply(this,arguments)}function B(){return B=_asyncToGenerator(_regeneratorRuntime().mark(function d(l,a){var i,o;return _regeneratorRuntime().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return i=l.id,o=i===void 0?0:i,M.abrupt("return",request("/api/pic_book/knowledge/".concat(o),_objectSpread({method:"DELETE"},a||{})));case 2:case"end":return M.stop()}},d)})),B.apply(this,arguments)}},25049:function(Ie,ge,r){"use strict";r.d(ge,{Nk:function(){return W},fc:function(){return ye},Lk:function(){return ve}});var F=r(39428),L=r(11849),ue=r(3182),N=r(78370);function W(X,B){return ae.apply(this,arguments)}function ae(){return ae=(0,ue.Z)((0,F.Z)().mark(function X(B,d){return(0,F.Z)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,N.Z)("/api/pic_book/layout/",(0,L.Z)({method:"GET",params:(0,L.Z)({},B)},d||{})));case 1:case"end":return a.stop()}},X)})),ae.apply(this,arguments)}function ye(X,B,d){return re.apply(this,arguments)}function re(){return re=(0,ue.Z)((0,F.Z)().mark(function X(B,d,l){return(0,F.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,N.Z)("/api/pic_book/layout/".concat(B,"/"),(0,L.Z)({method:"PATCH",data:d},l||{})));case 1:case"end":return i.stop()}},X)})),re.apply(this,arguments)}function ve(X,B){return he.apply(this,arguments)}function he(){return he=(0,ue.Z)((0,F.Z)().mark(function X(B,d){return(0,F.Z)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,N.Z)("/api/pic_book/layout/",(0,L.Z)({method:"POST",data:B},d||{})));case 1:case"end":return a.stop()}},X)})),he.apply(this,arguments)}function Ee(X,B){return S.apply(this,arguments)}function S(){return S=_asyncToGenerator(_regeneratorRuntime().mark(function X(B,d){var l,a;return _regeneratorRuntime().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return l=B.id,a=l===void 0?0:l,o.abrupt("return",request("/api/pic_book/layout/".concat(a),_objectSpread({method:"DELETE"},d||{})));case 2:case"end":return o.stop()}},X)})),S.apply(this,arguments)}},87766:function(Ie,ge,r){"use strict";r.d(ge,{aL:function(){return re},tN:function(){return he},VJ:function(){return S},R$:function(){return B},BT:function(){return l},aU:function(){return v},y0:function(){return R}});var F=r(39428),L=r(11849),ue=r(93224),N=r(3182),W=r(78370),ae=["id"],ye=null;function re(b,h){return ve.apply(this,arguments)}function ve(){return ve=(0,N.Z)((0,F.Z)().mark(function b(h,y){var j,x,je;return(0,F.Z)().wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:return j=h.id,x=j===void 0?0:j,je=(0,ue.Z)(h,ae),Ce.abrupt("return",(0,W.Z)("/api/pic_book/book/".concat(x,"/voice_list/"),(0,L.Z)({method:"GET",params:(0,L.Z)({},je)},y||{})));case 2:case"end":return Ce.stop()}},b)})),ve.apply(this,arguments)}function he(b,h){return Ee.apply(this,arguments)}function Ee(){return Ee=(0,N.Z)((0,F.Z)().mark(function b(h,y){return(0,F.Z)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.abrupt("return",(0,W.Z)("/api/pic_book/book_voice/",(0,L.Z)({method:"POST",data:h},y||{})));case 1:case"end":return x.stop()}},b)})),Ee.apply(this,arguments)}function S(b,h){return X.apply(this,arguments)}function X(){return X=(0,N.Z)((0,F.Z)().mark(function b(h,y){return(0,F.Z)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.abrupt("return",(0,W.Z)("/api/pic_book/book_voice/bulk_gen_voice_files/",(0,L.Z)({method:"POST",data:h},y||{})));case 1:case"end":return x.stop()}},b)})),X.apply(this,arguments)}function B(b,h){return d.apply(this,arguments)}function d(){return d=(0,N.Z)((0,F.Z)().mark(function b(h,y){return(0,F.Z)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.abrupt("return",(0,W.Z)("/api/pic_book/book_voice/paragraph_voice_file/",(0,L.Z)({method:"POST",data:h},y||{})));case 1:case"end":return x.stop()}},b)})),d.apply(this,arguments)}function l(b,h){return a.apply(this,arguments)}function a(){return a=(0,N.Z)((0,F.Z)().mark(function b(h,y){return(0,F.Z)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.abrupt("return",(0,W.Z)("/api/pic_book/paragraph_voice/",(0,L.Z)({method:"GET",params:(0,L.Z)({},h)},y||{})));case 1:case"end":return x.stop()}},b)})),a.apply(this,arguments)}function i(b,h){return o.apply(this,arguments)}function o(){return o=_asyncToGenerator(_regeneratorRuntime().mark(function b(h,y){var j,x,je;return _regeneratorRuntime().wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:return j=h.id,x=j===void 0?0:j,je=_objectWithoutProperties(h,ye),Ce.abrupt("return",request("/api/pic_book/paragraph_voice/".concat(x,"/"),_objectSpread({method:"GET",params:_objectSpread({},je)},y||{})));case 2:case"end":return Ce.stop()}},b)})),o.apply(this,arguments)}function v(b,h){return M.apply(this,arguments)}function M(){return M=(0,N.Z)((0,F.Z)().mark(function b(h,y){return(0,F.Z)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.abrupt("return",(0,W.Z)("/api/pic_book/paragraph_voice/",(0,L.Z)({method:"POST",data:h},y||{})));case 1:case"end":return x.stop()}},b)})),M.apply(this,arguments)}function R(b,h,y){return I.apply(this,arguments)}function I(){return I=(0,N.Z)((0,F.Z)().mark(function b(h,y,j){return(0,F.Z)().wrap(function(je){for(;;)switch(je.prev=je.next){case 0:return je.abrupt("return",(0,W.Z)("/api/pic_book/paragraph_voice/".concat(h,"/"),(0,L.Z)({method:"PATCH",data:y},j||{})));case 1:case"end":return je.stop()}},b)})),I.apply(this,arguments)}function Ze(b,h){return V.apply(this,arguments)}function V(){return V=_asyncToGenerator(_regeneratorRuntime().mark(function b(h,y){var j,x;return _regeneratorRuntime().wrap(function(Te){for(;;)switch(Te.prev=Te.next){case 0:return j=h.id,x=j===void 0?0:j,Te.abrupt("return",request("/api/pic_book/paragraph_voice/".concat(x,"/"),_objectSpread({method:"DELETE"},y||{})).catch(function(Ce){return{}}));case 2:case"end":return Te.stop()}},b)})),V.apply(this,arguments)}},42480:function(){}}]);
