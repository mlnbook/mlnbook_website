(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[622],{88263:function(wa,Le,l){"use strict";l.r(Le),l.d(Le,{default:function(){return wt}});var Pe=l(22385),N=l(45777),se=l(18106),le=l(63885),ke=l(20228),Se=l(11382),Ne=l(32157),Fe=l(3974),Je=l(34792),E=l(48086),u=l(39428),Z=l(3182),k=l(2824),m=l(67294),fe=l(87720),de=l(61870),q=l(1351),Ze=l(76629),Be=l(42698),I=l(11849),xe=l(93224),J=l(78370),Qe=null,Ge=["id"],ba=["id"],Ue=["id"],_a=null,Ke=["id"],Pa=["id"],ze=null,M=["id"],S=["id"],W=["id"];function j(c,e){return $.apply(this,arguments)}function $(){return $=_asyncToGenerator(_regeneratorRuntime().mark(function c(e,d){var r,t,s;return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.id,t=r===void 0?0:r,s=_objectWithoutProperties(e,Qe),n.abrupt("return",request("/api/pic_book/book/".concat(t,"/chapter_page_menu/"),_objectSpread({method:"GET"},d||{})));case 2:case"end":return n.stop()}},c)})),$.apply(this,arguments)}function ne(c,e){return ie.apply(this,arguments)}function ie(){return ie=(0,Z.Z)((0,u.Z)().mark(function c(e,d){var r,t,s;return(0,u.Z)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.id,t=r===void 0?0:r,s=(0,xe.Z)(e,Ge),n.abrupt("return",(0,J.Z)("/api/pic_book/book/".concat(t,"/chapter_menu/"),(0,I.Z)({method:"GET"},d||{})));case 2:case"end":return n.stop()}},c)})),ie.apply(this,arguments)}function ee(c,e){return Xe.apply(this,arguments)}function Xe(){return Xe=(0,Z.Z)((0,u.Z)().mark(function c(e,d){return(0,u.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,J.Z)("/api/pic_book/chapter/",(0,I.Z)({method:"POST",data:(0,I.Z)({},e)},d||{})));case 1:case"end":return t.stop()}},c)})),Xe.apply(this,arguments)}function Ma(c,e){return qe.apply(this,arguments)}function qe(){return qe=(0,Z.Z)((0,u.Z)().mark(function c(e,d){var r,t,s;return(0,u.Z)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.id,t=r===void 0?0:r,s=(0,xe.Z)(e,ba),n.abrupt("return",(0,J.Z)("/api/pic_book/chapter/".concat(t,"/"),(0,I.Z)({method:"GET",params:s},d||{})));case 2:case"end":return n.stop()}},c)})),qe.apply(this,arguments)}function ka(c,e){return ea.apply(this,arguments)}function ea(){return ea=(0,Z.Z)((0,u.Z)().mark(function c(e,d){var r,t,s;return(0,u.Z)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.id,t=r===void 0?0:r,s=(0,xe.Z)(e,Ue),n.abrupt("return",(0,J.Z)("/api/pic_book/chapter/".concat(t,"/"),(0,I.Z)({method:"PATCH",data:s},d||{})));case 2:case"end":return n.stop()}},c)})),ea.apply(this,arguments)}function Pt(c,e){return aa.apply(this,arguments)}function aa(){return aa=_asyncToGenerator(_regeneratorRuntime().mark(function c(e,d){var r,t;return _regeneratorRuntime().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r=e.id,t=r===void 0?0:r,i.abrupt("return",request("/api/pic_book/chapter/".concat(t,"/"),_objectSpread({method:"DELETE"},d||{})).catch(function(n){return{}}));case 2:case"end":return i.stop()}},c)})),aa.apply(this,arguments)}function kt(c,e){return ta.apply(this,arguments)}function ta(){return ta=_asyncToGenerator(_regeneratorRuntime().mark(function c(e,d){var r,t,s;return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.id,t=r===void 0?0:r,s=_objectWithoutProperties(e,_a),n.abrupt("return",request("/api/pic_book/book_page/".concat(t,"/"),_objectSpread({method:"GET",params:s},d||{})));case 2:case"end":return n.stop()}},c)})),ta.apply(this,arguments)}function $a(c,e){return ra.apply(this,arguments)}function ra(){return ra=(0,Z.Z)((0,u.Z)().mark(function c(e,d){var r,t,s;return(0,u.Z)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.id,t=r===void 0?0:r,s=(0,xe.Z)(e,Ke),n.abrupt("return",(0,J.Z)("/api/pic_book/chapter/".concat(t,"/paragraph/"),(0,I.Z)({method:"GET",params:s},d||{})));case 2:case"end":return n.stop()}},c)})),ra.apply(this,arguments)}function xt(c,e){return na.apply(this,arguments)}function na(){return na=_asyncToGenerator(_regeneratorRuntime().mark(function c(e,d){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/api/pic_book/paragraph/",_objectSpread({method:"GET",params:_objectSpread({},e)},d||{})));case 1:case"end":return t.stop()}},c)})),na.apply(this,arguments)}function Ea(c,e){return ia.apply(this,arguments)}function ia(){return ia=(0,Z.Z)((0,u.Z)().mark(function c(e,d){return(0,u.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,J.Z)("/api/pic_book/paragraph/",(0,I.Z)({method:"POST",data:e},d||{})));case 1:case"end":return t.stop()}},c)})),ia.apply(this,arguments)}function Fa(c,e,d){return la.apply(this,arguments)}function la(){return la=(0,Z.Z)((0,u.Z)().mark(function c(e,d,r){return(0,u.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,J.Z)("/api/pic_book/paragraph/".concat(e,"/"),(0,I.Z)({method:"PATCH",data:d},r||{})));case 1:case"end":return s.stop()}},c)})),la.apply(this,arguments)}function xa(c,e){return ua.apply(this,arguments)}function ua(){return ua=(0,Z.Z)((0,u.Z)().mark(function c(e,d){var r,t;return(0,u.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r=e.id,t=r===void 0?0:r,i.abrupt("return",(0,J.Z)("/api/pic_book/paragraph/".concat(t,"/"),(0,I.Z)({method:"DELETE"},d||{})).catch(function(n){return{}}));case 2:case"end":return i.stop()}},c)})),ua.apply(this,arguments)}function Ba(c,e){return oa.apply(this,arguments)}function oa(){return oa=(0,Z.Z)((0,u.Z)().mark(function c(e,d){var r,t,s;return(0,u.Z)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.id,t=r===void 0?0:r,s=(0,xe.Z)(e,Pa),n.abrupt("return",(0,J.Z)("/api/pic_book/paragraph/set_seq/",(0,I.Z)({method:"POST",data:s},d||{})));case 2:case"end":return n.stop()}},c)})),oa.apply(this,arguments)}function Oa(c,e){return sa.apply(this,arguments)}function sa(){return sa=(0,Z.Z)((0,u.Z)().mark(function c(e,d){return(0,u.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,J.Z)("/api/pic_book/book/sort_menu/",(0,I.Z)({method:"POST",data:(0,I.Z)({},e)},d||{})));case 1:case"end":return t.stop()}},c)})),sa.apply(this,arguments)}function Ct(c,e){return da.apply(this,arguments)}function da(){return da=_asyncToGenerator(_regeneratorRuntime().mark(function c(e,d){var r,t,s;return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.id,t=r===void 0?0:r,s=_objectWithoutProperties(e,ze),n.abrupt("return",request("/api/pic_book/book/".concat(t,"/chapter_typeset/"),_objectSpread({method:"GET",params:_objectSpread({},s)},d||{})));case 2:case"end":return n.stop()}},c)})),da.apply(this,arguments)}function Ra(c,e){return ca.apply(this,arguments)}function ca(){return ca=(0,Z.Z)((0,u.Z)().mark(function c(e,d){return(0,u.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,J.Z)("/api/pic_book/typeset/",(0,I.Z)({method:"POST",data:(0,I.Z)({},e)},d||{})));case 1:case"end":return t.stop()}},c)})),ca.apply(this,arguments)}function La(c,e){return pa.apply(this,arguments)}function pa(){return pa=(0,Z.Z)((0,u.Z)().mark(function c(e,d){var r,t,s;return(0,u.Z)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.id,t=r===void 0?0:r,s=(0,xe.Z)(e,M),n.abrupt("return",(0,J.Z)("/api/pic_book/typeset/".concat(t,"/"),(0,I.Z)({method:"PATCH",data:(0,I.Z)({},s)},d||{})));case 2:case"end":return n.stop()}},c)})),pa.apply(this,arguments)}function Ca(c,e){return ha.apply(this,arguments)}function ha(){return ha=(0,Z.Z)((0,u.Z)().mark(function c(e,d){var r,t;return(0,u.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r=e.id,t=r===void 0?0:r,i.abrupt("return",(0,J.Z)("/api/pic_book/typeset/".concat(t,"/"),(0,I.Z)({method:"DELETE"},d||{})).catch(function(n){return{}}));case 2:case"end":return i.stop()}},c)})),ha.apply(this,arguments)}function Ia(c,e){return va.apply(this,arguments)}function va(){return va=(0,Z.Z)((0,u.Z)().mark(function c(e,d){var r,t,s;return(0,u.Z)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.id,t=r===void 0?0:r,s=(0,xe.Z)(e,S),n.abrupt("return",(0,J.Z)("/api/pic_book/chapter_typeset/".concat(t,"/"),(0,I.Z)({method:"PATCH",data:(0,I.Z)({},s)},d||{})));case 2:case"end":return n.stop()}},c)})),va.apply(this,arguments)}function Aa(c,e){return fa.apply(this,arguments)}function fa(){return fa=(0,Z.Z)((0,u.Z)().mark(function c(e,d){var r,t,s;return(0,u.Z)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.id,t=r===void 0?0:r,s=(0,xe.Z)(e,W),n.abrupt("return",(0,J.Z)("/api/pic_book/chapter/".concat(t,"/batch_aigc/"),(0,I.Z)({method:"POST",data:(0,I.Z)({},s)},d||{})));case 2:case"end":return n.stop()}},c)})),fa.apply(this,arguments)}var Dt=l(57106),Ga=l(99683),St=l(49111),ma=l(19650),jt=l(62350),ga=l(24565),Ua=l(32059),Tt=l(12968),Ka=l(20352),Ie=l(952),za=l(60451),We=l(27510),Da=l(5314),ya=l(86028),Ve=l(27408),Wa=l(92305),Va=l(42762),a=l(85893),Ha=function(e){var d=(0,m.useRef)(),r=e.showModal,t=e.setShowModal,s=e.chapterParaData,i=e.updateChapterParaDataFunc,n=[{title:"\u6392\u5E8F",dataIndex:"seq",render:function(v,_,g){return(0,a.jsxs)("span",{className:"customRender",children:[" ",_==null?void 0:_.seq]})}},{title:"ID",dataIndex:"id"},{title:"\u5185\u5BB9",dataIndex:"para_content"},{title:"\u77E5\u8BC6\u70B9",dataIndex:"knowledge"}],K=function(){var f=(0,Z.Z)((0,u.Z)().mark(function v(_,g,C){var y;return(0,u.Z)().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return y=C==null?void 0:C.map(function(z,T){return z==null?void 0:z.id}),F.next=3,Ba({seq_list:y});case 3:return F.next=5,i();case 5:case"end":return F.stop()}},v)}));return function(_,g,C){return f.apply(this,arguments)}}(),o=function(v,_){return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(Va.Z,{style:{cursor:"grab",color:"gold"}})})};return(0,a.jsx)(Ve.Y,{title:"\u8C03\u6574\u6BB5\u843D\u5185\u5BB9\u987A\u5E8F",width:"600px",layout:"horizontal",visible:r,onVisibleChange:t,onFinish:function(){var f=(0,Z.Z)((0,u.Z)().mark(function v(_){return(0,u.Z)().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:t(!1);case 1:case"end":return C.stop()}},v)}));return function(v){return f.apply(this,arguments)}}(),modalProps:{closable:!1},submitter:{render:function(v,_){return(0,a.jsxs)("div",{children:[_[1]," "]})}},children:(0,a.jsx)(Wa.Z,{actionRef:d,columns:n,rowKey:"id",size:"small",search:!1,options:{density:!1},toolBarRender:!1,pagination:!1,dataSource:s==null?void 0:s.paragraph,dragSortKey:"seq",onDragSortEnd:K,dragSortHandlerRender:o})})},Na=Ha,Ye=l(47745),Ja=function(e){var d=e.showModal,r=e.setShowModal,t=e.chapterData,s=e.updateChapterParaDataFunc,i=e.refreshMenu;return(0,a.jsxs)(Ve.Y,{title:"\u7F16\u8F91\u7AE0\u8282",width:"500px",layout:"horizontal",visible:d,onVisibleChange:r,initialValues:t,onFinish:function(){var n=(0,Z.Z)((0,u.Z)().mark(function K(o){var f,v;return(0,u.Z)().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return f={id:t==null?void 0:t.id,title:o==null?void 0:o.title,text_template:o==null?void 0:o.text_template,prompt_template:o==null?void 0:o.prompt_template},g.next=3,ka(f);case 3:if(v=g.sent,!v){g.next=8;break}return E.ZP.success("\u66F4\u65B0\u7AE0\u8282\u6A21\u677F\u6210\u529F"),g.next=8,s();case 8:if((t==null?void 0:t.title)==(o==null?void 0:o.title)){g.next=11;break}return g.next=11,i();case 11:r(!1);case 12:case"end":return g.stop()}},K)}));return function(K){return n.apply(this,arguments)}}(),children:[(0,a.jsx)(Ye.Z,{name:"title",labelCol:{span:5},label:"\u7AE0\u8282\u6807\u9898",rules:[{required:!0}]}),(0,a.jsx)(Ye.Z,{labelCol:{span:5},name:"text_template",label:"\u6587\u6848\u6A21\u677F",rules:[{required:!0}]}),(0,a.jsx)(Ye.Z,{labelCol:{span:5},name:"prompt_template",label:"\u63D0\u793A\u8BCD\u6A21\u677F",rules:[{required:!0}]})]})},Ya=Ja,Mt=l(13062),Sa=l(71230),$t=l(57663),Qa=l(71577),Et=l(89032),Za=l(15746),Ft=l(71153),Xa=l(60331),je=l(21832),qa=l(25641),et=function(e){var d,r=e.typesetData,t=e.showTypesetModal,s=e.setShowTypesetModal,i=e.layoutOptionsData,n=e.refreshSelectTagFunc,K=e.updateChapterParaDataFunc,o=e.index,f=o===void 0?void 0:o;return(0,a.jsx)(Ve.Y,{title:f!=null?"\u7F16\u8F91\u5E03\u5C40\u9875\u9762":"\u65B0\u589E\u5E03\u5C40\u9875\u9762",width:"500px",layout:"horizontal",visible:t,onVisibleChange:s,initialValues:f!=null?{layout:r==null||(d=r.setting)===null||d===void 0?void 0:d[f]}:{},onFinish:function(){var v=(0,Z.Z)((0,u.Z)().mark(function _(g){var C,y;return(0,u.Z)().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return C={id:r==null?void 0:r.id,setting:r==null?void 0:r.setting},f==null?C.setting.push(g==null?void 0:g.layout):C.setting[f]=g==null?void 0:g.layout,F.next=4,Ia(C);case 4:if(y=F.sent,s(!1),!(y!=null&&y.id)){F.next=12;break}return F.next=9,K();case 9:n(),F.next=13;break;case 12:E.ZP.error("\u6DFB\u52A0\u5931\u8D25");case 13:case"end":return F.stop()}},_)}));return function(_){return v.apply(this,arguments)}}(),children:(0,a.jsx)(qa.Z,{rules:[{required:!0}],labelCol:{span:4},width:"md",label:"\u9875\u9762\u6A21\u677F",name:"layout",options:i})})},ja=et,at=function(e,d,r,t){var s,i,n=0,K=0;return d>0&&(e==null||e.forEach(function(o,f){if(f<d){var v,_;n+=(v=JSON.parse(t==null||(_=t[o])===null||_===void 0?void 0:_.grid_row_col))===null||v===void 0?void 0:v.length}})),K=n+((s=JSON.parse(t==null||(i=t[r])===null||i===void 0?void 0:i.grid_row_col))===null||s===void 0?void 0:s.length),{start:n,end:K}},tt=function(e){var d,r,t,s=e.chapterParaData,i=e.layoutOriginData,n=e.layoutTemplateId,K=e.index,o=e.layoutOptionsData,f=e.paraLayoutRelation,v=e.setParaLayoutRelation,_=e.setLoading,g=e.pageLayoutList,C=e.currentTypeset,y=e.updateChapterParaDataFunc,B=e.refreshSelectTagFunc,F=(0,m.useState)(!1),z=(0,k.Z)(F,2),T=z[0],x=z[1],R=(0,je.vT)(i),V=at(g,K,n,R),p=R==null?void 0:R[n],X=s==null||(d=s.paragraphs)===null||d===void 0?void 0:d.slice(V==null?void 0:V.start,V==null?void 0:V.end);return(0,a.jsxs)("div",{children:[(0,a.jsx)(We.Z,{title:"\u9875\u9762".concat(K+1),bordered:!0,extra:(0,a.jsx)(ma.Z,{children:(0,a.jsx)("a",{hidden:(C==null?void 0:C.c_type)=="norm",onClick:function(){x(!0)},children:"\u5207\u6362"})}),children:(0,a.jsx)("div",{style:{height:"350px",border:"1px dashed gray",backgroundImage:"url(".concat(p==null?void 0:p.background_img,")"),backgroundColor:p==null?void 0:p.background_color},children:(0,a.jsx)(Sa.Z,{gutter:p==null?void 0:p.grid_gutter,align:"stretch",style:{height:"100%"},children:(r=JSON.parse(p==null?void 0:p.grid_row_col))===null||r===void 0?void 0:r.map(function(A,ae){var we,ue=(X==null?void 0:X[ae])||{},ce="",Te="",Ce=(p==null?void 0:p.font_size)||14;return((we=JSON.parse(p==null?void 0:p.grid_row_col))===null||we===void 0?void 0:we.length)==1?(ce="50%",Te="50%",Ce=Ce*2):(ce="92%",Te="8%"),(0,a.jsxs)(Za.Z,{span:A,children:[(0,a.jsx)("div",{style:{fontFamily:(p==null?void 0:p.font_family)||"Arial",fontSize:(p==null?void 0:p.font_size)||14,color:(p==null?void 0:p.font_color)||"black",backgroundImage:"url(".concat(ue==null?void 0:ue.illustration,")"),backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center",opacity:(p==null?void 0:p.text_opacity)||1,height:ce,display:"flex",flexDirection:"column",alignItems:(p==null?void 0:p.text_flex_align)||"center",justifyContent:(p==null?void 0:p.text_flex_justify)||"center"}}),(0,a.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",fontFamily:(p==null?void 0:p.font_family)||"Arial",fontSize:Ce,color:(p==null?void 0:p.font_color)||"black",height:Te},children:ue==null?void 0:ue.para_content})]})})})})}),T&&(0,a.jsx)(ja,{showTypesetModal:T,setShowTypesetModal:x,updateChapterParaDataFunc:y,refreshSelectTagFunc:B,typesetData:C==null||(t=C.chapter_typesets)===null||t===void 0?void 0:t.find(function(A){var ae;return A.chapter==(s==null||(ae=s.chapter)===null||ae===void 0?void 0:ae.id)}),layoutOptionsData:o,index:K})]})},rt=tt,nt=l(51042),it=Xa.Z.CheckableTag,lt=function(e){var d,r,t,s=e.selectTypeset,i=e.chapterParaData,n=e.layoutOptionsData,K=e.layoutOriginData,o=e.updateChapterParaDataFunc,f=i==null||(d=i.typeset_data)===null||d===void 0?void 0:d.find(function(H){return H.id===s}),v=(0,m.useState)([]),_=(0,k.Z)(v,2),g=_[0],C=_[1],y=(i==null||(r=i.paragraphs)===null||r===void 0?void 0:r.map(function(H){return H==null?void 0:H.knowledge}))||[],B=(0,m.useState)([]),F=(0,k.Z)(B,2),z=F[0],T=F[1],x=(0,m.useState)([]),R=(0,k.Z)(x,2),V=R[0],p=R[1],X=(0,m.useState)(!1),A=(0,k.Z)(X,2),ae=A[0],we=A[1],ue=(0,m.useState)({}),ce=(0,k.Z)(ue,2),Te=ce[0],Ce=ce[1],Oe=(0,m.useState)(!1),pe=(0,k.Z)(Oe,2),Re=pe[0],Ee=pe[1],Me=function(){if(Ee(!0),(f==null?void 0:f.c_type)=="norm"){C((f==null?void 0:f.setting)||[]),T(y);var me=(0,je.ic)(y,f),be=Array(me).fill(f==null?void 0:f.setting).flat();p(be)}else{var h,Y,G=(f==null||(h=f.chapter_typesets)===null||h===void 0||(Y=h.find(function(ge){var Ae;return ge.chapter==(i==null||(Ae=i.chapter)===null||Ae===void 0?void 0:Ae.id)}))===null||Y===void 0?void 0:Y.setting)||[];C(G);var D=(0,je.P7)(G,K,y),he=D.select_cnt,te=D.format_layout;T(y==null?void 0:y.slice(0,he)),p(te)}Ee(!1)};return(0,m.useEffect)(function(){Me()},[g,s,i==null||(t=i.chapter)===null||t===void 0?void 0:t.id,i==null?void 0:i.paragraphs]),(0,a.jsxs)(Se.Z,{spinning:Re,children:[(0,a.jsx)(Ie.ZP.Item,{label:"\u5DF2\u6392\u7248\u6BB5\u843D",children:(0,a.jsx)(ma.Z,{size:[0,8],wrap:!0,children:y.map(function(H){return(0,a.jsx)(it,{checked:z.includes(H),children:H},H)})})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(Sa.Z,{gutter:16,children:[V==null?void 0:V.map(function(H,me){return(0,a.jsx)(Za.Z,{span:8,children:(0,a.jsx)(rt,{chapterParaData:i,layoutOriginData:K,layoutOptionsData:n,layoutTemplateId:H,index:me,currentTypeset:f,setLoading:Ee,refreshSelectTagFunc:Me,pageLayoutList:V,paraLayoutRelation:g,setParaLayoutRelation:C,updateChapterParaDataFunc:o})})}),(f==null?void 0:f.c_type)=="custom"&&(z==null?void 0:z.length)<(y==null?void 0:y.length)&&(0,a.jsx)(Za.Z,{span:8,children:(0,a.jsx)(We.Z,{title:(0,a.jsx)("div",{children:"\xA0"}),bordered:!0,children:(0,a.jsx)("div",{style:{height:"350px",display:"flex",justifyContent:"center",alignItems:"center",border:"1px dashed gray"},children:(0,a.jsxs)(Qa.Z,{type:"primary",onClick:function(){var me;we(!0),Ce(f==null||(me=f.chapter_typesets)===null||me===void 0?void 0:me.find(function(be){var h;return be.chapter==(i==null||(h=i.chapter)===null||h===void 0?void 0:h.id)}))},children:[(0,a.jsx)(nt.Z,{}),"\u65B0\u5EFA"]})})})})]}),ae&&(0,a.jsx)(ja,{showTypesetModal:ae,setShowTypesetModal:we,refreshSelectTagFunc:Me,updateChapterParaDataFunc:o,typesetData:Te,layoutOptionsData:n})]})]})},ut=lt,Ta=l(8212),Bt=l(17462),ot=l(76772),st=function(e){var d=(0,m.useRef)(),r=(0,m.useRef)(),t=e.showTypesetModal,s=e.setShowTypesetModal,i=e.chapterParaData,n=e.updateChapterParaDataFunc,K=[{title:"\u6392\u5E8F",dataIndex:"seq",width:"8%"},{title:"\u6A21\u677F\u4FE1\u606F",dataIndex:"title",width:"30%",render:function(f,v){if((v==null?void 0:v.c_type)=="norm"){var _,g;return(0,a.jsxs)("div",{children:[v==null?void 0:v.title,(0,a.jsx)("br",{}),"grid_row_col: ",v==null||(_=v.layout_cfg)===null||_===void 0||(g=_[0])===null||g===void 0?void 0:g.grid_row_col]})}return v==null?void 0:v.title}},{title:"\u6A21\u677F\u7C7B\u578B",dataIndex:"c_type",width:"15%",valueEnum:{norm:{text:"\u5185\u7F6E\u6A21\u677F",value:"norm",disabled:!0},custom:{text:"\u4EBA\u5DE5\u5B9A\u5236",value:"custom"}}},{title:"\u64CD\u4F5C",valueType:"option",width:"18%",render:function(f,v,_,g){return[(0,a.jsx)("a",{hidden:(v==null?void 0:v.c_type)=="norm",onClick:function(){var y;g==null||(y=g.startEditable)===null||y===void 0||y.call(g,v.id)},children:"\u7F16\u8F91"},"editable"),(0,a.jsx)(ga.Z,{title:"\u786E\u5B9A\u5220\u9664\u6B64\u884C\uFF1F",onConfirm:(0,Z.Z)((0,u.Z)().mark(function C(){return(0,u.Z)().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.prev=0,B.next=3,Ca(v);case 3:return B.next=5,n();case 5:E.ZP.success("\u5220\u9664\u6210\u529F"),B.next=11;break;case 8:B.prev=8,B.t0=B.catch(0),E.ZP.error("\u5220\u9664\u5931\u8D25");case 11:case"end":return B.stop()}},C,null,[[0,8]])})),children:(0,a.jsx)("a",{hidden:(v==null?void 0:v.c_type)=="norm",children:"\u5220\u9664"})},"delete")]}}];return(0,a.jsxs)(Ve.Y,{title:"\u7F16\u8F91\u7ED8\u672C\u5E03\u5C40",width:"750px",layout:"horizontal",visible:t,onVisibleChange:s,submitter:!1,children:[(0,a.jsx)(ot.Z,{message:"\u5F53\u524D\u4EC5\u652F\u6301\u6DFB\u52A0\u4EBA\u5DE5\u5B9A\u5236\u5E03\u5C40",type:"warning"}),(0,a.jsx)(Da.Z,{rowKey:"id",headerTitle:!1,actionRef:d,editableFormRef:r,style:{width:"100%"},recordCreatorProps:{position:"bottom",creatorButtonText:"\u6DFB\u52A0\u5E03\u5C40",record:function(){var f;return{id:(0,ya.DO)(),seq:((i==null||(f=i.typeset_data)===null||f===void 0?void 0:f.reduce(function(v,_){return _.seq>v?_.seq:v},0))||0)+1}}},loading:!1,columns:K,value:(i==null?void 0:i.typeset_data)||[],editable:{type:"multiple",onSave:function(){var o=(0,Z.Z)((0,u.Z)().mark(function v(_,g,C){var y,B,F;return(0,u.Z)().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(g.pic_book=i==null||(y=i.chapter)===null||y===void 0?void 0:y.pic_book,typeof _!="string"){T.next=8;break}return T.next=4,Ra(g);case 4:B=T.sent,B!=null&&B.id?E.ZP.success("\u65B0\u589E\u6210\u529F"):E.ZP.error("\u65B0\u589E\u5931\u8D25"),T.next=12;break;case 8:return T.next=10,La(g);case 10:F=T.sent,F!=null&&F.id?E.ZP.success("\u7F16\u8F91\u6210\u529F"):E.ZP.error("\u7F16\u8F91\u5931\u8D25");case 12:return T.next=14,n();case 14:case"end":return T.stop()}},v)}));function f(v,_,g){return o.apply(this,arguments)}return f}(),onDelete:function(){var o=(0,Z.Z)((0,u.Z)().mark(function v(_,g){return(0,u.Z)().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.prev=0,console.log("row",g),y.next=4,Ca(g);case 4:E.ZP.success("\u5220\u9664\u6210\u529F"),y.next=10;break;case 7:y.prev=7,y.t0=y.catch(0),E.ZP.error("\u5220\u9664\u5931\u8D25");case 10:case"end":return y.stop()}},v,null,[[0,7]])}));function f(v,_){return o.apply(this,arguments)}return f}()}})]})},dt=st,ct=function(e){var d,r,t,s,i,n=(0,m.useRef)(),K=e.picBookId,o=e.selectChapter,f=e.setSelectChapter,v=e.layoutOptionsData,_=e.layoutOriginData,g=e.setLayoutOriginData,C=e.configData,y=e.refreshMenu,B=(0,m.useRef)(),F=(0,m.useRef)(),z=(0,m.useState)(!1),T=(0,k.Z)(z,2),x=T[0],R=T[1],V=(0,m.useState)(!1),p=(0,k.Z)(V,2),X=p[0],A=p[1],ae=(0,m.useState)(!1),we=(0,k.Z)(ae,2),ue=we[0],ce=we[1],Te=(0,m.useState)(!1),Ce=(0,k.Z)(Te,2),Oe=Ce[0],pe=Ce[1],Re=(0,m.useState)({}),Ee=(0,k.Z)(Re,2),Me=Ee[0],H=Ee[1],me=(0,m.useState)([]),be=(0,k.Z)(me,2),h=be[0],Y=be[1],G=(0,m.useState)(0),D=(0,k.Z)(G,2),he=D[0],te=D[1];(0,m.useEffect)((0,Z.Z)((0,u.Z)().mark(function P(){return(0,u.Z)().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(!(o!=null&&o.chapter_id)){w.next=5;break}return R(!0),w.next=4,ge();case 4:R(!1);case 5:case"end":return w.stop()}},P)})),[o==null?void 0:o.chapter_id]);var ge=function(){var P=(0,Z.Z)((0,u.Z)().mark(function U(){var w,re,b,_e;return(0,u.Z)().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,$a({id:o==null?void 0:o.chapter_id});case 2:b=L.sent,b.paragraphs=b==null||(w=b.paragraphs)===null||w===void 0?void 0:w.map(function(ve,Q){return(0,I.Z)((0,I.Z)({},ve),{},{illustration_url:[{url:ve.illustration}]})}),(b==null||(re=b.typeset_data)===null||re===void 0?void 0:re.length)>0&&he==0&&te((_e=b.typeset_data[0])===null||_e===void 0?void 0:_e.id),Y(b);case 6:case"end":return L.stop()}},U)}));return function(){return P.apply(this,arguments)}}(),Ae=[{title:"\u6392\u5E8F",dataIndex:"seq",width:"8%"},{title:"\u77E5\u8BC6\u70B9",dataIndex:"knowledge",width:"12%",fieldProps:function(U,w){var re=w.rowIndex,b=w.rowKey;return{onChange:function(O){var L,ve,Q,De,$e,ye,He,oe,bt=h==null||(L=h.chapter)===null||L===void 0||(ve=L.text_template)===null||ve===void 0?void 0:ve.replace(/{{word}}/g,O==null||(Q=O.target)===null||Q===void 0?void 0:Q.value),_t=h==null||(De=h.chapter)===null||De===void 0||($e=De.prompt_template)===null||$e===void 0?void 0:$e.replace(/{{word}}/g,O==null||(ye=O.target)===null||ye===void 0?void 0:ye.value);(He=n.current)===null||He===void 0||(oe=He.setRowData)===null||oe===void 0||oe.call(He,b,{para_content:bt,aigc_prompt:_t})}}}},{title:"\u5185\u5BB9",dataIndex:"para_content",width:"25%"},{title:"\u56FE\u7247\u63D0\u793A\u8BCD",dataIndex:"aigc_prompt",width:"25%"},{title:"\u63D2\u56FE",dataIndex:"illustration",width:"15%",render:function(U,w){return w!=null&&w.illustration?(0,a.jsx)(Ka.Z,{src:w==null?void 0:w.illustration,width:35,height:35}):null},renderFormItem:function(U,w,re){if(U!=null&&U.entry)return(0,a.jsx)(Ie.ZP,{initialValues:w==null?void 0:w.record,submitter:!1,children:(0,a.jsx)(za.Z,{max:1,name:"illustration_url",fieldProps:{data:{},defaultFileList:[],multiple:!1,accept:".png,.jpg,.jpeg",maxCount:1,customRequest:function(){var b=(0,Z.Z)((0,u.Z)().mark(function O(L){var ve,Q,De;return(0,u.Z)().wrap(function(ye){for(;;)switch(ye.prev=ye.next){case 0:ve=L.file,Q=L.onSuccess,De=L.onError,H((0,Ua.Z)({},w.record.id,{file:ve,onSuccess:Q,onError:De})),Q();case 3:case"end":return ye.stop()}},O)}));function _e(O){return b.apply(this,arguments)}return _e}()},style:{height:30,width:30},extra:"\u652F\u6301 JPG\u3001PNG \u683C\u5F0F"})})}},{title:"\u64CD\u4F5C",valueType:"option",width:"18%",render:function(U,w,re,b){return[(0,a.jsx)("a",{onClick:function(){var O;b==null||(O=b.startEditable)===null||O===void 0||O.call(b,w.id)},children:"\u7F16\u8F91"},"editable"),(0,a.jsx)(ga.Z,{title:"\u786E\u5B9A\u5220\u9664\u6B64\u884C\uFF1F",onConfirm:(0,Z.Z)((0,u.Z)().mark(function _e(){return(0,u.Z)().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.prev=0,L.next=3,xa(w);case 3:return L.next=5,ge();case 5:E.ZP.success("\u5220\u9664\u6210\u529F"),L.next=11;break;case 8:L.prev=8,L.t0=L.catch(0),E.ZP.error("\u5220\u9664\u5931\u8D25");case 11:case"end":return L.stop()}},_e,null,[[0,8]])})),children:(0,a.jsx)("a",{children:"\u5220\u9664"})},"delete")]}}];return(0,a.jsxs)(Se.Z,{spinning:x,children:[(0,a.jsx)(We.Z,{title:"\u57FA\u7840\u914D\u7F6E",bordered:!0,style:{height:"100%"},children:(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"row",height:"100%"},children:[(0,a.jsx)("div",{style:{width:"30%",marginRight:"20px"},children:(0,a.jsxs)(Ie.ZP.Item,{label:(0,a.jsx)("strong",{children:"\u7ED8\u672C\u540D\u79F0"}),children:[(0,a.jsx)("span",{children:C==null?void 0:C.title}),(0,a.jsx)("strong",{children:(0,a.jsxs)("a",{onClick:function(){ce(!0)},style:{marginLeft:"5px"},children:[(0,a.jsx)(Ta.Z,{})," \u5E03\u5C40"]})})]})}),(0,a.jsx)("div",{style:{width:"20%",marginRight:"20px"},children:(0,a.jsx)(Ie.ZP.Item,{label:(0,a.jsx)("strong",{children:"\u7AE0\u8282\u6807\u9898"}),children:(0,a.jsx)("span",{children:h==null||(d=h.chapter)===null||d===void 0?void 0:d.title})})}),(0,a.jsx)("div",{style:{width:"35%"},children:(0,a.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,a.jsx)(Ie.ZP.Item,{label:(0,a.jsx)("strong",{children:"\u7AE0\u8282\u6A21\u677F"}),children:(0,a.jsx)("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:h==null||(r=h.chapter)===null||r===void 0?void 0:r.text_template})})})}),(0,a.jsx)("div",{style:{width:"35%"},children:(0,a.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,a.jsxs)(Ie.ZP.Item,{label:(0,a.jsx)("strong",{children:"prompt\u6A21\u677F"}),children:[(0,a.jsx)("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:h==null||(t=h.chapter)===null||t===void 0?void 0:t.prompt_template}),(0,a.jsx)("a",{style:{marginLeft:5},onClick:function(){pe(!0)},children:(0,a.jsx)(Ta.Z,{})})]})})})]})}),(0,a.jsx)(We.Z,{bordered:!0,extra:(0,a.jsxs)(ma.Z,{children:[(0,a.jsx)(ga.Z,{placement:"bottomLeft",title:"\u786E\u5B9A\u6279\u91CF\u751F\u6210\u672C\u7AE0\u8282\u56FE\u7247\u5417\uFF1F",onConfirm:(0,Z.Z)((0,u.Z)().mark(function P(){var U,w;return(0,u.Z)().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.prev=0,U={id:o==null?void 0:o.chapter_id},b.next=4,Aa(U);case 4:w=b.sent,E.ZP.success(w==null?void 0:w.detail),b.next=11;break;case 8:b.prev=8,b.t0=b.catch(0),E.ZP.error("\u5904\u7406\u5931\u8D25");case 11:case"end":return b.stop()}},P,null,[[0,8]])})),children:(0,a.jsx)("a",{children:"\u6279\u91CF\u751F\u6210\u56FE\u7247"})},"batch_aigc"),(0,a.jsx)("a",{onClick:function(){A(!0)},children:"\u5185\u5BB9\u6392\u5E8F"})]}),style:{width:"100%",height:"100%"},title:"\u6BB5\u843D\u5185\u5BB9",children:(0,a.jsx)(Da.Z,{rowKey:"id",headerTitle:!1,actionRef:B,editableFormRef:n,scroll:{x:960,y:350},style:{width:"100%"},recordCreatorProps:{position:"bottom",creatorButtonText:"\u6DFB\u52A0\u6BB5\u843D",record:function(){var U;return{id:(0,ya.DO)(),seq:((h==null||(U=h.paragraphs)===null||U===void 0?void 0:U.reduce(function(w,re){return re.seq>w?re.seq:w},0))||0)+1}}},loading:!1,columns:Ae,value:(h==null?void 0:h.paragraphs)||[],editable:{type:"multiple",onSave:function(){var P=(0,Z.Z)((0,u.Z)().mark(function w(re,b,_e){var O,L,ve,Q,De,$e,ye;return(0,u.Z)().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:if(Q=new FormData,(O=Me[re])!==null&&O!==void 0&&O.file&&Q.append("illustration",(De=Me[re])===null||De===void 0?void 0:De.file),Q.append("pic_book",h==null||(L=h.chapter)===null||L===void 0?void 0:L.pic_book),Q.append("chapter",h==null||(ve=h.chapter)===null||ve===void 0?void 0:ve.id),Q.append("para_content",b.para_content),Q.append("aigc_prompt",b.aigc_prompt),Q.append("knowledge",b.knowledge),Q.append("para_content_uniq",(0,ya.J6)(b.para_content)),typeof re!="string"){oe.next=15;break}return oe.next=11,Ea(Q);case 11:$e=oe.sent,$e!=null&&$e.id?E.ZP.success("\u65B0\u589E\u6210\u529F"):E.ZP.error("\u65B0\u589E\u5931\u8D25"),oe.next=19;break;case 15:return oe.next=17,Fa(b==null?void 0:b.id,Q);case 17:ye=oe.sent,ye!=null&&ye.id?E.ZP.success("\u7F16\u8F91\u6210\u529F"):E.ZP.error("\u7F16\u8F91\u5931\u8D25");case 19:return oe.next=21,ge();case 21:case"end":return oe.stop()}},w)}));function U(w,re,b){return P.apply(this,arguments)}return U}(),onDelete:function(){var P=(0,Z.Z)((0,u.Z)().mark(function w(re,b){return(0,u.Z)().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.prev=0,O.next=3,xa(b);case 3:E.ZP.success("\u5220\u9664\u6210\u529F"),O.next=9;break;case 6:O.prev=6,O.t0=O.catch(0),E.ZP.error("\u5220\u9664\u5931\u8D25");case 9:case"end":return O.stop()}},w,null,[[0,6]])}));function U(w,re){return P.apply(this,arguments)}return U}()}})}),(0,a.jsxs)(We.Z,{title:"\u6BB5\u843D\u6392\u7248",style:{marginTop:5},children:[(0,a.jsx)(le.Z,{defaultActiveKey:he,items:h==null||(s=h.typeset_data)===null||s===void 0?void 0:s.map(function(P,U){return{label:"".concat(P==null?void 0:P.title,"(").concat(P==null?void 0:P.c_type,")"),key:P==null?void 0:P.id}}),onChange:function(U){te(U)}}),(h==null||(i=h.paragraphs)===null||i===void 0?void 0:i.length)>0?(0,a.jsx)(ut,{selectTypeset:he,chapterParaData:h,layoutOriginData:_,layoutOptionsData:v,updateChapterParaDataFunc:ge}):(0,a.jsx)(Ga.ZP,{status:"warning",subTitle:"\u8BF7\u6DFB\u52A0\u6BB5\u843D\u540E\u8FDB\u884C\u6392\u7248"})]}),X&&(0,a.jsx)(Na,{showModal:X,setShowModal:A,chapterParaData:h,updateChapterParaDataFunc:ge}),Oe&&(0,a.jsx)(Ya,{showModal:Oe,setShowModal:pe,chapterData:h==null?void 0:h.chapter,refreshMenu:y,updateChapterParaDataFunc:ge}),ue&&(0,a.jsx)(dt,{showTypesetModal:ue,setShowTypesetModal:ce,chapterParaData:h,updateChapterParaDataFunc:ge})]})},pt=ct,ht=l(25049),Ot=l(62999),vt=l(54680),ft=l(88611),mt=l(90672),gt=function(e){var d=(0,m.useState)(!1),r=(0,k.Z)(d,2),t=r[0],s=r[1],i=e.setShowMenuModal,n=e.showMenuModal,K=e.setEditMenu,o=e.editMenu,f=e.picBookId,v=e.layoutOptionsData,_=e.layoutOriginData,g=e.refreshMenu,C=(0,m.useState)((0,Z.Z)((0,u.Z)().mark(function z(){var T,x,R;return(0,u.Z)().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,ne({id:f});case 2:T=p.sent,x=T==null?void 0:T.map(function(X,A){return"children"in X&&delete X.children,X.value=X.key,X}),R=Object.assign([],x),R.unshift({key:"0-0",title:"\u65E0\u7236\u5206\u7EC4",value:"0-0"}),F(R);case 7:case"end":return p.stop()}},z)}))),y=(0,k.Z)(C,2),B=y[0],F=y[1];return(0,m.useEffect)((0,Z.Z)((0,u.Z)().mark(function z(){var T;return(0,u.Z)().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(!(o!=null&&o.key)){R.next=9;break}return s(!0),R.next=4,Ma({id:o==null?void 0:o.key});case 4:T=R.sent,o.text_template=T==null?void 0:T.text_template,s(!1),R.next=10;break;case 9:s(!1);case 10:case"end":return R.stop()}},z)})),[o==null?void 0:o.key]),!t&&(0,a.jsxs)(Ve.Y,{title:(o==null?void 0:o.title)==null?"\u65B0\u5EFA\u7AE0\u8282":"\u4FEE\u6539\u7AE0\u8282",width:"600px",layout:"horizontal",visible:n,onVisibleChange:i,onFinish:function(){var z=(0,Z.Z)((0,u.Z)().mark(function T(x){var R,V,p;return(0,u.Z)().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:if((o==null?void 0:o.title)!=null){A.next=7;break}return V={pic_book:f,title:x==null?void 0:x.title,text_template:x==null?void 0:x.text_template,parent:typeof(x==null?void 0:x.parent)=="number"?x==null?void 0:x.parent:null},A.next=4,ee(V);case 4:p=A.sent,A.next=11;break;case 7:return V={id:o==null?void 0:o.key,title:x==null?void 0:x.title,text_template:x==null?void 0:x.text_template,parent:typeof(x==null?void 0:x.parent)=="number"?x==null?void 0:x.parent:null},A.next=10,ka(V);case 10:p=A.sent;case 11:if(!((R=p)!==null&&R!==void 0&&R.id)){A.next=17;break}return i(!1),A.next=15,g();case 15:A.next=18;break;case 17:E.ZP.error("\u5904\u7406\u5931\u8D25");case 18:case"end":return A.stop()}},T)}));return function(T){return z.apply(this,arguments)}}(),modalProps:{closable:!1},children:[(0,a.jsx)(Ye.Z,{width:"md",name:"title",label:"\u7AE0\u8282\u540D\u79F0",labelCol:{span:4},initialValue:(o==null?void 0:o.title)||"",rules:[{required:!0}]}),(0,a.jsx)(mt.Z,{width:"md",name:"text_template",label:"\u6587\u6848\u6A21\u677F",labelCol:{span:4},initialValue:(o==null?void 0:o.text_template)||"",rules:[{required:!0}]}),(0,a.jsx)(ft.A.Item,{label:"\u7236\u7AE0\u8282",name:"parent",labelCol:{span:4},initialValue:(o==null?void 0:o.parent)||"0-0",rules:[{required:!0}],children:(0,a.jsx)(vt.Z,{showSearch:!0,style:{width:330},treeNodeFilterProp:"title",treeData:Object.keys(B).length>0?B:[]})})]})},yt=gt,Zt=function(e){var d,r,t,s=e==null||(d=e.location)===null||d===void 0?void 0:d.query,i=s.id,n=(0,m.useState)({}),K=(0,k.Z)(n,2),o=K[0],f=K[1],v=(0,m.useState)(!1),_=(0,k.Z)(v,2),g=_[0],C=_[1],y=(0,m.useState)(!1),B=(0,k.Z)(y,2),F=B[0],z=B[1],T=(0,m.useState)({}),x=(0,k.Z)(T,2),R=x[0],V=x[1],p=(0,m.useState)(!1),X=(0,k.Z)(p,2),A=X[0],ae=X[1],we=(0,m.useState)([]),ue=(0,k.Z)(we,2),ce=ue[0],Te=ue[1],Ce=(0,m.useState)({}),Oe=(0,k.Z)(Ce,2),pe=Oe[0],Re=Oe[1],Ee=(0,m.useState)((0,Z.Z)((0,u.Z)().mark(function h(){var Y;return(0,u.Z)().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.next=2,(0,ht.Nk)({});case 2:Y=D.sent,me(Y);case 4:case"end":return D.stop()}},h)}))),Me=(0,k.Z)(Ee,2),H=Me[0],me=Me[1],be=function(){var h=(0,Z.Z)((0,u.Z)().mark(function Y(){var G,D;return(0,u.Z)().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return ae(!0),te.next=3,ne({id:i});case 3:G=te.sent,D=(0,je.rC)(G),Re(D),Te(G),ae(!1);case 8:case"end":return te.stop()}},Y)}));return function(){return h.apply(this,arguments)}}();return(0,m.useEffect)((0,Z.Z)((0,u.Z)().mark(function h(){var Y;return(0,u.Z)().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(!i){D.next=9;break}return D.next=3,be();case 3:return ae(!0),D.next=6,(0,de.Cy)({id:i});case 6:Y=D.sent,f(Y),ae(!1);case 9:case"end":return D.stop()}},h)})),[i]),(0,a.jsxs)(fe._z,{title:!1,pageHeaderRender:!1,children:[(0,a.jsx)("div",{style:{width:g?40:260,position:"fixed",top:"68px",bottom:0,background:"#ffffff"},children:(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[(0,a.jsx)(le.Z,{defaultActiveKey:"default",style:{flex:1,overflow:"scroll",margin:"0 8px"},tabBarExtraContent:{right:(0,a.jsx)("a",{onClick:function(){V({}),z(!0)},children:"\u6DFB\u52A0"})},children:(0,a.jsx)(Be.Z,{tab:"\u76EE\u5F55",style:{color:"black"},children:A?(0,a.jsx)(Se.Z,{spinning:!0,children:"\u76EE\u5F55\u52A0\u8F7D\u4E2D"}):Object.keys(ce).length>0?(0,a.jsx)(Fe.Z,{showLine:!0,defaultExpandAll:!0,onSelect:function(Y,G){var D,he,te;Re({chapter_id:G==null||(D=G.node)===null||D===void 0?void 0:D.id,chapter_title:G==null||(he=G.node)===null||he===void 0?void 0:he.title,parent:G==null||(te=G.node)===null||te===void 0?void 0:te.parent})},defaultSelectedKeys:[pe==null?void 0:pe.chapter_id],draggable:{icon:!1},onDrop:function(){var h=(0,Z.Z)((0,u.Z)().mark(function Y(G){var D,he,te,ge;return(0,u.Z)().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(D=(0,je.FC)(G),D!=null&&D.canDrag){P.next=8;break}if(!(D!=null&&D.errMsg)){P.next=7;break}return E.ZP.error(D==null?void 0:D.errMsg),P.abrupt("return");case 7:return P.abrupt("return");case 8:return he=(0,je.EF)(G,ce),te=(0,je.W8)(G,he),ae(!0),P.next=13,Oa(te);case 13:if(ge=P.sent,!(ge.length>0)){P.next=18;break}return E.ZP.success("\u4FEE\u6539\u6210\u529F"),P.next=18,be();case 18:ae(!1);case 19:case"end":return P.stop()}},Y)}));return function(Y){return h.apply(this,arguments)}}(),treeData:ce}):"\u6682\u65E0\u6570\u636E"},"default")}),(0,a.jsx)("div",{style:{height:"39px",justifyContent:"center",alignItems:"center",display:"flex"},onClick:function(Y){C(!g)},children:g?(0,a.jsx)(N.Z,{title:"\u5C55\u5F00",placement:"right",children:(0,a.jsx)(q.Z,{})}):(0,a.jsxs)("span",{children:[(0,a.jsx)(Ze.Z,{style:{marginRight:5}}),"\u6536\u8D77"]})})]})}),(0,a.jsx)("div",{style:{marginLeft:g?50:270},children:(pe==null?void 0:pe.chapter_id)&&(0,a.jsx)(pt,{picBookId:i,selectChapter:pe,setSelectChapter:Re,configData:o,layoutOriginData:H||[],refreshMenu:be,layoutOptionsData:(0,je.V1)(((r=Object.keys(H))===null||r===void 0?void 0:r.length)>0?H:[]),setLayoutOriginData:me})}),F&&(0,a.jsx)(yt,{setShowMenuModal:z,showMenuModal:F,setEditMenu:V,editMenu:R,picBookId:i,layoutOriginData:H||[],layoutOptionsData:(0,je.V1)(((t=Object.keys(H))===null||t===void 0?void 0:t.length)>0?H:[]),refreshMenu:be})]})},wt=Zt},25049:function(wa,Le,l){"use strict";l.d(Le,{Nk:function(){return ke},fc:function(){return Ne},Lk:function(){return Je}});var Pe=l(39428),N=l(11849),se=l(3182),le=l(78370);function ke(k,m){return Se.apply(this,arguments)}function Se(){return Se=(0,se.Z)((0,Pe.Z)().mark(function k(m,fe){return(0,Pe.Z)().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:return q.abrupt("return",(0,le.Z)("/api/pic_book/layout/",(0,N.Z)({method:"GET",params:(0,N.Z)({},m)},fe||{})));case 1:case"end":return q.stop()}},k)})),Se.apply(this,arguments)}function Ne(k,m,fe){return Fe.apply(this,arguments)}function Fe(){return Fe=(0,se.Z)((0,Pe.Z)().mark(function k(m,fe,de){return(0,Pe.Z)().wrap(function(Ze){for(;;)switch(Ze.prev=Ze.next){case 0:return Ze.abrupt("return",(0,le.Z)("/api/pic_book/layout/".concat(m,"/"),(0,N.Z)({method:"PATCH",data:fe},de||{})));case 1:case"end":return Ze.stop()}},k)})),Fe.apply(this,arguments)}function Je(k,m){return E.apply(this,arguments)}function E(){return E=(0,se.Z)((0,Pe.Z)().mark(function k(m,fe){return(0,Pe.Z)().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:return q.abrupt("return",(0,le.Z)("/api/pic_book/layout/",(0,N.Z)({method:"POST",data:m},fe||{})));case 1:case"end":return q.stop()}},k)})),E.apply(this,arguments)}function u(k,m){return Z.apply(this,arguments)}function Z(){return Z=_asyncToGenerator(_regeneratorRuntime().mark(function k(m,fe){var de,q;return _regeneratorRuntime().wrap(function(Be){for(;;)switch(Be.prev=Be.next){case 0:return de=m.id,q=de===void 0?0:de,Be.abrupt("return",request("/api/pic_book/layout/".concat(q),_objectSpread({method:"DELETE"},fe||{})));case 2:case"end":return Be.stop()}},k)})),Z.apply(this,arguments)}},61870:function(wa,Le,l){"use strict";l.d(Le,{lQ:function(){return Je},Cy:function(){return u},e:function(){return k},zk:function(){return fe},Zz:function(){return q},Y6:function(){return xe},Dh:function(){return Qe}});var Pe=l(93224),N=l(39428),se=l(11849),le=l(3182),ke=l(78370),Se=["id"],Ne=["id"],Fe=null;function Je(M,S){return E.apply(this,arguments)}function E(){return E=(0,le.Z)((0,N.Z)().mark(function M(S,W){return(0,N.Z)().wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.abrupt("return",(0,ke.Z)("/api/pic_book/book/",(0,se.Z)({method:"GET",data:(0,se.Z)({},S)},W||{})));case 1:case"end":return $.stop()}},M)})),E.apply(this,arguments)}function u(M,S){return Z.apply(this,arguments)}function Z(){return Z=(0,le.Z)((0,N.Z)().mark(function M(S,W){var j,$,ne;return(0,N.Z)().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return j=S.id,$=j===void 0?0:j,ne=(0,Pe.Z)(S,Se),ee.abrupt("return",(0,ke.Z)("/api/pic_book/book/".concat($,"/"),(0,se.Z)({method:"GET"},W||{})));case 2:case"end":return ee.stop()}},M)})),Z.apply(this,arguments)}function k(M,S){return m.apply(this,arguments)}function m(){return m=(0,le.Z)((0,N.Z)().mark(function M(S,W){var j,$,ne;return(0,N.Z)().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return j=S.id,$=j===void 0?0:j,ne=(0,Pe.Z)(S,Ne),ee.abrupt("return",(0,ke.Z)("/api/pic_book/book/".concat($,"/preview/"),(0,se.Z)({method:"GET"},W||{})));case 2:case"end":return ee.stop()}},M)})),m.apply(this,arguments)}function fe(M,S,W){return de.apply(this,arguments)}function de(){return de=(0,le.Z)((0,N.Z)().mark(function M(S,W,j){return(0,N.Z)().wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:return ne.abrupt("return",(0,ke.Z)("/api/pic_book/book/".concat(S,"/"),(0,se.Z)({method:"PATCH",data:W},j||{})));case 1:case"end":return ne.stop()}},M)})),de.apply(this,arguments)}function q(M,S){return Ze.apply(this,arguments)}function Ze(){return Ze=(0,le.Z)((0,N.Z)().mark(function M(S,W){return(0,N.Z)().wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.abrupt("return",(0,ke.Z)("/api/pic_book/book/",(0,se.Z)({method:"POST",data:S},W||{})));case 1:case"end":return $.stop()}},M)})),Ze.apply(this,arguments)}function Be(M,S){return I.apply(this,arguments)}function I(){return I=_asyncToGenerator(_regeneratorRuntime().mark(function M(S,W){var j,$;return _regeneratorRuntime().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return j=S.id,$=j===void 0?0:j,ie.abrupt("return",request("/api/pic_book/book/".concat($),_objectSpread({method:"DELETE"},W||{})));case 2:case"end":return ie.stop()}},M)})),I.apply(this,arguments)}function xe(M){return J.apply(this,arguments)}function J(){return J=(0,le.Z)((0,N.Z)().mark(function M(S){return(0,N.Z)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",(0,ke.Z)("/api/pic_book/voice_template/",(0,se.Z)({method:"GET"},S||{})));case 1:case"end":return j.stop()}},M)})),J.apply(this,arguments)}function Qe(M){return Ge.apply(this,arguments)}function Ge(){return Ge=(0,le.Z)((0,N.Z)().mark(function M(S){return(0,N.Z)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",(0,ke.Z)("/api/pic_book/author/",(0,se.Z)({method:"GET"},S||{})));case 1:case"end":return j.stop()}},M)})),Ge.apply(this,arguments)}function ba(M,S){return Ue.apply(this,arguments)}function Ue(){return Ue=_asyncToGenerator(_regeneratorRuntime().mark(function M(S,W){var j,$,ne;return _regeneratorRuntime().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return j=S.id,$=j===void 0?0:j,ne=_objectWithoutProperties(S,Fe),ee.abrupt("return",request("/api/pic_book/chapter/".concat($,"/"),_objectSpread({method:"PATCH",data:ne},W||{})));case 2:case"end":return ee.stop()}},M)})),Ue.apply(this,arguments)}function _a(M,S){return Ke.apply(this,arguments)}function Ke(){return Ke=_asyncToGenerator(_regeneratorRuntime().mark(function M(S,W){return _regeneratorRuntime().wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.abrupt("return",request("/api/pic_book/chapter/",_objectSpread({method:"POST",data:_objectSpread({},S)},W||{})));case 1:case"end":return $.stop()}},M)})),Ke.apply(this,arguments)}function Pa(M,S){return ze.apply(this,arguments)}function ze(){return ze=_asyncToGenerator(_regeneratorRuntime().mark(function M(S,W){var j,$;return _regeneratorRuntime().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return j=S.id,$=j===void 0?0:j,ie.abrupt("return",request("/api/pic_book/chapter/".concat($,"/"),_objectSpread({method:"DELETE"},W||{})).catch(function(ee){return{}}));case 2:case"end":return ie.stop()}},M)})),ze.apply(this,arguments)}}}]);
