(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[217],{88032:function(Ie,ge,r){"use strict";var F=r(39428),$=r(3182),ue=r(67294),Y=r(37476),K=r(5966),te=r(90672),ye=r(64317),ne=r(24739),ve=r(25049),he=r(94544),Ee=r(15643),S=r(85893),ae=function(d){var l=d.record,a=d.setShowModal,u=d.showModal,o=d.actionRef,v=d.updatePageDetailsFunc;l!=null&&l.background_img&&(l.background_img=[{url:l==null?void 0:l.background_img}]);var M=l.id?l:{c_type:"protected",grid_row_col:"[[24]]",grid_gutter:"[16, 24]",font_color:"#0000E0",font_family:"Arial",font_size:14,background_color:"#FFFFFF",text_flex_justify:"flex-end",text_flex_align:"flex-end",text_opacity:1};return(0,S.jsxs)(Y.Y,{title:l!=null&&l.id?"\u7F16\u8F91\u9875\u9762\u6A21\u677F:".concat(l==null?void 0:l.id):"\u65B0\u5EFA\u9875\u9762\u6A21\u677F",width:"750px",layout:"horizontal",visible:u,initialValues:M,onVisibleChange:a,onFinish:function(){var L=(0,$.Z)((0,F.Z)().mark(function I(Ze){var G,b;return(0,F.Z)().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(G=new FormData,Object.keys(Ze).forEach(function(j){j==="background_img"?Ze[j][0].originFileObj&&G.append(j,Ze[j][0].originFileObj):G.append(j,Ze[j])}),!(l!=null&&l.id)){y.next=9;break}return G.append("id",l==null?void 0:l.id),y.next=6,(0,ve.fc)(l==null?void 0:l.id,G);case 6:b=y.sent,y.next=12;break;case 9:return y.next=11,(0,ve.Lk)(G);case 11:b=y.sent;case 12:if(!b){y.next=20;break}if(a(!1),!v){y.next=19;break}return y.next=17,v();case 17:y.next=20;break;case 19:o.current&&o.current.reload();case 20:case"end":return y.stop()}},I)}));return function(I){return L.apply(this,arguments)}}(),children:[(0,S.jsx)(K.Z,{rules:[{required:!0}],label:"\u6807\u9898",name:"title"}),(0,S.jsx)(te.Z,{rules:[{required:!0}],label:"\u63CF\u8FF0",name:"description"}),(0,S.jsx)(ye.Z,{rules:[{required:!0}],label:"\u7C7B\u578B",name:"c_type",options:[{label:"\u5B8C\u5168\u516C\u5F00",value:"public"},{label:"\u5185\u90E8\u4F7F\u7528",value:"protected"},{label:"\u79C1\u6709",value:"private"}]}),(0,S.jsxs)(ne.UW,{children:[(0,S.jsx)(K.Z,{rules:[{required:!0}],label:"\u6805\u683C\u5E03\u5C40",name:"grid_row_col"}),(0,S.jsx)(K.Z,{rules:[{required:!0}],label:"\u6805\u683C\u95F4\u8DDD",name:"grid_gutter"})]}),(0,S.jsxs)(ne.UW,{children:[(0,S.jsx)(he.Z,{label:"\u5B57\u4F53\u989C\u8272",rules:[{required:!0}],name:"font_color"}),(0,S.jsx)(K.Z,{rules:[{required:!0}],label:"\u5B57\u4F53",width:150,name:"font_family"}),(0,S.jsx)(K.Z,{rules:[{required:!0}],label:"\u5B57\u4F53\u5927\u5C0F",width:125,name:"font_size"})]}),(0,S.jsxs)(ne.UW,{children:[(0,S.jsx)(Ee.Z,{name:"background_img",label:"\u80CC\u666F\u56FE",max:1,fieldProps:{data:{},defaultFileList:[],multiple:!1,listType:"picture-card",accept:".png,.jpg,.jpeg",maxCount:1},extra:"\u652F\u6301 JPG\u3001PNG \u683C\u5F0F"}),(0,S.jsx)(he.Z,{label:"\u80CC\u666F\u989C\u8272",rules:[{required:!0}],name:"background_color"})]}),(0,S.jsxs)(ne.UW,{children:[(0,S.jsx)(ye.Z,{rules:[{required:!0}],label:"\u6587\u672C\u4E3B\u8F74\u4F4D\u7F6E",name:"text_flex_justify",fieldProps:{dropdownMatchSelectWidth:!1},options:[{label:"flex-start",value:"flex-start"},{label:"center",value:"center"},{label:"flex-end",value:"flex-end"},{label:"space-between",value:"space-between"},{label:"space-around",value:"space-around"},{label:"space-evenly",value:"space-evenly"}]}),(0,S.jsx)(ye.Z,{rules:[{required:!0}],label:"\u6587\u672C\u4EA4\u53C9\u8F74\u4F4D\u7F6E",name:"text_flex_align",fieldProps:{dropdownMatchSelectWidth:!1},options:[{label:"flex-start",value:"flex-start"},{label:"center",value:"center"},{label:"flex-end",value:"flex-end"}]}),(0,S.jsx)(K.Z,{rules:[{required:!0}],label:"\u6587\u672C\u900F\u660E\u5EA6",name:"text_opacity",width:80})]})]})};ge.Z=ae},83924:function(Ie,ge,r){"use strict";r.r(ge),r.d(ge,{default:function(){return kr}});var F=r(22385),$=r(45777),ue=r(18106),Y=r(63885),K=r(20228),te=r(11382),ye=r(32157),ne=r(3974),ve=r(59250),he=r(13013),Ee=r(62350),S=r(24565),ae=r(30887),B=r(18515),d=r(34792),l=r(48086),a=r(39428),u=r(3182),o=r(2824),v=r(67294),M=r(87720),L=r(61870),I=r(8212),Ze=r(1351),G=r(76629),b=r(42698),h=r(11849),y=r(93224),j=r(78370),x=["id"],Pe=["id"],Te=["id"],Me=["id"],Ra=["id"],Ia=["id"],Aa=null,Ua=null,Wa=["id"];function Va(p,n){return ea.apply(this,arguments)}function ea(){return ea=(0,u.Z)((0,a.Z)().mark(function p(n,f){var s,t,i;return(0,a.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return s=n.id,t=s===void 0?0:s,i=(0,y.Z)(n,x),c.abrupt("return",(0,j.Z)("/api/pic_book/book/".concat(t,"/chapter_page_menu/"),(0,h.Z)({method:"GET"},f||{})));case 2:case"end":return c.stop()}},p)})),ea.apply(this,arguments)}function Ka(p,n){return aa.apply(this,arguments)}function aa(){return aa=(0,u.Z)((0,a.Z)().mark(function p(n,f){var s,t,i;return(0,a.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return s=n.id,t=s===void 0?0:s,i=(0,y.Z)(n,Pe),c.abrupt("return",(0,j.Z)("/api/pic_book/book/".concat(t,"/chapter_menu/"),(0,h.Z)({method:"GET"},f||{})));case 2:case"end":return c.stop()}},p)})),aa.apply(this,arguments)}function Ga(p,n){return ra.apply(this,arguments)}function ra(){return ra=(0,u.Z)((0,a.Z)().mark(function p(n,f){return(0,a.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,j.Z)("/api/pic_book/chapter/",(0,h.Z)({method:"POST",data:(0,h.Z)({},n)},f||{})));case 1:case"end":return t.stop()}},p)})),ra.apply(this,arguments)}function Na(p,n){return ta.apply(this,arguments)}function ta(){return ta=(0,u.Z)((0,a.Z)().mark(function p(n,f){var s,t,i;return(0,a.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return s=n.id,t=s===void 0?0:s,i=(0,y.Z)(n,Te),c.abrupt("return",(0,j.Z)("/api/pic_book/chapter/".concat(t,"/"),(0,h.Z)({method:"GET",params:i},f||{})));case 2:case"end":return c.stop()}},p)})),ta.apply(this,arguments)}function Za(p,n){return na.apply(this,arguments)}function na(){return na=(0,u.Z)((0,a.Z)().mark(function p(n,f){var s,t,i;return(0,a.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return s=n.id,t=s===void 0?0:s,i=(0,y.Z)(n,Me),c.abrupt("return",(0,j.Z)("/api/pic_book/chapter/".concat(t,"/"),(0,h.Z)({method:"PATCH",data:i},f||{})));case 2:case"end":return c.stop()}},p)})),na.apply(this,arguments)}function za(p,n){return la.apply(this,arguments)}function la(){return la=(0,u.Z)((0,a.Z)().mark(function p(n,f){var s,t;return(0,a.Z)().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return s=n.id,t=s===void 0?0:s,P.abrupt("return",(0,j.Z)("/api/pic_book/chapter/".concat(t,"/"),(0,h.Z)({method:"DELETE"},f||{})).catch(function(c){return{}}));case 2:case"end":return P.stop()}},p)})),la.apply(this,arguments)}function Ha(p,n){return ia.apply(this,arguments)}function ia(){return ia=(0,u.Z)((0,a.Z)().mark(function p(n,f){var s,t,i;return(0,a.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return s=n.id,t=s===void 0?0:s,i=(0,y.Z)(n,Ra),c.abrupt("return",(0,j.Z)("/api/pic_book/book_page/".concat(t,"/"),(0,h.Z)({method:"GET",params:i},f||{})));case 2:case"end":return c.stop()}},p)})),ia.apply(this,arguments)}function Ja(p,n){return ua.apply(this,arguments)}function ua(){return ua=(0,u.Z)((0,a.Z)().mark(function p(n,f){var s,t,i;return(0,a.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return s=n.id,t=s===void 0?0:s,i=(0,y.Z)(n,Ia),c.abrupt("return",(0,j.Z)("/api/pic_book/book_page/".concat(t,"/chapter_paragraph/"),(0,h.Z)({method:"GET",params:i},f||{})));case 2:case"end":return c.stop()}},p)})),ua.apply(this,arguments)}function Lr(p,n){return oa.apply(this,arguments)}function oa(){return oa=_asyncToGenerator(_regeneratorRuntime().mark(function p(n,f){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/api/pic_book/book_page/",_objectSpread({method:"POST",data:_objectSpread({},n)},f||{})));case 1:case"end":return t.stop()}},p)})),oa.apply(this,arguments)}function Ya(p,n){return sa.apply(this,arguments)}function sa(){return sa=(0,u.Z)((0,a.Z)().mark(function p(n,f){var s,t;return(0,a.Z)().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return s=n.id,t=s===void 0?0:s,P.abrupt("return",(0,j.Z)("/api/pic_book/book_page/".concat(t,"/"),(0,h.Z)({method:"DELETE"},f||{})).catch(function(c){return{}}));case 2:case"end":return P.stop()}},p)})),sa.apply(this,arguments)}function Rr(p,n){return da.apply(this,arguments)}function da(){return da=_asyncToGenerator(_regeneratorRuntime().mark(function p(n,f){var s,t,i;return _regeneratorRuntime().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return s=n.id,t=s===void 0?0:s,i=_objectWithoutProperties(n,Aa),c.abrupt("return",request("/api/pic_book/book_page/".concat(t,"/"),_objectSpread({method:"PATCH",data:i},f||{})));case 2:case"end":return c.stop()}},p)})),da.apply(this,arguments)}function Ir(p,n){return ca.apply(this,arguments)}function ca(){return ca=_asyncToGenerator(_regeneratorRuntime().mark(function p(n,f){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/api/pic_book/paragraph/",_objectSpread({method:"GET",params:_objectSpread({},n)},f||{})));case 1:case"end":return t.stop()}},p)})),ca.apply(this,arguments)}function Ar(p,n){return pa.apply(this,arguments)}function pa(){return pa=_asyncToGenerator(_regeneratorRuntime().mark(function p(n,f){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/api/pic_book/paragraph/",_objectSpread({method:"POST",data:_objectSpread({},n)},f||{})));case 1:case"end":return t.stop()}},p)})),pa.apply(this,arguments)}function Ur(p,n){return va.apply(this,arguments)}function va(){return va=_asyncToGenerator(_regeneratorRuntime().mark(function p(n,f){var s,t,i;return _regeneratorRuntime().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return s=n.id,t=s===void 0?0:s,i=_objectWithoutProperties(n,Ua),c.abrupt("return",request("/api/pic_book/paragraph/".concat(t,"/"),_objectSpread({method:"PATCH",data:i},f||{})));case 2:case"end":return c.stop()}},p)})),va.apply(this,arguments)}function Wr(p,n){return ha.apply(this,arguments)}function ha(){return ha=_asyncToGenerator(_regeneratorRuntime().mark(function p(n,f){var s,t;return _regeneratorRuntime().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return s=n.id,t=s===void 0?0:s,P.abrupt("return",request("/api/pic_book/paragraph/".concat(t,"/"),_objectSpread({method:"DELETE"},f||{})).catch(function(c){return{}}));case 2:case"end":return P.stop()}},p)})),ha.apply(this,arguments)}function Qa(p,n){return fa.apply(this,arguments)}function fa(){return fa=(0,u.Z)((0,a.Z)().mark(function p(n,f){var s,t,i;return(0,a.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return s=n.id,t=s===void 0?0:s,i=(0,y.Z)(n,Wa),c.abrupt("return",(0,j.Z)("/api/pic_book/paragraph/set_seq/",(0,h.Z)({method:"POST",data:i},f||{})));case 2:case"end":return c.stop()}},p)})),fa.apply(this,arguments)}function Xa(p,n){return _a.apply(this,arguments)}function _a(){return _a=(0,u.Z)((0,a.Z)().mark(function p(n,f){return(0,a.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,j.Z)("/api/pic_book/book/sort_menu/",(0,h.Z)({method:"POST",data:(0,h.Z)({},n)},f||{})));case 1:case"end":return t.stop()}},p)})),_a.apply(this,arguments)}var Vr=r(13062),ba=r(71230),Kr=r(89032),ma=r(15746),Gr=r(49111),ze=r(19650),qa=r(32059),Nr=r(12968),xa=r(20352),be=r(952),er=r(60451),ga=r(24739),He=r(27510),ar=r(5314),wa=r(86028),We=r(27408),rr=r(92305),tr=r(42762),e=r(85893),nr=function(n){var f=(0,v.useRef)(),s=n.showModal,t=n.setShowModal,i=n.page_id,P=n.chapterParaData,c=n.updateChapterParaDataFunc,se=[{title:"\u6392\u5E8F",dataIndex:"seq",render:function(U,le,oe){return(0,e.jsxs)("span",{className:"customRender",children:[" ",le==null?void 0:le.seq]})}},{title:"ID",dataIndex:"id"},{title:"\u5185\u5BB9",dataIndex:"para_content"},{title:"\u77E5\u8BC6\u70B9",dataIndex:"knowledge"}],fe=function(){var N=(0,u.Z)((0,a.Z)().mark(function U(le,oe,D){var X;return(0,a.Z)().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return X=D==null?void 0:D.map(function(w,A){return w==null?void 0:w.id}),W.next=3,Qa({seq_list:X});case 3:return W.next=5,c();case 5:case"end":return W.stop()}},U)}));return function(le,oe,D){return N.apply(this,arguments)}}(),g=function(U,le){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(tr.Z,{style:{cursor:"grab",color:"gold"}})})};return(0,e.jsx)(We.Y,{title:"\u8C03\u6574\u6BB5\u843D\u5185\u5BB9\u987A\u5E8F",width:"600px",layout:"horizontal",visible:s,onVisibleChange:t,onFinish:function(){var N=(0,u.Z)((0,a.Z)().mark(function U(le){return(0,a.Z)().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:t(!1);case 1:case"end":return D.stop()}},U)}));return function(U){return N.apply(this,arguments)}}(),modalProps:{closable:!1},submitter:{render:function(U,le){return(0,e.jsxs)("div",{children:[le[1]," "]})}},children:(0,e.jsx)(rr.Z,{actionRef:f,columns:se,rowKey:"id",size:"small",search:!1,options:{density:!1},toolBarRender:!1,pagination:!1,dataSource:P==null?void 0:P.paragraph,dragSortKey:"seq",onDragSortEnd:fe,dragSortHandlerRender:g})})},lr=nr,ir=r(82061),Pa=r(47745),ur=function(n){var f=n.showModal,s=n.setShowModal,t=n.chapterData,i=n.updateChapterParaDataFunc;return(0,e.jsx)(We.Y,{title:"\u7F16\u8F91\u7AE0\u8282\u6A21\u677F",width:"500px",layout:"horizontal",visible:f,onVisibleChange:s,initialValues:t,onFinish:function(){var P=(0,u.Z)((0,a.Z)().mark(function c(se){var fe,g;return(0,a.Z)().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return fe={id:t==null?void 0:t.id,text_template:se==null?void 0:se.text_template},U.next=3,Za(fe);case 3:if(g=U.sent,!g){U.next=8;break}return l.ZP.success("\u66F4\u65B0\u7AE0\u8282\u6A21\u677F\u6210\u529F"),U.next=8,i();case 8:s(!1);case 9:case"end":return U.stop()}},c)}));return function(c){return P.apply(this,arguments)}}(),children:(0,e.jsx)(Pa.Z,{name:"text_template",label:"\u6A21\u677F"})})},or=ur,Je=r(87766),sr=function(n){var f,s=(0,v.useRef)(null),t=n.chapterParaData,i=n.page_layout,P=(0,v.useState)(!1),c=(0,o.Z)(P,2),se=c[0],fe=c[1],g=(0,v.useState)({}),N=(0,o.Z)(g,2),U=N[0],le=N[1];return(0,v.useEffect)(function(){var oe=function(){var D=(0,u.Z)((0,a.Z)().mark(function X(){var J,W,w,A;return(0,a.Z)().wrap(function(je){for(;;)switch(je.prev=je.next){case 0:return fe(!0),W={pic_book:t==null||(J=t.paragraph)===null||J===void 0?void 0:J.pic_book},je.next=4,(0,Je.BT)(W);case 4:w=je.sent,A=w.reduce(function(k,R){return k[R.para_content_uniq]=R==null?void 0:R.voice_file,k},{}),le(A),fe(!1);case 8:case"end":return je.stop()}},X)}));return function(){return D.apply(this,arguments)}}();oe()},[t==null?void 0:t.id]),!se&&(0,e.jsx)("div",{style:{width:"414px",height:"896px",border:"1px dashed gray",backgroundImage:"url(".concat(i==null?void 0:i.background_img,")"),backgroundColor:i==null?void 0:i.background_color},children:(0,e.jsx)(ba.Z,{gutter:i==null?void 0:i.grid_gutter,align:"stretch",style:{height:"100%"},children:(f=JSON.parse(i==null?void 0:i.grid_row_col))===null||f===void 0?void 0:f.map(function(oe,D){var X,J,W=(t==null||(X=t.paragraph)===null||X===void 0?void 0:X[D])||{},w="",A="",z=(i==null?void 0:i.font_size)||14;return((J=JSON.parse(i==null?void 0:i.grid_row_col))===null||J===void 0?void 0:J.length)==1?(w="50%",A="50%",z=z*2):(w="92%",A="8%"),(0,e.jsxs)(ma.Z,{span:oe,children:[(0,e.jsx)("div",{style:{fontFamily:(i==null?void 0:i.font_family)||"Arial",fontSize:(i==null?void 0:i.font_size)||14,color:(i==null?void 0:i.font_color)||"black",backgroundImage:"url(".concat(W==null?void 0:W.illustration,")"),backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center",opacity:(i==null?void 0:i.text_opacity)||1,height:w,display:"flex",flexDirection:"column",alignItems:(i==null?void 0:i.text_flex_align)||"center",justifyContent:(i==null?void 0:i.text_flex_justify)||"center"}}),(0,e.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",fontFamily:(i==null?void 0:i.font_family)||"Arial",fontSize:z,color:(i==null?void 0:i.font_color)||"black",height:A},children:W==null?void 0:W.para_content})]})})})})},dr=sr,cr=function(n){var f=n.showPreviewModal,s=n.setShowPreviewModal,t=n.chapterParaData,i=n.page_layout;return(0,e.jsx)(We.Y,{title:(0,e.jsxs)("div",{children:["\u9875\u9762\u9884\u89C8:",(0,e.jsx)("span",{style:{fontSize:14},children:i==null?void 0:i.title})]}),width:"462px",style:{padding:0},layout:"horizontal",visible:f,onVisibleChange:s,submitter:!1,children:(0,e.jsx)(dr,{chapterParaData:t,page_layout:i})})},pr=cr,vr=r(88032),ja=r(25049),zr=r(57663),hr=r(71577),fr=r(15643),_r=function(n){var f=n.showModal,s=n.setShowModal,t=n.record,i=(0,v.useState)(!1),P=(0,o.Z)(i,2),c=P[0],se=P[1],fe=(0,v.useState)(!1),g=(0,o.Z)(fe,2),N=g[0],U=g[1],le=(0,v.useState)({}),oe=(0,o.Z)(le,2),D=oe[0],X=oe[1];return(0,v.useEffect)(function(){var J=function(){var W=(0,u.Z)((0,a.Z)().mark(function w(){var A,z;return(0,a.Z)().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return se(!0),A={pic_book:t==null?void 0:t.pic_book,para_content_uniq:t==null?void 0:t.para_content_uniq},k.prev=2,k.next=5,(0,Je.BT)(A);case 5:z=k.sent,X((z==null?void 0:z[0])||{}),k.next=12;break;case 9:k.prev=9,k.t0=k.catch(2),console.error("Error fetching data:",k.t0);case 12:return k.prev=12,se(!1),k.finish(12);case 15:case"end":return k.stop()}},w,null,[[2,9,12,15]])}));return function(){return W.apply(this,arguments)}}();J()},[t==null?void 0:t.id]),(0,e.jsx)(We.Y,{title:"\u7F16\u8F91\u8BED\u97F3",width:"600px",layout:"horizontal",visible:f,onVisibleChange:s,onFinish:function(){var J=(0,u.Z)((0,a.Z)().mark(function W(w){var A,z;return(0,a.Z)().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(A=new FormData,A.append("voice_file",w.voice_file[0].originFileObj),A.append("pic_book",t==null?void 0:t.pic_book),A.append("voice_template","1"),A.append("para_content_uniq",t==null?void 0:t.para_content_uniq),!(D!=null&&D.id)){k.next=12;break}return A.append("id",D==null?void 0:D.id),k.next=9,(0,Je.y0)(D==null?void 0:D.id,A);case 9:z=k.sent,k.next=15;break;case 12:return k.next=14,(0,Je.aU)(A);case 14:z=k.sent;case 15:z&&s(!1);case 16:case"end":return k.stop()}},W)}));return function(W){return J.apply(this,arguments)}}(),modalProps:{closable:!1},children:(0,e.jsx)("div",{children:D!=null&&D.voice_file&&!N?(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,e.jsxs)("audio",{controls:!0,style:{marginRight:"20px"},children:[(0,e.jsx)("source",{src:D==null?void 0:D.voice_file,type:"audio/mpeg"}),"Your browser does not support the audio element."]}),(0,e.jsx)("div",{children:(0,e.jsx)(hr.Z,{type:"primary",onClick:function(){U(!0)},children:"\u66FF\u6362"})})]}):(0,e.jsx)("div",{children:(0,e.jsx)(fr.Z,{name:"voice_file",label:"\u8BED\u97F3\u6587\u4EF6",max:1,fieldProps:{data:{},defaultFileList:[],multiple:!1,listType:"picture-card",accept:".mp3,.wav",maxCount:1},extra:"\u652F\u6301 mp3\u3001wav \u683C\u5F0F"})})})})},mr=_r,gr=function(n){var f,s,t,i,P,c,se,fe,g,N,U,le,oe,D,X,J=(0,v.useRef)(),W=n.picBookId,w=n.selectPage,A=n.setSelectPage,z=n.layoutOptionsData,je=n.layoutOriginData,k=n.setLayoutOriginData,R=n.configData,Z=n.refreshMenu,ce=(0,v.useRef)(),de=(0,v.useState)(!1),Be=(0,o.Z)(de,2),Ye=Be[0],Q=Be[1],Ce=(0,v.useState)(!1),Ae=(0,o.Z)(Ce,2),Qe=Ae[0],Ve=Ae[1],Ma=(0,v.useState)(!1),Xe=(0,o.Z)(Ma,2),qe=Xe[0],Ke=Xe[1],Ue=(0,v.useState)({}),Ge=(0,o.Z)(Ue,2),Le=Ge[0],ke=Ge[1],V=(0,v.useState)(!1),T=(0,o.Z)(V,2),E=T[0],re=T[1],_e=(0,v.useState)(!1),Oe=(0,o.Z)(_e,2),Re=Oe[0],me=Oe[1],Dr=(0,v.useState)({}),Ca=(0,o.Z)(Dr,2),Mr=Ca[0],Jr=Ca[1],Cr=(0,v.useState)(!1),Ea=(0,o.Z)(Cr,2),Sa=Ea[0],Fa=Ea[1],Er=(0,v.useState)({}),Ba=(0,o.Z)(Er,2),Oa=Ba[0],Sr=Ba[1],Fr=(0,v.useState)([]),Ta=(0,o.Z)(Fr,2),pe=Ta[0],Br=Ta[1],Or=(0,v.useState)({}),$a=(0,o.Z)(Or,2),m=$a[0],Tr=$a[1];(0,v.useEffect)((0,u.Z)((0,a.Z)().mark(function ie(){return(0,a.Z)().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(!(w!=null&&w.page_id)){_.next=7;break}return Q(!0),_.next=4,La();case 4:return _.next=6,Ne();case 6:Q(!1);case 7:case"end":return _.stop()}},ie)})),[w==null?void 0:w.page_id]);var La=function(){var ie=(0,u.Z)((0,a.Z)().mark(function q(){var _,H,ee;return(0,a.Z)().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,Ha({id:w==null?void 0:w.page_id});case 2:return _=C.sent,C.next=5,(0,ja.Nk)({});case 5:H=C.sent,k(H),ee=H==null?void 0:H.find(function(O){return O.id==(_==null?void 0:_.layout)}),_.layout_cfg=ee,Tr(_);case 10:case"end":return C.stop()}},q)}));return function(){return ie.apply(this,arguments)}}(),Ne=function(){var ie=(0,u.Z)((0,a.Z)().mark(function q(){var _,H;return(0,a.Z)().wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:return xe.next=2,Ja({id:w==null?void 0:w.page_id});case 2:H=xe.sent,H.paragraph=H==null||(_=H.paragraph)===null||_===void 0?void 0:_.map(function(C,O){return(0,h.Z)((0,h.Z)({},C),{},{illustration_url:[{url:C.illustration}]})}),Br(H);case 5:case"end":return xe.stop()}},q)}));return function(){return ie.apply(this,arguments)}}(),$r=[{title:"\u6392\u5E8F",dataIndex:"seq",width:"8%"},{title:"\u77E5\u8BC6\u70B9",dataIndex:"knowledge",width:"22%",fieldProps:function(q,_){var H=_.rowIndex,ee=_.rowKey;return{onChange:function(C){var O,Fe,De,Se,ya=pe==null||(O=pe.chapter)===null||O===void 0?void 0:O.text_template.replace(/{{word}}/g,C==null||(Fe=C.target)===null||Fe===void 0?void 0:Fe.value);(De=J.current)===null||De===void 0||(Se=De.setRowData)===null||Se===void 0||Se.call(De,ee,{para_content:ya})}}}},{title:"\u5185\u5BB9",dataIndex:"para_content",width:"35%"},{title:"\u63D2\u56FE",dataIndex:"illustration",width:"15%",render:function(q,_){return _!=null&&_.illustration?(0,e.jsx)(xa.Z,{src:_==null?void 0:_.illustration,width:35,height:35}):null},renderFormItem:function(q,_,H){if(q!=null&&q.entry)return(0,e.jsx)(be.ZP,{initialValues:_==null?void 0:_.record,submitter:!1,children:(0,e.jsx)(er.Z,{max:1,name:"illustration_url",fieldProps:{data:{},defaultFileList:[],multiple:!1,accept:".png,.jpg,.jpeg",maxCount:1,customRequest:function(){var ee=(0,u.Z)((0,a.Z)().mark(function C(O){var Fe,De,Se;return(0,a.Z)().wrap(function(we){for(;;)switch(we.prev=we.next){case 0:Fe=O.file,De=O.onSuccess,Se=O.onError,Sr((0,qa.Z)({},_.record.id,{file:Fe,onSuccess:De,onError:Se})),De();case 3:case"end":return we.stop()}},C)}));function xe(C){return ee.apply(this,arguments)}return xe}()},style:{height:30,width:30},extra:"\u652F\u6301 JPG\u3001PNG \u683C\u5F0F"})})}},{title:"\u64CD\u4F5C",valueType:"option",width:"18%",render:function(q,_,H,ee){return[(0,e.jsx)("a",{onClick:function(){var C;ee==null||(C=ee.startEditable)===null||C===void 0||C.call(ee,_.id)},children:"\u7F16\u8F91"},"editable"),(0,e.jsx)(S.Z,{title:"\u786E\u5B9A\u5220\u9664\u6B64\u884C\uFF1F",onConfirm:(0,u.Z)((0,a.Z)().mark(function xe(){return(0,a.Z)().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.prev=0,O.next=3,(0,L.jV)(_);case 3:return O.next=5,Ne();case 5:l.ZP.success("\u5220\u9664\u6210\u529F"),O.next=11;break;case 8:O.prev=8,O.t0=O.catch(0),l.ZP.error("\u5220\u9664\u5931\u8D25");case 11:case"end":return O.stop()}},xe,null,[[0,8]])})),children:(0,e.jsx)("a",{children:"\u5220\u9664"})},"delete")]}}];return(0,e.jsxs)(te.Z,{spinning:Ye,children:[(0,e.jsxs)(He.Z,{title:(0,e.jsxs)("div",{children:["\u7F16\u8F91\u9875\u9762: ",(0,e.jsx)("span",{style:{color:"red"},children:(0,e.jsx)("strong",{children:w==null?void 0:w.page_title})})]}),bordered:!0,direction:"column",extra:(0,e.jsx)(ze.Z,{children:(0,e.jsx)($.Z,{title:"\u5220\u9664\u5F53\u524D\u9875\u9762",children:(0,e.jsx)(S.Z,{title:"\u786E\u5B9A\u5220\u9664\u6B64\u9875\u9762\u5417\uFF1F",onConfirm:(0,u.Z)((0,a.Z)().mark(function ie(){return(0,a.Z)().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.prev=0,_.next=3,Ya({id:w==null?void 0:w.page_id});case 3:return A(null),_.next=6,Z();case 6:l.ZP.success("\u5220\u9664\u6210\u529F"),_.next=12;break;case 9:_.prev=9,_.t0=_.catch(0),l.ZP.error("\u5220\u9664\u5931\u8D25");case 12:case"end":return _.stop()}},ie,null,[[0,9]])})),children:(0,e.jsx)(ir.Z,{style:{color:"red",fontSize:"18px"}})},"delete")})}),children:[(0,e.jsxs)(ba.Z,{gutter:[16,16],children:[(0,e.jsx)(ma.Z,{span:16,children:(0,e.jsxs)(He.Z,{bordered:!0,title:"\u9875\u9762\u6A21\u677F",extra:(0,e.jsx)(ze.Z,{children:(0,e.jsx)("a",{onClick:function(){ke((m==null?void 0:m.layout_cfg)||{}),Ke(!0)},children:"\u7F16\u8F91"})}),children:[(0,e.jsxs)(ga.UW,{style:{height:35},children:[(0,e.jsx)(be.ZP.Item,{label:(0,e.jsx)("strong",{children:"\u540D\u79F0"}),children:(0,e.jsx)("span",{children:m==null||(f=m.layout_cfg)===null||f===void 0?void 0:f.title})}),(0,e.jsx)(be.ZP.Item,{label:(0,e.jsx)("strong",{children:"\u63CF\u8FF0"}),children:(0,e.jsx)("span",{children:m==null||(s=m.layout_cfg)===null||s===void 0?void 0:s.description})}),(0,e.jsx)(be.ZP.Item,{label:(0,e.jsx)("strong",{children:"\u6805\u683C\u95F4\u8DDD"}),children:(0,e.jsx)("span",{children:m==null||(t=m.layout_cfg)===null||t===void 0?void 0:t.grid_gutter})}),(0,e.jsx)(be.ZP.Item,{label:(0,e.jsx)("strong",{children:"\u6805\u683C\u5E03\u5C40"}),children:(0,e.jsx)("span",{children:m==null||(i=m.layout_cfg)===null||i===void 0?void 0:i.grid_row_col})})]}),(0,e.jsxs)(ga.UW,{style:{height:35},children:[(0,e.jsx)(be.ZP.Item,{label:(0,e.jsx)("strong",{children:"\u5B57\u4F53"}),children:(0,e.jsx)("span",{children:m==null||(P=m.layout_cfg)===null||P===void 0?void 0:P.font_family})}),(0,e.jsx)(be.ZP.Item,{label:(0,e.jsx)("strong",{children:"\u5B57\u4F53\u989C\u8272"}),children:(0,e.jsx)("div",{style:{backgroundColor:m==null||(c=m.layout_cfg)===null||c===void 0?void 0:c.font_color,marginTop:6,width:"55px",height:"20px",border:"1px solid lightgray",display:"inline-block"}})}),(0,e.jsx)(be.ZP.Item,{label:(0,e.jsx)("strong",{children:"\u5B57\u4F53\u5927\u5C0F"}),children:(0,e.jsx)("span",{children:m==null||(se=m.layout_cfg)===null||se===void 0?void 0:se.font_size})}),(0,e.jsx)(be.ZP.Item,{label:(0,e.jsx)("strong",{children:"\u6587\u672C\u900F\u660E\u5EA6"}),children:(0,e.jsx)("span",{children:m==null||(fe=m.layout_cfg)===null||fe===void 0?void 0:fe.text_opacity})})]}),(0,e.jsxs)(ga.UW,{style:{height:35},children:[(0,e.jsx)(be.ZP.Item,{label:(0,e.jsx)("strong",{children:"\u6587\u672C\u4E3B\u8F74\u4F4D\u7F6E"}),children:(0,e.jsx)("span",{children:m==null||(g=m.layout_cfg)===null||g===void 0?void 0:g.text_flex_justify})}),(0,e.jsx)(be.ZP.Item,{label:(0,e.jsx)("strong",{children:"\u6587\u672C\u4EA4\u53C9\u8F74\u4F4D\u7F6E"}),children:(0,e.jsx)("span",{children:m==null||(N=m.layout_cfg)===null||N===void 0?void 0:N.text_flex_align})}),(0,e.jsx)(be.ZP.Item,{label:(0,e.jsx)("strong",{children:"\u80CC\u666F\u56FE\u7247"}),children:(0,e.jsx)(xa.Z,{src:m==null||(U=m.layout_cfg)===null||U===void 0?void 0:U.background_img,width:35,height:35})}),(0,e.jsx)(be.ZP.Item,{label:(0,e.jsx)("strong",{children:"\u80CC\u666F\u989C\u8272"}),children:(0,e.jsx)("div",{style:{backgroundColor:m==null||(le=m.layout_cfg)===null||le===void 0?void 0:le.background_color,marginTop:6,width:"55px",height:"20px",border:"1px solid lightgray",display:"inline-block"}})})]})]})}),(0,e.jsx)(ma.Z,{span:8,children:(0,e.jsx)(He.Z,{title:"\u7AE0\u8282\u6A21\u677F",bordered:!0,style:{height:"100%"},extra:(0,e.jsx)(ze.Z,{children:(0,e.jsx)("a",{onClick:function(){Fa(!0)},children:"\u7F16\u8F91"})}),children:(0,e.jsx)(be.ZP.Item,{children:(0,e.jsx)("span",{children:pe==null||(oe=pe.chapter)===null||oe===void 0?void 0:oe.text_template})})})})]}),(0,e.jsx)(He.Z,{bordered:!0,extra:(0,e.jsxs)(ze.Z,{children:[(0,e.jsx)("a",{onClick:function(){Ve(!0)},children:"\u9875\u9762\u9884\u89C8"}),(0,e.jsx)("a",{onClick:function(){re(!0)},children:"\u5185\u5BB9\u6392\u5E8F"})]}),style:{width:"100%",height:"100%",marginTop:10},title:"\u6BB5\u843D\u5185\u5BB9",subTitle:(0,e.jsxs)("div",{children:["\u6BCF\u9875",(0,e.jsx)("span",{style:{color:"red"},children:JSON.parse((m==null||(D=m.layout_cfg)===null||D===void 0?void 0:D.grid_row_col)||"[]").length}),"\u4E2A\u77E5\u8BC6\u70B9\uFF01"]}),children:(0,e.jsx)(ar.Z,{rowKey:"id",headerTitle:!1,maxLength:JSON.parse((m==null||(X=m.layout_cfg)===null||X===void 0?void 0:X.grid_row_col)||"[]").length,actionRef:ce,editableFormRef:J,style:{width:"100%"},recordCreatorProps:{position:"bottom",creatorButtonText:"\u6DFB\u52A0\u6BB5\u843D",record:function(){var q;return{id:(0,wa.D)(),seq:(pe==null||(q=pe.paragraph)===null||q===void 0?void 0:q.reduce(function(_,H){return H.seq>_?H.seq:_},0))+1}}},loading:!1,columns:$r,value:(pe==null?void 0:pe.paragraph)||[],editable:{type:"multiple",onSave:function(){var ie=(0,u.Z)((0,a.Z)().mark(function _(H,ee,xe){var C,O,Fe,De,Se;return(0,a.Z)().wrap(function(we){for(;;)switch(we.prev=we.next){case 0:if(O=new FormData,(C=Oa[H])!==null&&C!==void 0&&C.file&&O.append("illustration",(Fe=Oa[H])===null||Fe===void 0?void 0:Fe.file),O.append("pic_book",m==null?void 0:m.pic_book),O.append("chapter",m==null?void 0:m.chapter),O.append("book_page",w==null?void 0:w.page_id),O.append("para_content",ee.para_content),O.append("knowledge",ee.knowledge),O.append("para_content_uniq",(0,wa.J)(ee.para_content)),typeof H!="string"){we.next=15;break}return we.next=11,(0,L.HA)(O);case 11:De=we.sent,De!=null&&De.id?l.ZP.success("\u65B0\u589E\u6210\u529F"):l.ZP.error("\u65B0\u589E\u5931\u8D25"),we.next=19;break;case 15:return we.next=17,(0,L.YA)(ee==null?void 0:ee.id,O);case 17:Se=we.sent,Se!=null&&Se.id?l.ZP.success("\u7F16\u8F91\u6210\u529F"):l.ZP.error("\u7F16\u8F91\u5931\u8D25");case 19:return we.next=21,Ne();case 21:case"end":return we.stop()}},_)}));function q(_,H,ee){return ie.apply(this,arguments)}return q}(),onDelete:function(){var ie=(0,u.Z)((0,a.Z)().mark(function _(H,ee){return(0,a.Z)().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.prev=0,C.next=3,(0,L.jV)(ee);case 3:l.ZP.success("\u5220\u9664\u6210\u529F"),C.next=9;break;case 6:C.prev=6,C.t0=C.catch(0),l.ZP.error("\u5220\u9664\u5931\u8D25");case 9:case"end":return C.stop()}},_,null,[[0,6]])}));function q(_,H){return ie.apply(this,arguments)}return q}()}})})]}),E&&(0,e.jsx)(lr,{showModal:E,setShowModal:re,chapterParaData:pe,updateChapterParaDataFunc:Ne,page_id:w==null?void 0:w.page_id}),Sa&&(0,e.jsx)(or,{showModal:Sa,setShowModal:Fa,chapterData:pe==null?void 0:pe.chapter,updateChapterParaDataFunc:Ne}),Qe&&(0,e.jsx)(pr,{showPreviewModal:Qe,setShowPreviewModal:Ve,chapterParaData:pe,page_layout:m==null?void 0:m.layout_cfg}),qe&&(0,e.jsx)(vr.Z,{record:Le,setShowModal:Ke,showModal:qe,updatePageDetailsFunc:La}),Re&&(0,e.jsx)(mr,{record:Mr,setShowModal:me,showModal:Re})]})},yr=gr,$e=r(91214),Hr=r(62999),ka=r(54680),Zr=r(98442),Da=r(88611),br=r(90672),xr=r(64317),wr=function(n){var f=(0,v.useState)(!1),s=(0,o.Z)(f,2),t=s[0],i=s[1],P=(0,v.useRef)(),c=n.setShowMenuModal,se=n.showMenuModal,fe=n.setEditMenu,g=n.editMenu,N=n.picBookId,U=n.layoutOptionsData,le=n.layoutOriginData,oe=n.refreshMenu,D=(0,v.useState)("chapter"),X=(0,o.Z)(D,2),J=X[0],W=X[1],w=(0,v.useState)((0,u.Z)((0,a.Z)().mark(function k(){var R,Z;return(0,a.Z)().wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return de.next=2,Ka({id:N});case 2:R=de.sent,(0,$e.IT)(R),Z=Object.assign([],R),Z.unshift({key:"0-0",title:"\u65E0\u7236\u5206\u7EC4",value:"0-0"}),je({withDefault:Z,unDefault:R});case 7:case"end":return de.stop()}},k)}))),A=(0,o.Z)(w,2),z=A[0],je=A[1];return(0,v.useEffect)((0,u.Z)((0,a.Z)().mark(function k(){var R;return(0,a.Z)().wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:if(!(g!=null&&g.key)){ce.next=9;break}return i(!0),ce.next=4,Na({id:g==null?void 0:g.key});case 4:R=ce.sent,g.text_template=R==null?void 0:R.text_template,i(!1),ce.next=10;break;case 9:i(!1);case 10:case"end":return ce.stop()}},k)})),[g==null?void 0:g.key]),!t&&(0,e.jsxs)(We.Y,{title:(g==null?void 0:g.title)==null?"\u65B0\u5EFA\u7AE0\u8282/\u9875\u9762":"\u4FEE\u6539\u7AE0\u8282",width:"600px",layout:"horizontal",visible:se,onVisibleChange:c,onFinish:function(){var k=(0,u.Z)((0,a.Z)().mark(function R(Z){var ce,de,Be;return(0,a.Z)().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:if((g==null?void 0:g.title)!=null){Q.next=15;break}if(J!="chapter"){Q.next=8;break}return de={pic_book:N,title:Z==null?void 0:Z.title,text_template:Z==null?void 0:Z.text_template,parent:typeof(Z==null?void 0:Z.parent)=="number"?Z==null?void 0:Z.parent:null},Q.next=5,Ga(de);case 5:Be=Q.sent,Q.next=13;break;case 8:if(J!="page"){Q.next=13;break}return de={title:Z==null?void 0:Z.title,chapter:Z==null?void 0:Z.chapter,paragraphs:[],pic_book:N,layout:Z==null?void 0:Z.layout},Q.next=12,(0,L.WR)(de);case 12:Be=Q.sent;case 13:Q.next=19;break;case 15:return de={id:g==null?void 0:g.key,title:Z==null?void 0:Z.title,text_template:Z==null?void 0:Z.text_template,parent:typeof(Z==null?void 0:Z.parent)=="number"?Z==null?void 0:Z.parent:null},Q.next=18,Za(de);case 18:Be=Q.sent;case 19:if(!((ce=Be)!==null&&ce!==void 0&&ce.id)){Q.next=25;break}return c(!1),Q.next=23,oe();case 23:Q.next=26;break;case 25:l.ZP.error("\u5904\u7406\u5931\u8D25");case 26:case"end":return Q.stop()}},R)}));return function(R){return k.apply(this,arguments)}}(),modalProps:{closable:!1},children:[(g==null?void 0:g.title)==null&&(0,e.jsx)(Zr.Z.Group,{name:"add_type",label:"\u65B0\u5EFA\u7C7B\u578B",initialValue:J,labelCol:{span:4},rules:[{required:!0}],options:[{label:"\u7AE0\u8282",value:"chapter"},{label:"\u9875\u9762",value:"page"}],fieldProps:{onChange:function(R){var Z;W(R==null||(Z=R.target)===null||Z===void 0?void 0:Z.value)}}}),J=="chapter"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Pa.Z,{width:"md",name:"title",label:"\u7AE0\u8282\u540D\u79F0",labelCol:{span:4},initialValue:(g==null?void 0:g.title)||"",rules:[{required:!0}]}),(0,e.jsx)(br.Z,{width:"md",name:"text_template",label:"\u6587\u6848\u6A21\u677F",labelCol:{span:4},initialValue:(g==null?void 0:g.text_template)||"",rules:[{required:!0}]}),(0,e.jsx)(Da.A.Item,{label:"\u7236\u7AE0\u8282",name:"parent",labelCol:{span:4},initialValue:(g==null?void 0:g.parent)||"0-0",rules:[{required:!0}],children:(0,e.jsx)(ka.Z,{showSearch:!0,style:{width:330},treeNodeFilterProp:"title",treeData:Object.keys(z).length>0?z==null?void 0:z.withDefault:[]})})]}),J=="page"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(xr.Z,{rules:[{required:!0}],labelCol:{span:4},width:"md",label:"\u9875\u9762\u6A21\u677F",name:"layout",options:U}),(0,e.jsx)(Da.A.Item,{label:"\u6240\u5C5E\u7AE0\u8282",name:"chapter",labelCol:{span:4},initialValue:(g==null?void 0:g.parent)||void 0,rules:[{required:!0}],children:(0,e.jsx)(ka.Z,{showSearch:!0,style:{width:330},treeNodeFilterProp:"title",treeData:Object.keys(z).length>0?z==null?void 0:z.unDefault:[]})})]})]})},Pr=wr,jr=function(n){var f,s=n==null||(f=n.location)===null||f===void 0?void 0:f.query,t=s.id,i=(0,v.useState)({}),P=(0,o.Z)(i,2),c=P[0],se=P[1],fe=(0,v.useState)(!1),g=(0,o.Z)(fe,2),N=g[0],U=g[1],le=(0,v.useState)(!1),oe=(0,o.Z)(le,2),D=oe[0],X=oe[1],J=(0,v.useState)({}),W=(0,o.Z)(J,2),w=W[0],A=W[1],z=(0,v.useState)(!1),je=(0,o.Z)(z,2),k=je[0],R=je[1],Z=(0,v.useState)([]),ce=(0,o.Z)(Z,2),de=ce[0],Be=ce[1],Ye=(0,v.useState)({}),Q=(0,o.Z)(Ye,2),Ce=Q[0],Ae=Q[1],Qe=(0,v.useState)({}),Ve=(0,o.Z)(Qe,2),Ma=Ve[0],Xe=Ve[1],qe=(0,v.useState)((0,u.Z)((0,a.Z)().mark(function ke(){var V;return(0,a.Z)().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,(0,ja.Nk)({});case 2:V=E.sent,Ge(V);case 4:case"end":return E.stop()}},ke)}))),Ke=(0,o.Z)(qe,2),Ue=Ke[0],Ge=Ke[1],Le=function(){var ke=(0,u.Z)((0,a.Z)().mark(function V(){var T,E;return(0,a.Z)().wrap(function(_e){for(;;)switch(_e.prev=_e.next){case 0:return R(!0),_e.next=3,Va({id:t});case 3:T=_e.sent,E=(0,$e.hs)(T),Ae(E),Be(T),R(!1);case 8:case"end":return _e.stop()}},V)}));return function(){return ke.apply(this,arguments)}}();return(0,v.useEffect)((0,u.Z)((0,a.Z)().mark(function ke(){var V;return(0,a.Z)().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(!t){E.next=9;break}return E.next=3,Le();case 3:return R(!0),E.next=6,(0,L.Cy)({id:t});case 6:V=E.sent,se(V),R(!1);case 9:case"end":return E.stop()}},ke)})),[t]),(0,e.jsxs)(M._z,{title:!1,pageHeaderRender:!1,children:[(0,e.jsx)("div",{style:{width:N?40:260,position:"fixed",top:"68px",bottom:0,background:"#ffffff"},children:(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[(0,e.jsx)(Y.Z,{defaultActiveKey:"default",style:{flex:1,overflow:"scroll",margin:"0 8px"},tabBarExtraContent:{right:(0,e.jsx)("a",{onClick:function(){A({}),X(!0)},children:"\u6DFB\u52A0"})},children:(0,e.jsx)(b.Z,{tab:"\u76EE\u5F55",style:{color:"black"},children:k?(0,e.jsx)(te.Z,{spinning:!0,children:"\u76EE\u5F55\u52A0\u8F7D\u4E2D"}):Object.keys(de).length>0?(0,e.jsx)(ne.Z,{showLine:!0,defaultExpandAll:!0,onSelect:function(V,T){var E,re,_e;if(!((T==null||(E=T.node)===null||E===void 0?void 0:E.id)==(Ce==null?void 0:Ce.page_id)||k)&&(Xe(T==null||(re=T.node)===null||re===void 0?void 0:re.key),T!=null&&(_e=T.node)!==null&&_e!==void 0&&_e.isLeaf)){var Oe,Re;Ae({page_id:T==null||(Oe=T.node)===null||Oe===void 0?void 0:Oe.id,parent:T==null||(Re=T.node)===null||Re===void 0?void 0:Re.parent})}},selectedKeys:["leaf_".concat(Ce==null?void 0:Ce.page_id)],draggable:{icon:!1},onDrop:function(){var ke=(0,u.Z)((0,a.Z)().mark(function V(T){var E,re,_e,Oe;return(0,a.Z)().wrap(function(me){for(;;)switch(me.prev=me.next){case 0:if(E=(0,$e.FC)(T),E!=null&&E.canDrag){me.next=8;break}if(!(E!=null&&E.errMsg)){me.next=7;break}return l.ZP.error(E==null?void 0:E.errMsg),me.abrupt("return");case 7:return me.abrupt("return");case 8:if(re=(0,$e.EF)(T,de),_e=(0,$e.W8)(T,re),(0,$e.Pv)(_e)){me.next=12;break}return me.abrupt("return");case 12:return R(!0),me.next=15,Xa(_e);case 15:if(Oe=me.sent,!(Oe.length>0)){me.next=20;break}return l.ZP.success("\u4FEE\u6539\u6210\u529F"),me.next=20,Le();case 20:R(!1);case 21:case"end":return me.stop()}},V)}));return function(V){return ke.apply(this,arguments)}}(),titleRender:function(V){return[V==null?void 0:V.title,(0,e.jsx)("span",{style:{marginLeft:5},children:(0,e.jsx)(he.Z,{overlay:(0,e.jsxs)(B.Z,{children:[(0,e.jsx)(B.Z.Item,{onClick:function(){A(V),X(!0)},children:"\u4FEE\u6539\u7AE0\u8282"}),(0,e.jsx)(B.Z.Item,{children:(0,e.jsx)(S.Z,{title:"\u786E\u5B9A\u5220\u9664\u8BE5\u7AE0\u8282\u5417\uFF1F",onConfirm:(0,u.Z)((0,a.Z)().mark(function T(){return(0,a.Z)().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return re.prev=0,re.next=3,za({id:V==null?void 0:V.key});case 3:return re.next=5,Le();case 5:l.ZP.success("\u5220\u9664\u6210\u529F"),re.next=11;break;case 8:re.prev=8,re.t0=re.catch(0),l.ZP.error("\u5220\u9664\u5931\u8D25");case 11:case"end":return re.stop()}},T,null,[[0,8]])})),children:"\u5220\u9664\u7AE0\u8282"},"delete")})]}),placement:"bottomLeft",arrow:!0,children:(0,e.jsx)("a",{style:{marginLeft:10},children:(0,e.jsx)(I.Z,{hidden:V==null?void 0:V.isLeaf})})})})]},expandAction:"doubleClick",treeData:de}):"\u6682\u65E0\u6570\u636E"},"default")}),(0,e.jsx)("div",{style:{height:"39px",justifyContent:"center",alignItems:"center",display:"flex"},onClick:function(V){U(!N)},children:N?(0,e.jsx)($.Z,{title:"\u5C55\u5F00",placement:"right",children:(0,e.jsx)(Ze.Z,{})}):(0,e.jsxs)("span",{children:[(0,e.jsx)(G.Z,{style:{marginRight:5}}),"\u6536\u8D77"]})})]})}),(0,e.jsx)("div",{style:{marginLeft:N?50:270},children:(Ce==null?void 0:Ce.page_id)&&(0,e.jsx)(yr,{picBookId:t,selectPage:Ce,setSelectPage:Ae,configData:c,layoutOriginData:Ue,refreshMenu:Le,layoutOptionsData:(0,$e.V1)(Ue),setLayoutOriginData:Ge})}),D&&(0,e.jsx)(Pr,{setShowMenuModal:X,showMenuModal:D,setEditMenu:A,editMenu:w,picBookId:t,layoutOriginData:Ue,layoutOptionsData:(0,$e.V1)(Ue),refreshMenu:Le})]})},kr=jr},91214:function(Ie,ge,r){"use strict";r.d(ge,{hs:function(){return K},f$:function(){return te},V1:function(){return ye},IT:function(){return ne},FC:function(){return ve},W8:function(){return he},EF:function(){return S},Pv:function(){return ae}});var F=r(39428),$=r(3182),ue=r(86582),Y=r(37720),K=function(d){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=void 0,u=function v(M,L){for(var I=0;I<M.length;I++){if(M[I].isLeaf)return L(l?M[I].tag_label:{page_id:M[I].id,page_title:M[I].title,parent:M[I].parent});M[I].children&&v(M[I].children,L)}},o=(0,ue.Z)(d);return u(o,function(v){a==null&&(a=v)}),a},te=function(){var B=(0,$.Z)((0,F.Z)().mark(function d(){var l;return(0,F.Z)().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,Y.Qm)({});case 2:return l=u.sent,u.abrupt("return",l==null?void 0:l.map(function(o){return{label:o==null?void 0:o.knowledge,value:o==null?void 0:o.id}}));case 4:case"end":return u.stop()}},d)}));return function(){return B.apply(this,arguments)}}(),ye=function(d){return d==null?void 0:d.map(function(l){return{label:"".concat(l==null?void 0:l.title,"(").concat(l==null?void 0:l.grid_row_col,")"),value:l==null?void 0:l.id}})},ne=function B(d){d==null||d.forEach(function(l){l.value=l.key,l!=null&&l.children&&B(l==null?void 0:l.children)})},ve=function(d){var l=!0,a="";if(d.dragNode.isLeaf&&d.dropPosition==-1)return{canDrag:!1,errMsg:"\u7981\u6B62page\u8282\u70B9\u653E\u5230\u6700\u5916\u5C42"};if(d.node.pos.split("-").length>5)return{canDrag:!1,errMsg:"\u76EE\u5F55\u6700\u5927\u5C42\u7EA7\u4E0D\u80FD\u8D85\u8FC73\u5C42"};if(d.dropToGap){if(d.dragNode.isLeaf)return{canDrag:!1,errMsg:"page\u8282\u70B9\u53EA\u80FD\u653E\u5728\u7AE0\u8282\u5185"}}else{var u;if(!d.dragNode.isLeaf&&!d.node.isLeaf)return{canDrag:!1,errMsg:"\u7981\u6B62\u7AE0\u8282\u62D6\u653E\u5230page\u8282\u70B9"};if(d.node.expanded&&((u=d.node.pos.split("-"))===null||u===void 0?void 0:u.length)>4)return{canDrag:!1,errMsg:"\u76EE\u5F55\u6700\u5927\u5C42\u7EA7\u4E0D\u80FD\u8D85\u8FC73\u5C42"}}return{canDrag:l,errMsg:a}},he=function(d,l){var a,u=Ee(d.dragNode.key,l);return{sort_key:d.dragNode.key,target_parent:u.target_parent,target_children:(a=u.target_children)===null||a===void 0?void 0:a.map(function(o){return o.key})}},Ee=function(d,l){var a="",u=[],o=function v(M,L,I,Ze){for(var G=0;G<M.length;G++){if(M[G].key===L)return Ze(M[G],G,I,M);M[G].children&&v(M[G].children,L,M[G].key,Ze)}};return o(l,d,null,function(v,M,L,I){a=L,u=I}),{target_parent:a,target_children:u}},S=function(d,l){var a=d.node.key,u=d.dragNode.key,o=d.node.pos.split("-"),v=d.dropPosition-Number(o[o.length-1]),M=function b(h,y,j){for(var x=0;x<h.length;x++){if(h[x].key===y)return j(h[x],x,h);h[x].children&&b(h[x].children,y,j)}},L=(0,ue.Z)(l),I;if(M(L,u,function(b,h,y){y.splice(h,1),I=b}),!d.dropToGap)M(L,a,function(b){b.children=b.children||[],b.children.unshift(I)});else if((d.node.props.children||[]).length>0&&d.node.props.expanded&&v===1)M(L,a,function(b){b.children=b.children||[],b.children.unshift(I)});else{var Ze,G;M(L,a,function(b,h,y){Ze=y,G=h}),v===-1?Ze.splice(G,0,I):Ze.splice(G+1,0,I)}return L},ae=function(d){var l;return!(d.sort_key.toString().startsWith("leaf_")&&(l=d.target_parent)!==null&&l!==void 0&&l.toString().startsWith("leaf_")||d.target_parent==null)}},86028:function(Ie,ge,r){"use strict";r.d(ge,{J:function(){return ue},D:function(){return Y}});var F=r(81354),$=r.n(F),ue=function(te){return F.MD5(te).toString()},Y=function(){var te=new Date().getTime(),ye="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(ne){var ve=(te+Math.random()*16)%16|0;return te=Math.floor(te/16),(ne=="x"?ve:ve&7|8).toString(16)});return ye}},37720:function(Ie,ge,r){"use strict";r.d(ge,{Qm:function(){return ye},Et:function(){return ve},dz:function(){return Ee}});var F=r(93224),$=r(39428),ue=r(11849),Y=r(3182),K=r(78370),te=["id"];function ye(d,l){return ne.apply(this,arguments)}function ne(){return ne=(0,Y.Z)((0,$.Z)().mark(function d(l,a){return(0,$.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,K.Z)("/api/pic_book/knowledge/",(0,ue.Z)({method:"GET",params:(0,ue.Z)({},l)},a||{})));case 1:case"end":return o.stop()}},d)})),ne.apply(this,arguments)}function ve(d,l){return he.apply(this,arguments)}function he(){return he=(0,Y.Z)((0,$.Z)().mark(function d(l,a){var u,o,v;return(0,$.Z)().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return u=l.id,o=u===void 0?0:u,v=(0,F.Z)(l,te),L.abrupt("return",(0,K.Z)("/api/pic_book/knowledge/".concat(o,"/"),(0,ue.Z)({method:"PATCH",data:(0,ue.Z)({},v)},a||{})));case 2:case"end":return L.stop()}},d)})),he.apply(this,arguments)}function Ee(d,l){return S.apply(this,arguments)}function S(){return S=(0,Y.Z)((0,$.Z)().mark(function d(l,a){return(0,$.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,K.Z)("/api/pic_book/knowledge/",(0,ue.Z)({method:"POST",data:(0,ue.Z)({},l)},a||{})));case 1:case"end":return o.stop()}},d)})),S.apply(this,arguments)}function ae(d,l){return B.apply(this,arguments)}function B(){return B=_asyncToGenerator(_regeneratorRuntime().mark(function d(l,a){var u,o;return _regeneratorRuntime().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return u=l.id,o=u===void 0?0:u,M.abrupt("return",request("/api/pic_book/knowledge/".concat(o),_objectSpread({method:"DELETE"},a||{})));case 2:case"end":return M.stop()}},d)})),B.apply(this,arguments)}},25049:function(Ie,ge,r){"use strict";r.d(ge,{Nk:function(){return K},fc:function(){return ye},Lk:function(){return ve}});var F=r(39428),$=r(11849),ue=r(3182),Y=r(78370);function K(ae,B){return te.apply(this,arguments)}function te(){return te=(0,ue.Z)((0,F.Z)().mark(function ae(B,d){return(0,F.Z)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,Y.Z)("/api/pic_book/layout/",(0,$.Z)({method:"GET",params:(0,$.Z)({},B)},d||{})));case 1:case"end":return a.stop()}},ae)})),te.apply(this,arguments)}function ye(ae,B,d){return ne.apply(this,arguments)}function ne(){return ne=(0,ue.Z)((0,F.Z)().mark(function ae(B,d,l){return(0,F.Z)().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,Y.Z)("/api/pic_book/layout/".concat(B,"/"),(0,$.Z)({method:"PATCH",data:d},l||{})));case 1:case"end":return u.stop()}},ae)})),ne.apply(this,arguments)}function ve(ae,B){return he.apply(this,arguments)}function he(){return he=(0,ue.Z)((0,F.Z)().mark(function ae(B,d){return(0,F.Z)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,Y.Z)("/api/pic_book/layout/",(0,$.Z)({method:"POST",data:B},d||{})));case 1:case"end":return a.stop()}},ae)})),he.apply(this,arguments)}function Ee(ae,B){return S.apply(this,arguments)}function S(){return S=_asyncToGenerator(_regeneratorRuntime().mark(function ae(B,d){var l,a;return _regeneratorRuntime().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return l=B.id,a=l===void 0?0:l,o.abrupt("return",request("/api/pic_book/layout/".concat(a),_objectSpread({method:"DELETE"},d||{})));case 2:case"end":return o.stop()}},ae)})),S.apply(this,arguments)}},87766:function(Ie,ge,r){"use strict";r.d(ge,{aL:function(){return ne},tN:function(){return he},VJ:function(){return S},R$:function(){return B},BT:function(){return l},aU:function(){return v},y0:function(){return L}});var F=r(39428),$=r(11849),ue=r(93224),Y=r(3182),K=r(78370),te=["id"],ye=null;function ne(b,h){return ve.apply(this,arguments)}function ve(){return ve=(0,Y.Z)((0,F.Z)().mark(function b(h,y){var j,x,Pe;return(0,F.Z)().wrap(function(Me){for(;;)switch(Me.prev=Me.next){case 0:return j=h.id,x=j===void 0?0:j,Pe=(0,ue.Z)(h,te),Me.abrupt("return",(0,K.Z)("/api/pic_book/book/".concat(x,"/voice_list/"),(0,$.Z)({method:"GET",params:(0,$.Z)({},Pe)},y||{})));case 2:case"end":return Me.stop()}},b)})),ve.apply(this,arguments)}function he(b,h){return Ee.apply(this,arguments)}function Ee(){return Ee=(0,Y.Z)((0,F.Z)().mark(function b(h,y){return(0,F.Z)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.abrupt("return",(0,K.Z)("/api/pic_book/book_voice/",(0,$.Z)({method:"POST",data:h},y||{})));case 1:case"end":return x.stop()}},b)})),Ee.apply(this,arguments)}function S(b,h){return ae.apply(this,arguments)}function ae(){return ae=(0,Y.Z)((0,F.Z)().mark(function b(h,y){return(0,F.Z)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.abrupt("return",(0,K.Z)("/api/pic_book/book_voice/bulk_gen_voice_files/",(0,$.Z)({method:"POST",data:h},y||{})));case 1:case"end":return x.stop()}},b)})),ae.apply(this,arguments)}function B(b,h){return d.apply(this,arguments)}function d(){return d=(0,Y.Z)((0,F.Z)().mark(function b(h,y){return(0,F.Z)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.abrupt("return",(0,K.Z)("/api/pic_book/book_voice/paragraph_voice_file/",(0,$.Z)({method:"POST",data:h},y||{})));case 1:case"end":return x.stop()}},b)})),d.apply(this,arguments)}function l(b,h){return a.apply(this,arguments)}function a(){return a=(0,Y.Z)((0,F.Z)().mark(function b(h,y){return(0,F.Z)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.abrupt("return",(0,K.Z)("/api/pic_book/paragraph_voice/",(0,$.Z)({method:"GET",params:(0,$.Z)({},h)},y||{})));case 1:case"end":return x.stop()}},b)})),a.apply(this,arguments)}function u(b,h){return o.apply(this,arguments)}function o(){return o=_asyncToGenerator(_regeneratorRuntime().mark(function b(h,y){var j,x,Pe;return _regeneratorRuntime().wrap(function(Me){for(;;)switch(Me.prev=Me.next){case 0:return j=h.id,x=j===void 0?0:j,Pe=_objectWithoutProperties(h,ye),Me.abrupt("return",request("/api/pic_book/paragraph_voice/".concat(x,"/"),_objectSpread({method:"GET",params:_objectSpread({},Pe)},y||{})));case 2:case"end":return Me.stop()}},b)})),o.apply(this,arguments)}function v(b,h){return M.apply(this,arguments)}function M(){return M=(0,Y.Z)((0,F.Z)().mark(function b(h,y){return(0,F.Z)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.abrupt("return",(0,K.Z)("/api/pic_book/paragraph_voice/",(0,$.Z)({method:"POST",data:h},y||{})));case 1:case"end":return x.stop()}},b)})),M.apply(this,arguments)}function L(b,h,y){return I.apply(this,arguments)}function I(){return I=(0,Y.Z)((0,F.Z)().mark(function b(h,y,j){return(0,F.Z)().wrap(function(Pe){for(;;)switch(Pe.prev=Pe.next){case 0:return Pe.abrupt("return",(0,K.Z)("/api/pic_book/paragraph_voice/".concat(h,"/"),(0,$.Z)({method:"PATCH",data:y},j||{})));case 1:case"end":return Pe.stop()}},b)})),I.apply(this,arguments)}function Ze(b,h){return G.apply(this,arguments)}function G(){return G=_asyncToGenerator(_regeneratorRuntime().mark(function b(h,y){var j,x;return _regeneratorRuntime().wrap(function(Te){for(;;)switch(Te.prev=Te.next){case 0:return j=h.id,x=j===void 0?0:j,Te.abrupt("return",request("/api/pic_book/paragraph_voice/".concat(x,"/"),_objectSpread({method:"DELETE"},y||{})).catch(function(Me){return{}}));case 2:case"end":return Te.stop()}},b)})),G.apply(this,arguments)}},42480:function(){}}]);
